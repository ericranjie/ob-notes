# 

ç‚¹å‡»å…³æ³¨ ğŸ‘‰Â èŠ‹é“æºç 

Â _2021å¹´10æœˆ20æ—¥ 10:33_

ç‚¹å‡»ä¸Šæ–¹â€œèŠ‹é“æºç â€ï¼Œé€‰æ‹©â€œ[è®¾ä¸ºæ˜Ÿæ ‡](http://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247486188&idx=3&sn=f160d91ea23e5113e6077c500a2e30c4&chksm=fa49755dcd3efc4bf4f566fbbbf74c191d0b79f2d3222fd211bc52d80b5ef127f52b1158ed71&scene=21#wechat_redirect)â€

ç®¡å¥¹å‰æµªï¼Œè¿˜æ˜¯åæµªï¼Ÿ

èƒ½æµªçš„æµªï¼Œæ‰æ˜¯å¥½æµªï¼  

æ¯å¤©Â **10:33**Â æ›´æ–°æ–‡ç« ï¼Œæ¯å¤©æ‰äº¿ç‚¹ç‚¹å¤´å‘...

æºç ç²¾å“ä¸“æ 

Â 

- [åŸåˆ› | Java 2021Â è¶…ç¥ä¹‹è·¯ï¼Œå¾ˆè‚~](http://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21#wechat_redirect)  
    
- [ä¸­æ–‡è¯¦ç»†æ³¨é‡Šçš„å¼€æºé¡¹ç›®](http://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247486264&idx=1&sn=475ac3f1ef253a33daacf50477203c80&chksm=fa497489cd3efd9f7298f5da6aad0c443ae15f398436aff57cb2b734d6689e62ab43ae7857ac&scene=21#wechat_redirect)  
    
- [RPC æ¡†æ¶ Dubbo æºç è§£æ](https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247484647&idx=1&sn=9eb7e47d06faca20d530c70eec3b8d5c&chksm=fa497b56cd3ef2408f807e66e0903a5d16fbed149ef7374021302901d6e0260ad717d903e8d4&scene=21#wechat_redirect)
    
- [ç½‘ç»œåº”ç”¨æ¡†æ¶ Netty æºç è§£æ](https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247485054&idx=2&sn=9f3b85f7b8454634da6c5c2ded9b4dba&chksm=fa4979cfcd3ef0d9d2dd92d8d1bd8f1553abc6e2095a5d743e0b2c2afe4955ea2bbbd7a4b79d&token=55862109&lang=zh_CN&scene=21#wechat_redirect)  
    
- [æ¶ˆæ¯ä¸­é—´ä»¶ RocketMQ æºç è§£æ](http://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247486256&idx=1&sn=81daccd3fcd2953456c917630636fb26&chksm=fa497481cd3efd97d9239f5eab060e49dea9876a6046eadba0effb878d2fb51f3ba5733e4c0b&scene=21#wechat_redirect)  
    
- [æ•°æ®åº“ä¸­é—´ä»¶ Sharding-JDBC å’Œ MyCAT æºç è§£æ](http://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247486257&idx=1&sn=4d3c9c675f8833157641a2e0b48e498c&chksm=fa497480cd3efd96fe17975b0b8b141e87fd0a62673e6a30b501460de80b3eb997056f09de08&scene=21#wechat_redirect)
    
- [ä½œä¸šè°ƒåº¦ä¸­é—´ä»¶ Elastic-Job æºç è§£æ](http://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247486258&idx=1&sn=ae5665ae9c3002b53f87cab44948a096&chksm=fa497483cd3efd950514da5a37160e7fd07f0a96f39265cf7ba3721985e5aadbdcbe7aafc34a&scene=21#wechat_redirect)
    
- [åˆ†å¸ƒå¼äº‹åŠ¡ä¸­é—´ä»¶ TCC-Transaction æºç è§£æ](http://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247486259&idx=1&sn=b023cf3dbf97e5da59db2f4ee632f5a6&chksm=fa497482cd3efd9402d71469f71863f71a6998b27e12ca2e00446b8178d79dcef0721d8e570a&scene=21#wechat_redirect)
    
- [Eureka å’Œ Hystrix æºç è§£æ](http://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247486260&idx=1&sn=8f14c0c191d6f8df6eb34202f4ad9708&chksm=fa497485cd3efd93937143a648bc1b530bc7d1f6f8ad4bf2ec112ffe34dee80b474605c22db0&scene=21#wechat_redirect)
    
- [Java å¹¶å‘æºç ](http://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247486261&idx=1&sn=bd69f26aadfc826f6313ffbb95e44ee5&chksm=fa497484cd3efd92352d6fb3d05ccbaebca2fafed6f18edbe5be70c99ba088db5c8a7a8080c1&scene=21#wechat_redirect)
    

[æ¥æºï¼šjuejin.im/post/  
5d3c46d2f265da1b9163dbce](https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect)

- [å¼•è¨€](https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect)
    
- [å¤šçº¿ç¨‹å¹¶å‘æ‰§è¡Œä»»åŠ¡ï¼Œå–ç»“æœå½’é›†](https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect)
    

- [çŠ¶æ€](https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect)
    
- [é˜Ÿåˆ—](https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect)
    
- [CASæ“ä½œ](https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect)
    

- [å®æˆ˜æ¼”ç»ƒ](https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect)
    
- [æ€»ç»“](https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect)
    
- [å°ç”œç‚¹](https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect)
    

[![å›¾ç‰‡](https://mmbiz.qpic.cn/mmbiz_png/JdLkEI9sZfelUcsFyqAM41IzJibLydyBom4ByREpF44XC8FuSeicnEF7FOOfwdINtjibTNsnZTciaxcIkpH9roI8BA/640?wx_fmt=png&wxfrom=13&tp=wxpic)](https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21&token=899450012&lang=zh_CN#wechat_redirect)

---

ä»€ä¹ˆ?å¯¹ä½ æ²¡æœ‰å¬é”™,ä¹Ÿæ²¡æœ‰çœ‹é”™ ..å¤šçº¿ç¨‹å¹¶å‘æ‰§è¡Œä»»åŠ¡ï¼Œå–ç»“æœå½’é›†~~ ä¸å†å¿§æ„....

## [å¼•è¨€](https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect)

å…ˆæ¥çœ‹ä¸€äº›APPçš„è·å–æ•°æ®,è¯¸å¦‚æ­¤ç±»,ä¸€ä¸ªé¡µé¢è·å–Nå¤šä¸ª,å¤šè¾¾10ä¸ªå·¦å³çš„ä¸€ä¸ªç”¨æˆ·è¡Œä¸ºæ•°æ®,æ¯”å¦‚:ç‚¹èµæ•°,å‘å¸ƒæ–‡ç« æ•°,ç‚¹èµæ•°,æ¶ˆæ¯æ•°,å…³æ³¨æ•°,æ”¶è—æ•°,ç²‰ä¸æ•°,å¡åˆ¸æ•°,çº¢åŒ…æ•°........... çœŸçš„æ˜¯å¤š~ æˆ‘ä»¬çœ‹äº›å›¾:

[![å›¾ç‰‡](https://mmbiz.qpic.cn/mmbiz_jpg/JdLkEI9sZfdO6JPF4T4o5RTyotDN3eLkWj1fN2icIYxjANLdziaK3tIQAG0HiaAkrZDDvq3fgKNXFdy9Zk4MYaCeQ/640?wx_fmt=jpeg&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1)](https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect)

[![å›¾ç‰‡](data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='1px' height='1px' viewBox='0 0 1 1' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg stroke='none' stroke-width='1' fill='none' fill-rule='evenodd' fill-opacity='0'%3E%3Cg transform='translate(-249.000000, -126.000000)' fill='%23FFFFFF'%3E%3Crect x='249' y='126' width='1' height='1'%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E)](https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect)

å¹³æ—¶è¦10+æ¥å£çš„å»è·å–æ•°æ®(å› ä¸ºå½“ä½ 10+ä¸ªæŸ¥è¯¢å†™ä¸€èµ·,é‚£ä¼°è®¡åˆ°åŠåˆ†é’Ÿæ‰èƒ½å“åº”äº†),ä¸€ä¸ªé¡µé¢ä¸ŠNå¤šæ¥å£,çœŸæ˜¯ç´¯æ­»å‰ç«¯çš„å®å®äº†,å‰ç«¯å¼€å¯å¤šçº¿ç¨‹ä¹Ÿç´¯å•Š,æˆ‘ä»¬åšåç«¯çš„è¦ä½“é‡ä¸€ä¸‹å‰ç«¯çš„å®å®ä»¬,æ¯•ç«Ÿæœ‰å¥è¯å«"**ç¨‹åºå‘˜ä½•è‹¦ä¸ºéš¾ç¨‹åºå‘˜~**Â "

ä»Šå¤©æˆ‘ä»¬ä¹Ÿå¯ä»¥ä¸€ä¸ªæ¥å£å°†è¿™äº›æ•°æ®è¿”å›~ è¿˜è´¼TMå¿«,è§£å†³ä¸²è¡Œç¼–ç¨‹,é˜»å¡ç¼–ç¨‹å¸¦æ¥çš„è‹¦æ¼~

> æ¨èä¸‹è‡ªå·±åšçš„ Spring Boot çš„å®æˆ˜é¡¹ç›®ï¼š
> 
> https://github.com/YunaiV/ruoyi-vue-pro

## [å¤šçº¿ç¨‹å¹¶å‘æ‰§è¡Œä»»åŠ¡ï¼Œå–ç»“æœå½’é›†](https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect)

ä»Šå¤©çŒªè„šå°±æ˜¯ Futureã€FutureTaskã€ExecutorService...

- ç”¨ä¸ŠFutureTaskä»»åŠ¡è·å–ç»“æœè€å°‘çš†å®œï¼Œå°±æ˜¯CPUæœ‰æ¶ˆè€—ã€‚FutureTaskä¹Ÿå¯ä»¥åšé—­é”ï¼ˆå®ç°äº†Futureçš„è¯­ä¹‰ï¼Œè¡¨ç¤ºä¸€ç§æŠ½è±¡çš„å¯è®¡ç®—çš„ç»“æœï¼‰ã€‚é€šè¿‡æŠŠCallable(ç›¸å½“äºä¸€ä¸ªå¯ç”Ÿæˆç»“æœçš„Runnable)ä½œä¸ºä¸€ä¸ªå±æ€§ï¼Œè¿›è€ŒæŠŠå®ƒè‡ªå·±ä½œä¸ºä¸€ä¸ªæ‰§è¡Œå™¨å»ç»§æ‰¿Runnable,**FutureTask å®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªæ”¯æŒå–æ¶ˆè¡Œä¸ºçš„å¼‚æ­¥ä»»åŠ¡æ‰§è¡Œå™¨**Â ã€‚
    
- Callableå°±æ˜¯ä¸€ä¸ªå›è°ƒæ¥å£,å¯ä»¥æ³›å‹å£°æ˜è¿”å›ç±»å‹,è€ŒRunnableæ˜¯çº¿ç¨‹å»æ‰§è¡Œçš„æ–¹æ³•.è¿™ä¸ªå¾ˆç®€å•~å¤§å®¶æƒ³æ·±å…¥äº†è§£å°±è¿›å»çœ‹æºç å¥½äº†ï½â€ƒå› ä¸ºçœŸçš„å¾ˆç®€å•ï½
    
- FutureTaskå®ç°äº†Futureï¼Œæä¾›äº†start, cancel, queryç­‰åŠŸèƒ½ï¼Œå¹¶ä¸”å®ç°äº†Runnableæ¥å£ï¼Œå¯ä»¥æäº¤ç»™çº¿ç¨‹æ‰§è¡Œã€‚
    
- Javaå¹¶å‘å·¥å…·ç±»çš„ä¸‰æ¿æ–§ Â  Â `çŠ¶æ€ï¼Œé˜Ÿåˆ—ï¼ŒCAS`
    

### [çŠ¶æ€](https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect)

Â `/**   Â Â Â Â Â *Â TheÂ runÂ stateÂ ofÂ thisÂ task,Â initiallyÂ NEW.Â Â TheÂ runÂ state   Â Â Â Â Â *Â transitionsÂ toÂ aÂ terminalÂ stateÂ onlyÂ inÂ methodsÂ set,   Â Â Â Â Â *Â setException,Â andÂ cancel.Â Â DuringÂ completion,Â stateÂ mayÂ takeÂ on   Â Â Â Â Â *Â transientÂ valuesÂ ofÂ COMPLETINGÂ (whileÂ outcomeÂ isÂ beingÂ set)Â or   Â Â Â Â Â *Â INTERRUPTINGÂ (onlyÂ whileÂ interruptingÂ theÂ runnerÂ toÂ satisfyÂ a   Â Â Â Â Â *Â cancel(true)).Â TransitionsÂ fromÂ theseÂ intermediateÂ toÂ final   Â Â Â Â Â *Â statesÂ useÂ cheaperÂ ordered/lazyÂ writesÂ becauseÂ valuesÂ areÂ unique   Â Â Â Â Â *Â andÂ cannotÂ beÂ furtherÂ modified.   Â Â Â Â Â *   Â Â Â Â Â *Â PossibleÂ stateÂ transitions:Â Â Â Â Â Â Â Â //å¯èƒ½å‘ç”Ÿçš„çŠ¶æ€è¿‡åº¦è¿‡ç¨‹   Â Â Â Â Â *Â NEWÂ ->Â COMPLETINGÂ ->Â NORMALÂ Â Â Â Â Â Â Â //Â åˆ›å»º-->å®Œæˆ-->æ­£å¸¸   Â Â Â Â Â *Â NEWÂ ->Â COMPLETINGÂ ->Â EXCEPTIONALÂ Â Â //Â åˆ›å»º-->å®Œæˆ-->å¼‚å¸¸   Â Â Â Â Â *Â NEWÂ ->Â CANCELLEDÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //Â åˆ›å»º-->å–æ¶ˆ   Â Â Â Â Â *Â NEWÂ ->Â INTERRUPTINGÂ ->Â INTERRUPTEDÂ //Â åˆ›å»º-->ä¸­æ–­ä¸­-->ä¸­æ–­ç»“æŸ   Â Â Â Â Â */      Â Â Â Â privateÂ volatileÂ intÂ state;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //Â æ‰§è¡Œå™¨çŠ¶æ€      Â Â Â Â privateÂ staticÂ finalÂ intÂ NEWÂ =Â 0;Â Â Â Â Â Â Â Â Â Â Â Â //Â åˆå§‹å€¼Â Â Â Â Â Â Â Â ç”±æ„é€ å‡½æ•°ä¿è¯   Â Â Â Â privateÂ staticÂ finalÂ intÂ COMPLETINGÂ =Â 1;Â Â Â Â Â //Â å®Œæˆè¿›è¡Œæ—¶Â Â Â Â æ­£åœ¨è®¾ç½®ä»»åŠ¡ç»“æœ   Â Â Â Â privateÂ staticÂ finalÂ intÂ NORMALÂ =Â 2;Â Â Â Â Â Â Â Â Â //Â æ­£å¸¸ç»“æŸÂ Â Â Â Â Â ä»»åŠ¡æ­£å¸¸æ‰§è¡Œå®Œæ¯•   Â Â Â Â privateÂ staticÂ finalÂ intÂ EXCEPTIONALÂ =Â 3;Â Â Â Â //Â å‘ç”Ÿå¼‚å¸¸Â Â Â Â Â Â ä»»åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­å‘ç”Ÿå¼‚å¸¸   Â Â Â Â privateÂ staticÂ finalÂ intÂ CANCELLEDÂ =Â 4;Â Â Â Â Â Â //Â å·²ç»å–æ¶ˆÂ Â Â Â Â Â ä»»åŠ¡å·²ç»å–æ¶ˆ   Â Â Â Â privateÂ staticÂ finalÂ intÂ INTERRUPTINGÂ =Â 5;Â Â Â //Â ä¸­æ–­è¿›è¡Œæ—¶Â Â Â Â æ­£åœ¨ä¸­æ–­è¿è¡Œä»»åŠ¡çš„çº¿ç¨‹   Â Â Â Â privateÂ staticÂ finalÂ intÂ INTERRUPTEDÂ =Â 6;Â Â Â Â //Â ä¸­æ–­ç»“æŸÂ Â Â Â Â Â ä»»åŠ¡è¢«ä¸­æ–­      Â Â Â Â /**Â TheÂ underlyingÂ callable;Â nulledÂ outÂ afterÂ runningÂ */   Â Â Â Â privateÂ Callable<V>Â callable;   Â Â Â Â /**Â TheÂ resultÂ toÂ returnÂ orÂ exceptionÂ toÂ throwÂ fromÂ get()Â */   Â Â Â Â privateÂ ObjectÂ outcome;Â //Â non-volatile,Â protectedÂ byÂ stateÂ reads/writes   Â Â Â Â /**Â TheÂ threadÂ runningÂ theÂ callable;Â CASedÂ duringÂ run()Â */   Â Â Â Â privateÂ volatileÂ ThreadÂ runner;   Â Â Â Â /**Â TreiberÂ stackÂ ofÂ waitingÂ threadsÂ */   Â Â Â Â privateÂ volatileÂ WaitNodeÂ waiters;`

è¿˜ä¸æ˜ç™½å°±çœ‹å›¾:

[![å›¾ç‰‡](data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='1px' height='1px' viewBox='0 0 1 1' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg stroke='none' stroke-width='1' fill='none' fill-rule='evenodd' fill-opacity='0'%3E%3Cg transform='translate(-249.000000, -126.000000)' fill='%23FFFFFF'%3E%3Crect x='249' y='126' width='1' height='1'%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E)](https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect)

[![å›¾ç‰‡](data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='1px' height='1px' viewBox='0 0 1 1' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg stroke='none' stroke-width='1' fill='none' fill-rule='evenodd' fill-opacity='0'%3E%3Cg transform='translate(-249.000000, -126.000000)' fill='%23FFFFFF'%3E%3Crect x='249' y='126' width='1' height='1'%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E)](https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect)

`publicÂ interfaceÂ Future<T>Â {   Â Â Â Â /**   Â Â Â Â *å–æ¶ˆä»»åŠ¡   Â Â Â Â *@paramÂ mayInterruptIfRunning   Â Â Â Â *æ˜¯å¦å…è®¸å–æ¶ˆæ­£åœ¨æ‰§è¡Œå´æ²¡æœ‰æ‰§è¡Œå®Œæ¯•çš„ä»»åŠ¡ï¼Œå¦‚æœè®¾ç½®trueï¼Œåˆ™è¡¨ç¤ºå¯ä»¥å–æ¶ˆæ­£åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­çš„ä»»åŠ¡   Â Â Â Â *å¦‚æœä»»åŠ¡æ­£åœ¨æ‰§è¡Œï¼Œåˆ™è¿”å›true   Â Â Â Â *å¦‚æœä»»åŠ¡è¿˜æ²¡æœ‰æ‰§è¡Œï¼Œåˆ™æ— è®ºmayInterruptIfRunningä¸ºtrueè¿˜æ˜¯falseï¼Œè¿”å›true   Â Â Â Â *å¦‚æœä»»åŠ¡å·²ç»å®Œæˆï¼Œåˆ™æ— è®ºmayInterruptIfRunningä¸ºtrueè¿˜æ˜¯falseï¼Œè¿”å›false   Â Â Â Â */   Â Â Â Â booleanÂ cancel(booleanÂ mayInterruptIfRunning);   Â Â Â Â /**   Â Â Â Â *ä»»åŠ¡æ˜¯å¦è¢«å–æ¶ˆæˆåŠŸï¼Œå¦‚æœåœ¨ä»»åŠ¡æ­£å¸¸å®Œæˆå‰è¢«å–æ¶ˆæˆåŠŸï¼Œåˆ™è¿”å›Â true   Â Â Â Â */   Â Â Â Â booleanÂ isCancelled();   Â Â Â Â /**   Â Â Â Â *ä»»åŠ¡æ˜¯å¦å®Œæˆ   Â Â Â Â */   Â Â Â Â booleanÂ isDone();   Â Â Â Â /**   Â Â Â Â *é€šè¿‡é˜»å¡è·å–æ‰§è¡Œç»“æœ   Â Â Â Â */   Â Â Â Â TÂ get()Â throwsÂ InterruptedException,Â ExecutionException;   Â Â Â Â /**   Â Â Â Â *é€šè¿‡é˜»å¡è·å–æ‰§è¡Œç»“æœã€‚å¦‚æœåœ¨æŒ‡å®šçš„æ—¶é—´å†…æ²¡æœ‰è¿”å›ï¼Œåˆ™è¿”å›null   Â Â Â Â */   Â Â Â Â TÂ get(longÂ timeout,Â TimeUnitÂ unit)   Â Â Â Â Â Â Â Â throwsÂ InterruptedException,Â ExecutionException,Â TimeoutException;   }      `

- Future
    
    Â Â `(1)cancleÂ Â Â Â å¯ä»¥åœæ­¢ä»»åŠ¡çš„æ‰§è¡ŒÂ ä½†ä¸ä¸€å®šæˆåŠŸÂ çœ‹è¿”å›å€¼trueÂ orÂ Â false   Â Â (2)getÂ Â Â Â Â Â Â é˜»å¡è·å–callableçš„ä»»åŠ¡ç»“æœ,å³geté˜»å¡ä½è°ƒç”¨çº¿ç¨‹ï¼Œç›´è‡³è®¡ç®—å®Œæˆè¿”å›ç»“æœ   Â Â (3)isCancelledÂ Â æ˜¯å¦å–æ¶ˆæˆåŠŸ   Â Â (4)isDoneÂ Â Â Â æ˜¯å¦å®Œæˆ`
    

> **é‡ç‚¹è¯´æ˜:**

> Furture.get()è·å–æ‰§è¡Œç»“æœçš„å€¼ï¼Œå–å†³äºæ‰§è¡Œçš„çŠ¶æ€ï¼Œå¦‚æœä»»åŠ¡å®Œæˆï¼Œä¼šç«‹å³è¿”å›ç»“æœï¼Œå¦åˆ™ä¸€ç›´é˜»å¡ç›´åˆ°ä»»åŠ¡è¿›å…¥å®ŒæˆçŠ¶æ€ï¼Œç„¶åè¿”å›ç»“æœæˆ–è€…æŠ›å‡ºå¼‚å¸¸ã€‚

> â€œè¿è¡Œå®Œæˆâ€è¡¨ç¤ºè®¡ç®—çš„æ‰€æœ‰å¯èƒ½ç»“æŸçš„çŠ¶æ€ï¼ŒåŒ…å«æ­£å¸¸ç»“æŸï¼Œç”±äºå–æ¶ˆè€Œç»“æŸå’Œç”±äºå¼‚å¸¸è€Œç»“æŸã€‚å½“è¿›å…¥å®ŒæˆçŠ¶æ€ï¼Œä»–ä¼šåœæ­¢åœ¨è¿™ä¸ªçŠ¶æ€ä¸Šï¼Œåªè¦stateä¸å¤„äºÂ `NEW`Â çŠ¶æ€ï¼Œå°±è¯´æ˜ä»»åŠ¡å·²ç»æ‰§è¡Œå®Œæ¯•ã€‚

FutureTaskè´Ÿè´£å°†è®¡ç®—ç»“æœä»æ‰§è¡Œä»»åŠ¡çš„çº¿ç¨‹ä¼ é€’åˆ°è°ƒç”¨è¿™ä¸ªçº¿ç¨‹çš„çº¿ç¨‹ï¼Œè€Œä¸”ç¡®ä¿äº†,ä¼ é€’è¿‡ç¨‹ä¸­ç»“æœçš„å®‰å…¨å‘å¸ƒ

UNSAFE æ— é”ç¼–ç¨‹æŠ€æœ¯,ç¡®ä¿äº†çº¿ç¨‹çš„å®‰å…¨æ€§~ ä¸ºäº†ä¿æŒæ— é”ç¼–ç¨‹CPUçš„æ¶ˆè€—,æ‰€ä»¥ç”¨çŠ¶æ€æ ‡è®°,å‡å°‘ç©ºè½¬çš„æ—¶å€™CPUçš„å‹åŠ›

- ä»»åŠ¡æœ¬å°Šï¼šcallable
    
- ä»»åŠ¡çš„æ‰§è¡Œè€…ï¼šrunner
    
- ä»»åŠ¡çš„ç»“æœï¼šoutcome
    
- è·å–ä»»åŠ¡çš„ç»“æœï¼šstate + outcome + waiters
    
- ä¸­æ–­æˆ–è€…å–æ¶ˆä»»åŠ¡ï¼šstate + runner + waiters
    

**runæ–¹æ³•**

1. æ£€æŸ¥stateï¼ŒéNEWï¼Œè¯´æ˜å·²ç»å¯åŠ¨ï¼Œç›´æ¥è¿”å›ï¼›å¦åˆ™ï¼Œè®¾ç½®runnerä¸ºå½“å‰çº¿ç¨‹ï¼ŒæˆåŠŸåˆ™ç»§ç»­ï¼Œå¦åˆ™ï¼Œè¿”å›ã€‚
    
2. è°ƒç”¨Callable.call()æ–¹æ³•æ‰§è¡Œä»»åŠ¡ï¼ŒæˆåŠŸåˆ™è°ƒç”¨set(result)æ–¹æ³•ï¼Œå¤±è´¥åˆ™è°ƒç”¨setException(ex)æ–¹æ³•ï¼Œæœ€ç»ˆéƒ½ä¼šè®¾ç½®stateï¼Œå¹¶è°ƒç”¨finishCompletion()æ–¹æ³•ï¼Œå”¤é†’é˜»å¡åœ¨get()æ–¹æ³•ä¸Šçš„çº¿ç¨‹ä»¬ã€‚
    
3. å¦‚æ³¨é‡Šæ‰€ç¤ºï¼Œå¦‚æœçœç•¥ranå˜é‡ï¼Œå¹¶æŠŠ"set(result);" è¯­å¥ç§»åŠ¨åˆ°tryä»£ç å—"ran = true;" è¯­å¥å¤„ï¼Œä¼šæ€æ ·å‘¢ï¼Ÿé¦–å…ˆï¼Œä»ä»£ç é€»è¾‘ä¸Šçœ‹ï¼Œæ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œä½†æ˜¯ï¼Œè€ƒè™‘åˆ°"set(result);"æ–¹æ³•ä¸‡ä¸€æŠ›å‡ºå¼‚å¸¸ç”šè‡³æ˜¯é”™è¯¯äº†å‘¢ï¼Ÿset()æ–¹æ³•æœ€ç»ˆä¼šè°ƒç”¨åˆ°ç”¨æˆ·è‡ªå®šä¹‰çš„done()æ–¹æ³•ï¼Œæ‰€ä»¥ï¼Œä¸å¯çœç•¥ã€‚
    
4. å¦‚æœstateä¸ºINTERRUPTING, åˆ™ä¸»åŠ¨è®©å‡ºCPUï¼Œè‡ªæ—‹ç­‰å¾…åˆ«çš„çº¿ç¨‹æ‰§è¡Œå®Œä¸­æ–­æµç¨‹ã€‚è§handlePossibleCancellationInterrupt(int s) æ–¹æ³•ã€‚
    

`publicÂ voidÂ run()Â {   Â Â Â Â Â Â Â Â //Â UNSAFE.compareAndSwapObjectï¼ŒÂ CASä¿è¯Callableä»»åŠ¡åªè¢«æ‰§è¡Œä¸€æ¬¡Â æ— é”ç¼–ç¨‹   Â Â Â Â Â Â Â Â ifÂ (stateÂ !=Â NEWÂ ||Â !UNSAFE.compareAndSwapObject(this,Â runnerOffset,Â null,Â Thread.currentThread()))   Â Â Â Â Â Â Â Â Â Â Â Â return;   Â Â Â Â Â Â Â Â tryÂ {   Â Â Â Â Â Â Â Â Â Â Â Â Callable<V>Â cÂ =Â callable;Â //Â æ‹¿åˆ°æ‰§è¡Œä»»åŠ¡   Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (cÂ !=Â nullÂ &&Â stateÂ ==Â NEW)Â {Â //Â ä»»åŠ¡ä¸ä¸ºç©ºï¼Œå¹¶ä¸”æ‰§è¡Œå™¨çŠ¶æ€æ˜¯åˆå§‹å€¼ï¼Œæ‰ä¼šæ‰§è¡Œï¼›å¦‚æœå–æ¶ˆå°±ä¸æ‰§è¡Œäº†   Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â VÂ result;   Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â booleanÂ ran;Â //Â è®°å½•æ˜¯å¦æ‰§è¡ŒæˆåŠŸ   Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â tryÂ {   Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â resultÂ =Â c.call();Â //Â æ‰§è¡Œä»»åŠ¡   Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ranÂ =Â true;Â //Â æˆåŠŸ   Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }Â catchÂ (ThrowableÂ ex)Â {   Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â resultÂ =Â null;Â //Â å¼‚å¸¸ï¼Œæ¸…ç©ºç»“æœ   Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ranÂ =Â false;Â //Â å¤±è´¥   Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â setException(ex);Â //Â è®°å½•å¼‚å¸¸   Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }   Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (ran)Â //Â é—®é¢˜ï¼šranå˜é‡å¯ä»¥çœç•¥å—ï¼ŒæŠŠset(result);ç§»åˆ°tryå—é‡Œé¢ï¼Ÿ   Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â set(result);Â //Â è®¾ç½®ç»“æœ   Â Â Â Â Â Â Â Â Â Â Â Â }   Â Â Â Â Â Â Â Â }Â finallyÂ {   Â Â Â Â Â Â Â Â Â Â Â Â runnerÂ =Â null;Â //Â ç›´åˆ°setçŠ¶æ€å‰ï¼Œrunnerä¸€ç›´éƒ½æ˜¯éç©ºçš„ï¼Œä¸ºäº†é˜²æ­¢å¹¶å‘è°ƒç”¨run()æ–¹æ³•ã€‚   Â Â Â Â Â Â Â Â Â Â Â Â intÂ sÂ =Â state;   Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (sÂ >=Â INTERRUPTING)Â //Â æœ‰åˆ«çš„çº¿ç¨‹è¦ä¸­æ–­å½“å‰çº¿ç¨‹ï¼ŒæŠŠCPUè®©å‡ºå»ï¼Œè‡ªæ—‹ç­‰ä¸€ä¸‹   Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â handlePossibleCancellationInterrupt(s);   Â Â Â Â Â Â Â Â }   Â Â Â Â }      Â Â Â Â Â Â privateÂ voidÂ handlePossibleCancellationInterrupt(intÂ s)Â {   Â Â Â Â Â Â Â Â Â ifÂ (sÂ ==Â INTERRUPTING)Â //Â å½“stateä¸ºINTERRUPTINGæ—¶   Â Â Â Â Â Â Â Â Â Â Â Â Â whileÂ (stateÂ ==Â INTERRUPTING)Â //Â è¡¨ç¤ºæœ‰çº¿ç¨‹æ­£åœ¨ä¸­æ–­å½“å‰çº¿ç¨‹   Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Thread.yield();Â //Â è®©å‡ºCPUï¼Œè‡ªæ—‹ç­‰å¾…ä¸­æ–­   Â Â Â Â Â }      `

> å†å•°å—¦ä¸‹: runæ–¹æ³•é‡ç‚¹åšäº†ä»¥ä¸‹å‡ ä»¶äº‹ï¼š

`å°†runnerå±æ€§è®¾ç½®æˆå½“å‰æ­£åœ¨æ‰§è¡Œrunæ–¹æ³•çš„çº¿ç¨‹   è°ƒç”¨callableæˆå‘˜å˜é‡çš„callæ–¹æ³•æ¥æ‰§è¡Œä»»åŠ¡   è®¾ç½®æ‰§è¡Œç»“æœoutcome, å¦‚æœæ‰§è¡ŒæˆåŠŸ, åˆ™outcomeä¿å­˜çš„å°±æ˜¯æ‰§è¡Œç»“æœï¼›å¦‚æœæ‰§è¡Œè¿‡ç¨‹ä¸­å‘ç”Ÿäº†å¼‚å¸¸, åˆ™outcomeä¸­ä¿å­˜çš„å°±æ˜¯å¼‚å¸¸ï¼Œè®¾ç½®ç»“æœä¹‹å‰ï¼Œå…ˆå°†stateçŠ¶æ€è®¾ä¸ºä¸­é—´æ€   å¯¹outcomeçš„èµ‹å€¼å®Œæˆåï¼Œè®¾ç½®stateçŠ¶æ€ä¸ºç»ˆæ­¢æ€(NORMALæˆ–è€…EXCEPTIONAL)   å”¤é†’Treiberæ ˆä¸­æ‰€æœ‰ç­‰å¾…çš„çº¿ç¨‹   å–„åæ¸…ç†(waiters,Â callableï¼Œrunnerè®¾ä¸ºnull)   æ£€æŸ¥æ˜¯å¦æœ‰é—æ¼çš„ä¸­æ–­ï¼Œå¦‚æœæœ‰ï¼Œç­‰å¾…ä¸­æ–­çŠ¶æ€å®Œæˆã€‚      `

> æ€ä¹ˆèƒ½å°‘äº†**get**Â æ–¹æ³•å‘¢,ä¸€ç›´é˜»å¡è·å–å‚è§:awaitDone

Â Â Â Â `publicÂ VÂ get()Â throwsÂ InterruptedException,Â ExecutionExceptionÂ {   Â Â Â Â Â Â Â Â intÂ sÂ =Â state;Â //Â æ‰§è¡Œå™¨çŠ¶æ€   Â Â Â Â Â Â Â Â Â ifÂ (sÂ <=Â COMPLETING)Â //Â å¦‚æœçŠ¶æ€å°äºç­‰äºCOMPLETINGï¼Œè¯´æ˜ä»»åŠ¡æ­£åœ¨æ‰§è¡Œï¼Œéœ€è¦ç­‰å¾…   Â Â Â Â Â Â Â Â Â Â Â Â Â sÂ =Â awaitDone(false,Â 0L);Â //Â ç­‰å¾…   Â Â Â Â Â Â Â Â Â returnÂ report(s);Â //Â æŠ¥å‘Šç»“æœ   Â Â Â Â Â }`

> é¡ºä¾¿å·å·çœ‹ä¸‹**get(long, TimeUnit)**Â ,å°±æ˜¯getçš„æ–¹æ³•æ‰©å±•,å¢åŠ äº†è¶…æ—¶æ—¶é—´,è¶…æ—¶åæˆ‘è¿˜æ²¡æ‹¿åˆ°å°±ç”Ÿæ°”æŠ›å¼‚å¸¸....

`publicÂ VÂ get(longÂ timeout,Â TimeUnitÂ unit)Â throwsÂ InterruptedException,Â ExecutionException,Â TimeoutExceptionÂ {   Â Â Â Â Â Â Â Â ifÂ (unitÂ ==Â null)Â //Â å‚æ•°æ ¡éªŒ   Â Â Â Â Â Â Â Â Â Â Â Â throwÂ newÂ NullPointerException();   Â Â Â Â Â Â Â Â intÂ sÂ =Â state;Â //Â æ‰§è¡Œå™¨çŠ¶æ€   Â Â Â Â Â Â Â Â ifÂ (sÂ <=Â COMPLETINGÂ &&Â (sÂ =Â awaitDone(true,Â unit.toNanos(timeout)))Â <=Â COMPLETING)Â //Â å¦‚æœçŠ¶æ€å°äºç­‰äºCOMPLETINGï¼Œè¯´æ˜ä»»åŠ¡æ­£åœ¨æ‰§è¡Œï¼Œéœ€è¦ç­‰å¾…ï¼›ç­‰å¾…æŒ‡å®šæ—¶é—´ï¼Œstateä¾ç„¶å°äºç­‰äºCOMPLETING   Â Â Â Â Â Â Â Â Â Â Â Â throwÂ newÂ TimeoutException();Â //Â æŠ›å‡ºè¶…æ—¶å¼‚å¸¸   Â Â Â Â Â Â Â Â returnÂ report(s);Â //Â æŠ¥å‘Šç»“æœ   Â Â Â Â }      `

> é‚£ä¹ˆå†çœ‹**awaitDone**Â ,è¦çŸ¥é“ä¼šå†™æ­»å¾ªç¯`while(true)|for (;;)`çš„éƒ½æ˜¯é«˜æ‰‹~

`privateÂ intÂ awaitDone(booleanÂ timed,Â longÂ nanos)Â throwsÂ InterruptedExceptionÂ {   Â Â Â Â Â Â Â Â finalÂ longÂ deadlineÂ =Â timedÂ ?Â System.nanoTime()Â +Â nanosÂ :Â 0L;Â //Â è®¡ç®—deadline   Â Â Â Â Â Â Â Â WaitNodeÂ qÂ =Â null;Â //Â ç­‰å¾…ç»“ç‚¹   Â Â Â Â Â Â Â Â booleanÂ queuedÂ =Â false;Â //Â æ˜¯å¦å·²ç»å…¥é˜Ÿ   Â Â Â Â Â Â Â Â forÂ (;;)Â {   Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (Thread.interrupted())Â {Â //Â å¦‚æœå½“å‰çº¿ç¨‹å·²ç»æ ‡è®°ä¸­æ–­ï¼Œåˆ™ç›´æ¥ç§»é™¤æ­¤ç»“ç‚¹ï¼Œå¹¶æŠ›å‡ºä¸­æ–­å¼‚å¸¸   Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â removeWaiter(q);   Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â throwÂ newÂ InterruptedException();   Â Â Â Â Â Â Â Â Â Â Â Â }      Â Â Â Â Â Â Â Â Â Â Â Â intÂ sÂ =Â state;Â //Â æ‰§è¡Œå™¨çŠ¶æ€   Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (sÂ >Â COMPLETING)Â {Â //Â å¦‚æœçŠ¶æ€å¤§äºCOMPLETINGï¼Œè¯´æ˜ä»»åŠ¡å·²ç»å®Œæˆï¼Œæˆ–è€…å·²ç»å–æ¶ˆï¼Œç›´æ¥è¿”å›   Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (qÂ !=Â null)   Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â q.threadÂ =Â null;Â //Â å¤ä½çº¿ç¨‹å±æ€§   Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â returnÂ s;Â //Â è¿”å›   Â Â Â Â Â Â Â Â Â Â Â Â }Â elseÂ ifÂ (sÂ ==Â COMPLETING)Â //Â å¦‚æœçŠ¶æ€ç­‰äºCOMPLETINGï¼Œè¯´æ˜æ­£åœ¨æ•´ç†ç»“æœï¼Œè‡ªæ—‹ç­‰å¾…ä¸€ä¼šå„¿   Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Thread.yield();   Â Â Â Â Â Â Â Â Â Â Â Â elseÂ ifÂ (qÂ ==Â null)Â //Â åˆå§‹ï¼Œæ„å»ºç»“ç‚¹   Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â qÂ =Â newÂ WaitNode();   Â Â Â Â Â Â Â Â Â Â Â Â elseÂ ifÂ (!queued)Â //Â è¿˜æ²¡å…¥é˜Ÿï¼Œåˆ™CASå…¥é˜Ÿ   Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â queuedÂ =Â UNSAFE.compareAndSwapObject(this,Â waitersOffset,Â q.nextÂ =Â waiters,Â q);   Â Â Â Â Â Â Â Â Â Â Â Â elseÂ ifÂ (timed)Â {Â //Â æ˜¯å¦å…è®¸è¶…æ—¶   Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â nanosÂ =Â deadlineÂ -Â System.nanoTime();Â //Â è®¡ç®—ç­‰å¾…æ—¶é—´   Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (nanosÂ <=Â 0L)Â {Â //Â è¶…æ—¶   Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â removeWaiter(q);Â //Â ç§»é™¤ç»“ç‚¹   Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â returnÂ state;Â //Â è¿”å›ç»“æœ   Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }   Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â LockSupport.parkNanos(this,Â nanos);Â //Â çº¿ç¨‹é˜»å¡æŒ‡å®šæ—¶é—´   Â Â Â Â Â Â Â Â Â Â Â Â }Â else   Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â LockSupport.park(this);Â //Â é˜»å¡çº¿ç¨‹   Â Â Â Â Â Â Â Â }   Â Â Â Â }         `

è‡³æ­¤,çº¿ç¨‹å®‰æ’ä»»åŠ¡å’Œè·å–æˆ‘å°±ä¸å•°å—¦äº†~~~~è¿˜è¦å¾ˆå¤šæ¢ç´¢çš„,æ¯•ç«Ÿ**å¸¦è–ªèŠå¤©**Â æ¯”è¾ƒç´§å¼ ,æˆ‘å°±ä¸å¤šèµ˜è¿°äº†~

### [é˜Ÿåˆ—](https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect)

æ¥ç€æˆ‘ä»¬æ¥çœ‹é˜Ÿåˆ—ï¼Œåœ¨FutureTaskä¸­ï¼Œé˜Ÿåˆ—çš„å®ç°æ˜¯ä¸€ä¸ªå•å‘é“¾è¡¨ï¼Œå®ƒè¡¨ç¤ºæ‰€æœ‰ç­‰å¾…ä»»åŠ¡æ‰§è¡Œå®Œæ¯•çš„çº¿ç¨‹çš„é›†åˆã€‚æˆ‘ä»¬çŸ¥é“ï¼ŒFutureTaskå®ç°äº†Futureæ¥å£ï¼Œå¯ä»¥è·å–â€œTaskâ€çš„æ‰§è¡Œç»“æœï¼Œé‚£ä¹ˆå¦‚æœè·å–ç»“æœæ—¶ï¼Œä»»åŠ¡è¿˜æ²¡æœ‰æ‰§è¡Œå®Œæ¯•æ€ä¹ˆåŠå‘¢ï¼Ÿé‚£ä¹ˆè·å–ç»“æœçš„çº¿ç¨‹å°±ä¼šåœ¨ä¸€ä¸ªç­‰å¾…é˜Ÿåˆ—ä¸­æŒ‚èµ·ï¼Œç›´åˆ°ä»»åŠ¡æ‰§è¡Œå®Œæ¯•è¢«å”¤é†’ã€‚è¿™ä¸€ç‚¹æœ‰ç‚¹ç±»ä¼¼äºAQSä¸­çš„sync queueï¼Œåœ¨ä¸‹æ–‡çš„åˆ†æä¸­ï¼Œå¤§å®¶å¯ä»¥è‡ªå·±å¯¹ç…§å®ƒä»¬çš„å¼‚åŒç‚¹ã€‚

æˆ‘ä»¬å‰é¢è¯´è¿‡ï¼Œåœ¨å¹¶å‘ç¼–ç¨‹ä¸­ä½¿ç”¨é˜Ÿåˆ—é€šå¸¸æ˜¯å°†å½“å‰çº¿ç¨‹åŒ…è£…æˆæŸç§ç±»å‹çš„æ•°æ®ç»“æ„æ‰”åˆ°ç­‰å¾…é˜Ÿåˆ—ä¸­ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹é˜Ÿåˆ—ä¸­çš„æ¯ä¸€ä¸ªèŠ‚ç‚¹æ˜¯æ€ä¹ˆä¸ªç»“æ„ï¼š

`staticÂ finalÂ classÂ WaitNodeÂ {   Â Â Â Â volatileÂ ThreadÂ thread;   Â Â Â Â volatileÂ WaitNodeÂ next;   Â Â Â Â WaitNode()Â {Â threadÂ =Â Thread.currentThread();Â }   }         `

å¯è§ï¼Œç›¸æ¯”äºAQSçš„`sync queue`æ‰€ä½¿ç”¨çš„åŒå‘é“¾è¡¨ä¸­çš„`Node`ï¼Œè¿™ä¸ª`WaitNode`è¦ç®€å•å¤šäº†ï¼Œå®ƒåªåŒ…å«äº†ä¸€ä¸ªè®°å½•çº¿ç¨‹çš„threadå±æ€§å’ŒæŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„nextå±æ€§ã€‚

å€¼å¾—ä¸€æçš„æ˜¯ï¼ŒFutureTaskä¸­çš„è¿™ä¸ªå•å‘é“¾è¡¨æ˜¯å½“åšæ ˆæ¥ä½¿ç”¨çš„ï¼Œç¡®åˆ‡æ¥è¯´æ˜¯å½“åšTreiberæ ˆæ¥ä½¿ç”¨çš„ï¼Œä¸äº†è§£Treiberæ ˆæ˜¯ä¸ªå•¥çš„å¯ä»¥ç®€å•çš„æŠŠå®ƒå½“åšæ˜¯ä¸€ä¸ªçº¿ç¨‹å®‰å…¨çš„æ ˆï¼Œå®ƒä½¿ç”¨CASæ¥å®Œæˆå…¥æ ˆå‡ºæ ˆæ“ä½œ(æƒ³è¿›ä¸€æ­¥äº†è§£çš„è¯å¯ä»¥çœ‹è¿™ç¯‡æ–‡ç« )ã€‚ä¸ºå•¥è¦ä½¿ç”¨ä¸€ä¸ªçº¿ç¨‹å®‰å…¨çš„æ ˆå‘¢ï¼Œå› ä¸ºåŒä¸€æ—¶åˆ»å¯èƒ½æœ‰å¤šä¸ªçº¿ç¨‹éƒ½åœ¨è·å–ä»»åŠ¡çš„æ‰§è¡Œç»“æœï¼Œå¦‚æœä»»åŠ¡è¿˜åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œåˆ™è¿™äº›çº¿ç¨‹å°±è¦è¢«åŒ…è£…æˆWaitNodeæ‰”åˆ°Treiberæ ˆçš„æ ˆé¡¶ï¼Œå³å®Œæˆå…¥æ ˆæ“ä½œï¼Œè¿™æ ·å°±æœ‰å¯èƒ½å‡ºç°å¤šä¸ªçº¿ç¨‹åŒæ—¶å…¥æ ˆçš„æƒ…å†µï¼Œå› æ­¤éœ€è¦ä½¿ç”¨CASæ“ä½œä¿è¯å…¥æ ˆçš„çº¿ç¨‹å®‰å…¨ï¼Œå¯¹äºå‡ºæ ˆçš„æƒ…å†µä¹Ÿæ˜¯åŒç†ã€‚

ç”±äºFutureTaskä¸­çš„é˜Ÿåˆ—æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ª`Treiber`(é©±åŠ¨)æ ˆï¼Œé‚£ä¹ˆä½¿ç”¨è¿™ä¸ªé˜Ÿåˆ—å°±åªéœ€è¦ä¸€ä¸ªæŒ‡å‘æ ˆé¡¶èŠ‚ç‚¹çš„æŒ‡é’ˆå°±è¡Œäº†ï¼Œåœ¨FutureTaskä¸­ï¼Œå°±æ˜¯waiterså±æ€§ï¼š

`/**Â TreiberÂ stackÂ ofÂ waitingÂ threadsÂ */   privateÂ volatileÂ WaitNodeÂ waiters;         `

äº‹å®ä¸Šï¼Œå®ƒå°±æ˜¯æ•´ä¸ªå•å‘é“¾è¡¨çš„å¤´èŠ‚ç‚¹ã€‚

ç»¼ä¸Šï¼ŒFutureTaskä¸­æ‰€ä½¿ç”¨çš„é˜Ÿåˆ—çš„ç»“æ„å¦‚ä¸‹ï¼š

[![å›¾ç‰‡](data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='1px' height='1px' viewBox='0 0 1 1' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg stroke='none' stroke-width='1' fill='none' fill-rule='evenodd' fill-opacity='0'%3E%3Cg transform='translate(-249.000000, -126.000000)' fill='%23FFFFFF'%3E%3Crect x='249' y='126' width='1' height='1'%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E)](https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect)

### [CASæ“ä½œ](https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect)

CASæ“ä½œå¤§å¤šæ•°æ˜¯ç”¨æ¥æ”¹å˜çŠ¶æ€çš„ï¼Œåœ¨FutureTaskä¸­ä¹Ÿä¸ä¾‹å¤–ã€‚æˆ‘ä»¬ä¸€èˆ¬åœ¨é™æ€ä»£ç å—ä¸­åˆå§‹åŒ–éœ€è¦CASæ“ä½œçš„å±æ€§çš„åç§»é‡ï¼š

Â Â Â Â `//Â UnsafeÂ mechanics   Â Â Â Â privateÂ staticÂ finalÂ sun.misc.UnsafeÂ UNSAFE;   Â Â Â Â privateÂ staticÂ finalÂ longÂ stateOffset;   Â Â Â Â privateÂ staticÂ finalÂ longÂ runnerOffset;   Â Â Â Â privateÂ staticÂ finalÂ longÂ waitersOffset;   Â Â Â Â staticÂ {   Â Â Â Â Â Â Â Â tryÂ {   Â Â Â Â Â Â Â Â Â Â Â Â UNSAFEÂ =Â sun.misc.Unsafe.getUnsafe();   Â Â Â Â Â Â Â Â Â Â Â Â Class<?>Â kÂ =Â FutureTask.class;   Â Â Â Â Â Â Â Â Â Â Â Â stateOffsetÂ =Â UNSAFE.objectFieldOffset(k.getDeclaredField("state"));   Â Â Â Â Â Â Â Â Â Â Â Â runnerOffsetÂ =Â UNSAFE.objectFieldOffset(k.getDeclaredField("runner"));   Â Â Â Â Â Â Â Â Â Â Â Â waitersOffsetÂ =Â UNSAFE.objectFieldOffset(k.getDeclaredField("waiters"));   Â Â Â Â Â Â Â Â }Â catchÂ (ExceptionÂ e)Â {   Â Â Â Â Â Â Â Â Â Â Â Â throwÂ newÂ Error(e);   Â Â Â Â Â Â Â Â }   Â Â Â Â }`

ä»è¿™ä¸ªé™æ€ä»£ç å—ä¸­æˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹å‡ºï¼ŒCASæ“ä½œä¸»è¦é’ˆå¯¹3ä¸ªå±æ€§ï¼ŒåŒ…æ‹¬stateã€runnerå’Œwaitersï¼Œè¯´æ˜è¿™3ä¸ªå±æ€§åŸºæœ¬æ˜¯ä¼šè¢«å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®çš„ã€‚å…¶ä¸­stateå±æ€§ä»£è¡¨äº†ä»»åŠ¡çš„çŠ¶æ€ï¼Œwaiterså±æ€§ä»£è¡¨äº†æŒ‡å‘æ ˆé¡¶èŠ‚ç‚¹çš„æŒ‡é’ˆï¼Œè¿™ä¸¤ä¸ªæˆ‘ä»¬ä¸Šé¢å·²ç»åˆ†æè¿‡äº†ã€‚runnerå±æ€§ä»£è¡¨äº†æ‰§è¡ŒFutureTaskä¸­çš„â€œTaskâ€çš„çº¿ç¨‹ã€‚ä¸ºä»€ä¹ˆéœ€è¦ä¸€ä¸ªå±æ€§æ¥è®°å½•æ‰§è¡Œä»»åŠ¡çš„çº¿ç¨‹å‘¢ï¼Ÿè¿™æ˜¯ä¸ºäº†ä¸­æ–­æˆ–è€…å–æ¶ˆä»»åŠ¡åšå‡†å¤‡çš„ï¼Œåªæœ‰çŸ¥é“äº†æ‰§è¡Œä»»åŠ¡çš„çº¿ç¨‹æ˜¯è°ï¼Œæˆ‘ä»¬æ‰èƒ½å»ä¸­æ–­å®ƒã€‚

å®šä¹‰å®Œå±æ€§çš„åç§»é‡ä¹‹åï¼Œæ¥ä¸‹æ¥å°±æ˜¯CASæ“ä½œæœ¬èº«äº†ã€‚åœ¨FutureTaskï¼ŒCASæ“ä½œæœ€ç»ˆè°ƒç”¨çš„è¿˜æ˜¯`Unsafe`ç±»çš„`compareAndSwapXXX`æ–¹æ³•ï¼Œå…³äºUnsafeï¼Œç”±äº**å¸¦è–ªç æ–‡**Â è¿™é‡Œä¸å†èµ˜è¿°ã€‚

> æ¨èä¸‹è‡ªå·±åšçš„ Spring Cloud çš„å®æˆ˜é¡¹ç›®ï¼š
> 
> https://github.com/YunaiV/onemall

## [å®æˆ˜æ¼”ç»ƒ](https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect)

``ä¸€åˆ‡æ²¡æœ‰ä¾‹å­çš„è®²è§£éƒ½æ˜¯è€æµæ°“`Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â >>>Â Â Â Â Â Â `è‘±å§œåˆ‡æ²«~~åŠ å…¥ç”Ÿå‘½çš„æºæ³‰....      ``

---

**å®æˆ˜é¡¹ç›®ä»¥springbootä¸ºé¡¹ç›®è„šæ‰‹æ¶,githubåœ°å€**Â : github.com/leaJone/mybâ€¦

#### [1.MyFutureTaskå®ç°ç±»](https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect)

å†…éƒ¨å®šä¹‰ä¸€ä¸ªçº¿ç¨‹æ± è¿›è¡Œä»»åŠ¡çš„è°ƒåº¦å’Œçº¿ç¨‹çš„ç®¡ç†ä»¥åŠçº¿ç¨‹çš„å¤ç”¨,å¤§å®¶å¯ä»¥æ ¹æ®è‡ªå·±çš„å®é™…é¡¹ç›®æƒ…å†µè¿›è¡Œé…ç½®

å…¶ä¸­çº¿ç¨‹è°ƒåº¦ç¤ºä¾‹:æ ¸å¿ƒçº¿ç¨‹ 8 æœ€å¤§çº¿ç¨‹ 20 ä¿æ´»æ—¶é—´30s å­˜å‚¨é˜Ÿåˆ— 10 æœ‰å®ˆæŠ¤çº¿ç¨‹ æ‹’ç»ç­–ç•¥:å°†è¶…è´Ÿè·ä»»åŠ¡å›é€€åˆ°è°ƒç”¨è€… è¯´æ˜ :Â `é»˜è®¤ä½¿ç”¨æ ¸å¿ƒçº¿ç¨‹(8)æ•°æ‰§è¡Œä»»åŠ¡,ä»»åŠ¡æ•°é‡è¶…è¿‡æ ¸å¿ƒçº¿ç¨‹æ•°å°±ä¸¢åˆ°é˜Ÿåˆ—,é˜Ÿåˆ—(10)æ»¡äº†å°±å†å¼€å¯æ–°çš„çº¿ç¨‹,æ–°çš„çº¿ç¨‹æ•°æœ€å¤§ä¸º20,å½“ä»»åŠ¡æ‰§è¡Œå®Œ,æ–°å¼€å¯çš„çº¿ç¨‹å°†å­˜æ´»30s,è‹¥æ²¡æœ‰ä»»åŠ¡å°±æ¶ˆäº¡,çº¿ç¨‹æ± å›åˆ°æ ¸å¿ƒçº¿ç¨‹æ•°é‡.`

`importÂ com.boot.lea.mybot.dto.UserBehaviorDataDTO;   importÂ com.boot.lea.mybot.service.UserService;   importÂ com.google.common.util.concurrent.ThreadFactoryBuilder;   importÂ lombok.extern.slf4j.Slf4j;   importÂ org.springframework.stereotype.Component;      importÂ javax.annotation.Resource;   importÂ java.util.concurrent.*;         /**   Â *Â @authorÂ Lijing   Â *Â @dateÂ 2019å¹´7æœˆ29æ—¥   Â */   @Slf4j   @Component   publicÂ classÂ MyFutureTaskÂ {         Â Â Â Â @Resource   Â Â Â Â UserServiceÂ userService;      Â Â Â Â /**   Â Â Â Â Â *Â æ ¸å¿ƒçº¿ç¨‹Â 8Â æœ€å¤§çº¿ç¨‹Â 20Â ä¿æ´»æ—¶é—´30sÂ å­˜å‚¨é˜Ÿåˆ—Â 10Â æœ‰å®ˆæŠ¤çº¿ç¨‹Â æ‹’ç»ç­–ç•¥:å°†è¶…è´Ÿè·ä»»åŠ¡å›é€€åˆ°è°ƒç”¨è€…   Â Â Â Â Â */   Â Â Â Â privateÂ staticÂ ExecutorServiceÂ executorÂ =Â newÂ ThreadPoolExecutor(8,Â 20,   Â Â Â Â Â Â Â Â Â Â Â Â 30L,Â TimeUnit.SECONDS,Â newÂ LinkedBlockingQueue<Runnable>(10),   Â Â Â Â Â Â Â Â Â Â Â Â newÂ ThreadFactoryBuilder().setNameFormat("User_Async_FutureTask-%d").setDaemon(true).build(),   Â Â Â Â Â Â Â Â Â Â Â Â newÂ ThreadPoolExecutor.CallerRunsPolicy());         Â Â Â Â @SuppressWarnings("all")   Â Â Â Â publicÂ UserBehaviorDataDTOÂ getUserAggregatedResult(finalÂ LongÂ userId)Â {      Â Â Â Â Â Â Â Â System.out.println("MyFutureTaskçš„çº¿ç¨‹:"Â +Â Thread.currentThread());         Â Â Â Â Â Â Â Â longÂ fansCountÂ =Â 0,Â msgCountÂ =Â 0,Â collectCountÂ =Â 0,   Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â followCountÂ =Â 0,Â redBagCountÂ =Â 0,Â couponCountÂ =Â 0;      //Â Â Â Â Â Â Â Â fansCountÂ =Â userService.countFansCountByUserId(userId);   //Â Â Â Â Â Â Â Â msgCountÂ =Â userService.countMsgCountByUserId(userId);   //Â Â Â Â Â Â Â Â collectCountÂ =Â userService.countCollectCountByUserId(userId);   //Â Â Â Â Â Â Â Â followCountÂ =Â userService.countFollowCountByUserId(userId);   //Â Â Â Â Â Â Â Â redBagCountÂ =Â userService.countRedBagCountByUserId(userId);   //Â Â Â Â Â Â Â Â couponCountÂ =Â userService.countCouponCountByUserId(userId);      Â Â Â Â Â Â Â Â tryÂ {      Â Â Â Â Â Â Â Â Â Â Â Â Future<Long>Â fansCountFTÂ =Â executor.submit(()Â ->Â userService.countFansCountByUserId(userId));   Â Â Â Â Â Â Â Â Â Â Â Â Future<Long>Â msgCountFTÂ =Â executor.submit(()Â ->Â userService.countMsgCountByUserId(userId));   Â Â Â Â Â Â Â Â Â Â Â Â Future<Long>Â collectCountFTÂ =Â executor.submit(()Â ->Â userService.countCollectCountByUserId(userId));   Â Â Â Â Â Â Â Â Â Â Â Â Future<Long>Â followCountFTÂ =Â executor.submit(()Â ->Â userService.countFollowCountByUserId(userId));   Â Â Â Â Â Â Â Â Â Â Â Â Future<Long>Â redBagCountFTÂ =Â executor.submit(()Â ->Â userService.countRedBagCountByUserId(userId));   Â Â Â Â Â Â Â Â Â Â Â Â Future<Long>Â couponCountFTÂ =Â executor.submit(()Â ->Â userService.countCouponCountByUserId(userId));      Â Â Â Â Â Â Â Â Â Â Â Â //geté˜»å¡   Â Â Â Â Â Â Â Â Â Â Â Â fansCountÂ =Â fansCountFT.get();   Â Â Â Â Â Â Â Â Â Â Â Â msgCountÂ =Â msgCountFT.get();   Â Â Â Â Â Â Â Â Â Â Â Â collectCountÂ =Â collectCountFT.get();   Â Â Â Â Â Â Â Â Â Â Â Â followCountÂ =Â followCountFT.get();   Â Â Â Â Â Â Â Â Â Â Â Â redBagCountÂ =Â redBagCountFT.get();   Â Â Â Â Â Â Â Â Â Â Â Â couponCountÂ =Â couponCountFT.get();      Â Â Â Â Â Â Â Â }Â catchÂ (InterruptedExceptionÂ |Â ExecutionExceptionÂ e)Â {   Â Â Â Â Â Â Â Â Â Â Â Â e.printStackTrace();   Â Â Â Â Â Â Â Â Â Â Â Â log.error(">>>>>>èšåˆæŸ¥è¯¢ç”¨æˆ·èšåˆä¿¡æ¯å¼‚å¸¸:"Â +Â eÂ +Â "<<<<<<<<<");   Â Â Â Â Â Â Â Â }   Â Â Â Â Â Â Â Â UserBehaviorDataDTOÂ userBehaviorDataÂ =   Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â UserBehaviorDataDTO.builder().fansCount(fansCount).msgCount(msgCount)   Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .collectCount(collectCount).followCount(followCount)   Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .redBagCount(redBagCount).couponCount(couponCount).build();   Â Â Â Â Â Â Â Â returnÂ userBehaviorData;   Â Â Â Â }         }         `

#### [2.serviceä¸šåŠ¡æ–¹æ³•](https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect)

å¸¸è§„ä¸šåŠ¡æŸ¥è¯¢æ–¹æ³•,ä¸ºäº†ç‰¹æ•ˆ,ä»¥åŠçœ‹å‡ºå®é™…çš„æ•ˆæœ,æˆ‘ä»¬æ¯ä¸ªæ–¹æ³•åšäº†å»¶æ—¶

`importÂ com.boot.lea.mybot.mapper.UserMapper;   importÂ org.springframework.beans.factory.annotation.Autowired;   importÂ org.springframework.stereotype.Service;      importÂ java.util.concurrent.TimeUnit;      @Service   publicÂ classÂ UserServiceImplÂ implementsÂ UserServiceÂ {      Â Â Â Â @Autowired   Â Â Â Â UserMapperÂ userMapper;      Â Â Â Â @Override   Â Â Â Â publicÂ longÂ countFansCountByUserId(LongÂ userId)Â {   Â Â Â Â Â Â Â Â tryÂ {   Â Â Â Â Â Â Â Â Â Â Â Â Thread.sleep(10000);   Â Â Â Â Â Â Â Â Â Â Â Â System.out.println("è·å–FansCount===ç¡çœ :"Â +Â 10Â +Â "s");   Â Â Â Â Â Â Â Â }Â catchÂ (InterruptedExceptionÂ e)Â {   Â Â Â Â Â Â Â Â Â Â Â Â e.printStackTrace();   Â Â Â Â Â Â Â Â }   Â Â Â Â Â Â Â Â System.out.println("UserServiceè·å–FansCountçš„çº¿ç¨‹Â Â "Â +Â Thread.currentThread().getName());   Â Â Â Â Â Â Â Â returnÂ 520;   Â Â Â Â }      Â Â Â Â @Override   Â Â Â Â publicÂ longÂ countMsgCountByUserId(LongÂ userId)Â {   Â Â Â Â Â Â Â Â System.out.println("UserServiceè·å–MsgCountçš„çº¿ç¨‹Â Â "Â +Â Thread.currentThread().getName());   Â Â Â Â Â Â Â Â tryÂ {   Â Â Â Â Â Â Â Â Â Â Â Â Thread.sleep(10000);   Â Â Â Â Â Â Â Â Â Â Â Â System.out.println("è·å–MsgCount===ç¡çœ :"Â +Â 10Â +Â "s");   Â Â Â Â Â Â Â Â }Â catchÂ (InterruptedExceptionÂ e)Â {   Â Â Â Â Â Â Â Â Â Â Â Â e.printStackTrace();   Â Â Â Â Â Â Â Â }   Â Â Â Â Â Â Â Â returnÂ 618;   Â Â Â Â }      Â Â Â Â @Override   Â Â Â Â publicÂ longÂ countCollectCountByUserId(LongÂ userId)Â {   Â Â Â Â Â Â Â Â System.out.println("UserServiceè·å–CollectCountçš„çº¿ç¨‹Â Â "Â +Â Thread.currentThread().getName());   Â Â Â Â Â Â Â Â tryÂ {   Â Â Â Â Â Â Â Â Â Â Â Â Thread.sleep(10000);   Â Â Â Â Â Â Â Â Â Â Â Â System.out.println("è·å–CollectCount==ç¡çœ :"Â +Â 10Â +Â "s");   Â Â Â Â Â Â Â Â }Â catchÂ (InterruptedExceptionÂ e)Â {   Â Â Â Â Â Â Â Â Â Â Â Â e.printStackTrace();   Â Â Â Â Â Â Â Â }   Â Â Â Â Â Â Â Â returnÂ 6664;   Â Â Â Â }      Â Â Â Â @Override   Â Â Â Â publicÂ longÂ countFollowCountByUserId(LongÂ userId)Â {   Â Â Â Â Â Â Â Â System.out.println("UserServiceè·å–FollowCountçš„çº¿ç¨‹Â Â "Â +Â Thread.currentThread().getName());   Â Â Â Â Â Â Â Â tryÂ {   Â Â Â Â Â Â Â Â Â Â Â Â Thread.sleep(10000);   Â Â Â Â Â Â Â Â Â Â Â Â System.out.println("è·å–FollowCount===ç¡çœ :"Â +Â 10+Â "s");   Â Â Â Â Â Â Â Â }Â catchÂ (InterruptedExceptionÂ e)Â {   Â Â Â Â Â Â Â Â Â Â Â Â e.printStackTrace();   Â Â Â Â Â Â Â Â }   Â Â Â Â Â Â Â Â returnÂ userMapper.countFollowCountByUserId(userId);   Â Â Â Â }      Â Â Â Â @Override   Â Â Â Â publicÂ longÂ countRedBagCountByUserId(LongÂ userId)Â {   Â Â Â Â Â Â Â Â System.out.println("UserServiceè·å–RedBagCountçš„çº¿ç¨‹Â Â "Â +Â Thread.currentThread().getName());   Â Â Â Â Â Â Â Â tryÂ {   Â Â Â Â Â Â Â Â Â Â Â Â TimeUnit.SECONDS.sleep(4);   Â Â Â Â Â Â Â Â Â Â Â Â System.out.println("è·å–RedBagCount===ç¡çœ :"Â +Â 4Â +Â "s");   Â Â Â Â Â Â Â Â }Â catchÂ (InterruptedExceptionÂ e)Â {   Â Â Â Â Â Â Â Â Â Â Â Â e.printStackTrace();   Â Â Â Â Â Â Â Â }   Â Â Â Â Â Â Â Â returnÂ 99;   Â Â Â Â }      Â Â Â Â @Override   Â Â Â Â publicÂ longÂ countCouponCountByUserId(LongÂ userId)Â {   Â Â Â Â Â Â Â Â System.out.println("UserServiceè·å–CouponCountçš„çº¿ç¨‹Â Â "Â +Â Thread.currentThread().getName());   Â Â Â Â Â Â Â Â tryÂ {   Â Â Â Â Â Â Â Â Â Â Â Â TimeUnit.SECONDS.sleep(8);   Â Â Â Â Â Â Â Â Â Â Â Â System.out.println("è·å–CouponCount===ç¡çœ :"Â +Â 8+Â "s");   Â Â Â Â Â Â Â Â }Â catchÂ (InterruptedExceptionÂ e)Â {   Â Â Â Â Â Â Â Â Â Â Â Â e.printStackTrace();   Â Â Â Â Â Â Â Â }   Â Â Â Â Â Â Â Â returnÂ 66;   Â Â Â Â }   }            `

#### [3.controllerè°ƒç”¨](https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect)

`/**   Â *Â @authorÂ LiJing   Â *Â @ClassName:Â UserController   Â *Â @Description:Â ç”¨æˆ·æ§åˆ¶å™¨   Â *Â @dateÂ 2019/7/29Â 15:16   Â */   @RestController   @RequestMapping("user/")   publicÂ classÂ UserControllerÂ {         Â Â Â Â @Autowired   Â Â Â Â privateÂ UserServiceÂ userService;         Â Â Â Â @Autowired   Â Â Â Â privateÂ MyFutureTaskÂ myFutureTask;         Â Â Â Â @GetMapping("/index")   Â Â Â Â @ResponseBody   Â Â Â Â publicÂ StringÂ index()Â {   Â Â Â Â Â Â Â Â returnÂ "å¯åŠ¨ç”¨æˆ·æ¨¡å—æˆåŠŸ~~~~~~~~";   Â Â Â Â }      Â Â Â Â //http://localhost:8080/api/user/get/data?userId=4      Â Â Â Â @GetMapping("/get/data")   Â Â Â Â @ResponseBody   Â Â Â Â publicÂ UserBehaviorDataDTOÂ getUserData(LongÂ userId)Â {   Â Â Â Â Â Â Â Â System.out.println("UserControllerçš„çº¿ç¨‹:"Â +Â Thread.currentThread());   Â Â Â Â Â Â Â Â longÂ beginÂ =Â System.currentTimeMillis();   Â Â Â Â Â Â Â Â UserBehaviorDataDTOÂ userAggregatedResultÂ =Â myFutureTask.getUserAggregatedResult(userId);   Â Â Â Â Â Â Â Â longÂ endÂ =Â System.currentTimeMillis();   Â Â Â Â Â Â Â Â System.out.println("===============æ€»è€—æ—¶:"Â +Â (endÂ -Â begin)Â /1000.0000+Â "ç§’");   Â Â Â Â Â Â Â Â returnÂ userAggregatedResult;   Â Â Â Â }         }         `

æˆ‘ä»¬å¯åŠ¨é¡¹ç›®:å¼€å¯è°ƒç”¨ http://localhost:8080/api/user/get/data?userId=4

å½“æˆ‘ä»¬çº¿ç¨‹æ± é…ç½®ä¸º:æ ¸å¿ƒçº¿ç¨‹ 8 æœ€å¤§çº¿ç¨‹ 20 ä¿æ´»æ—¶é—´30s å­˜å‚¨é˜Ÿåˆ— 10 çš„æ—¶å€™,æˆ‘ä»¬æµ‹è¯•çš„ç»“æœå¦‚ä¸‹:

[![å›¾ç‰‡](data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='1px' height='1px' viewBox='0 0 1 1' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg stroke='none' stroke-width='1' fill='none' fill-rule='evenodd' fill-opacity='0'%3E%3Cg transform='translate(-249.000000, -126.000000)' fill='%23FFFFFF'%3E%3Crect x='249' y='126' width='1' height='1'%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E)](https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect)

[![å›¾ç‰‡](data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='1px' height='1px' viewBox='0 0 1 1' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg stroke='none' stroke-width='1' fill='none' fill-rule='evenodd' fill-opacity='0'%3E%3Cg transform='translate(-249.000000, -126.000000)' fill='%23FFFFFF'%3E%3Crect x='249' y='126' width='1' height='1'%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E)](https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect)

> **ç»“æœ**Â :æˆ‘ä»¬çœ‹åˆ°æ¯ä¸ªserver methodçš„æ‰§è¡Œçº¿ç¨‹éƒ½æ˜¯ä»çº¿ç¨‹æ± ä¸­å‘èµ·çš„çº¿ç¨‹å:`User_Async_FutureTask-%d`, æ€»è€—æ—¶ä»ç´¯è®¡çš„52ç§’ç¼©çŸ­åˆ°10ç§’,å³å–å†³äºæœ€è€—æ—¶çš„æ–¹æ³•æŸ¥è¯¢æ—¶é—´.

é‚£æˆ‘ä»¬å†å°†æ³¨é‡Šä»£ç æ”¾å¼€,è¿›è¡Œä¸²è¡ŒæŸ¥è¯¢è¿›è¡Œæµ‹è¯•:

[![å›¾ç‰‡](data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='1px' height='1px' viewBox='0 0 1 1' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg stroke='none' stroke-width='1' fill='none' fill-rule='evenodd' fill-opacity='0'%3E%3Cg transform='translate(-249.000000, -126.000000)' fill='%23FFFFFF'%3E%3Crect x='249' y='126' width='1' height='1'%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E)](https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect)

[![å›¾ç‰‡](data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='1px' height='1px' viewBox='0 0 1 1' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg stroke='none' stroke-width='1' fill='none' fill-rule='evenodd' fill-opacity='0'%3E%3Cg transform='translate(-249.000000, -126.000000)' fill='%23FFFFFF'%3E%3Crect x='249' y='126' width='1' height='1'%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E)](https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect)

[![å›¾ç‰‡](data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='1px' height='1px' viewBox='0 0 1 1' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg stroke='none' stroke-width='1' fill='none' fill-rule='evenodd' fill-opacity='0'%3E%3Cg transform='translate(-249.000000, -126.000000)' fill='%23FFFFFF'%3E%3Crect x='249' y='126' width='1' height='1'%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E)](https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect)

> **ç»“æœ**Â :æˆ‘ä»¬ä½¿ç”¨ä¸²è¡Œçš„æ–¹å¼è¿›è¡ŒæŸ¥è¯¢,ç»“æœæ±‡æ€»å°†è¾¾åˆ°52ç§’,é‚£å¤ªå¯æ€•äº†~~

## [æ€»ç»“](https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect)

ä½¿ç”¨FutureTaskçš„æ—¶å€™,å°±æ˜¯å°†ä»»åŠ¡runnerä»¥callerçš„æ–¹å¼è¿›è¡Œå›è°ƒ,é˜»å¡è·å–,æœ€åæˆ‘ä»¬å°†ç»“æœæ±‡æ€»,å³å®Œæˆäº†å¼€å¯å¤šçº¿ç¨‹å¼‚æ­¥è°ƒç”¨æˆ‘ä»¬çš„ä¸šåŠ¡æ–¹æ³•.

Â Â Â Â Â Â Â Â Â Â Â Â `Future<Long>Â fansCountFTÂ =Â executor.submit(newÂ Callable<Long>()Â {   Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â @Override   Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â publicÂ LongÂ call()Â throwsÂ ExceptionÂ {   Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â returnÂ userService.countFansCountByUserId(userId);   Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }   Â Â Â Â Â Â Â Â Â Â Â Â });`

è¿™é‡Œä½¿ç”¨çš„åªæ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­,å…·ä½“é¡¹ç›®å¯ä»¥å®šä¹‰å…·ä½“çš„ä¸šåŠ¡æ–¹æ³•è¿›è¡Œå½’å¹¶å¤„ç†,å…¶å®åœ¨JDK1.8ä»¥å,åˆæœ‰äº†`ExecutorCompletionService`,`ForkJoinTask`,`CompletableFuture`è¿™äº›éƒ½å¯ä»¥å®ç°ä¸Šè¿°çš„æ–¹æ³•,æˆ‘ä»¬åç»­ä¼šåšä¸€äº›è¿™äº›æ–¹æ³•ä½¿ç”¨çš„æ¡ˆä¾‹,æœŸæœ›å¤§å®¶çš„å…³æ³¨,æ–‡ç« ä¸­æœ‰ä¸è¶³ä¹‹å¤„,æ¬¢è¿æŒ‡æ­£~

## [å°ç”œç‚¹](https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect)

![å›¾ç‰‡](data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='1px' height='1px' viewBox='0 0 1 1' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg stroke='none' stroke-width='1' fill='none' fill-rule='evenodd' fill-opacity='0'%3E%3Cg transform='translate(-249.000000, -126.000000)' fill='%23FFFFFF'%3E%3Crect x='249' y='126' width='1' height='1'%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E)

æ‰€ä»¥:æˆ‘ä»¬è¦ç”¨åˆ°äº²çˆ±çš„Springçš„å¼‚æ­¥ç¼–ç¨‹,å¼‚æ­¥ç¼–ç¨‹æœ‰å¾ˆå¤šç§æ–¹å¼:æ¯”å¦‚å¸¸è§çš„`Futureçš„sync`,`CompletableFuture.supplyAsync,`,`@Async`,å“ˆå“ˆ å…¶å®éƒ½ç¦»ä¸å¼€Thread.start()...,ç­‰ç­‰æˆ‘è¯´ä¸ªç¬‘è¯:

> è€çˆ¸æœ‰ä¿©å­©å­ï¼šå°çº¢å’Œå°æ˜ã€‚è€çˆ¸æƒ³å–é…’äº†ï¼Œä»–è®©å°çº¢å»ä¹°é…’ï¼Œå°çº¢å‡ºå»äº†ã€‚ç„¶åè€çˆ¸çªç„¶æƒ³å¸çƒŸäº†ï¼Œäºæ˜¯è€çˆ¸è®©å°æ˜å»ä¹°çƒŸã€‚åœ¨é¢å¯¹å¯¹è±¡çš„æ€æƒ³ä¸­ï¼Œä¸€èˆ¬ä¼šæŠŠä¹°ä¸œè¥¿ï¼Œç„¶åä¹°å›æ¥è¿™ä»¶äº‹ä½œä¸ºä¸€ä¸ªæ–¹æ³•ï¼Œå¦‚æœæŒ‰ç…§é¡ºåºç»“æ„æˆ–è€…ä½¿ç”¨å¤šçº¿ç¨‹åŒæ­¥çš„è¯ï¼Œå°æ˜æƒ³å»ä¹°çƒŸå°±å¿…é¡»ç­‰å°çº¢è¿™ä¸ªä¹°ä¸œè¥¿çš„æ“ä½œè¿›è¡Œå®Œã€‚è¿™æ ·æ— ç–‘å¢åŠ äº†æ—¶é—´çš„å¼€é”€(ä¸‡ä¸€è€çˆ¸å°¿æ†‹å‘¢?)ã€‚å¼‚æ­¥å°±æ˜¯ä¸ºäº†è§£å†³è¿™æ ·çš„é—®é¢˜ã€‚ä½ å¯ä»¥åˆ†åˆ«ç»™å°çº¢å°æ˜ä¸‹è¾¾æŒ‡ä»¤ï¼Œè®©ä»–ä»¬å»ä¹°ä¸œè¥¿ï¼Œç„¶åä½ å°±å¯ä»¥è‡ªå·±åšè‡ªå·±çš„äº‹ï¼Œç­‰ä»–ä»¬ä¹°å›æ¥çš„æ—¶å€™æ¥æ”¶ç»“æœå°±å¯ä»¥äº†ã€‚

`packageÂ com.boot.lea.mybot.futrue;      /**   Â *Â @ClassName:Â TestFuture   Â *Â @Description:Â æ¼”ç¤ºå¼‚æ­¥ç¼–ç¨‹   Â *Â @authorÂ LiJing   Â *Â @dateÂ 2019/8/5Â 15:16   Â */   @SuppressWarnings("all")   publicÂ classÂ TestFutureÂ {   Â Â Â Â staticÂ ExecutorServiceÂ executorÂ =Â Executors.newFixedThreadPool(2);      Â Â Â Â publicÂ staticÂ voidÂ main(String[]Â args)Â throwsÂ InterruptedExceptionÂ {   Â Â Â Â Â Â Â Â //ä¸¤ä¸ªçº¿ç¨‹çš„çº¿ç¨‹æ±    Â Â Â Â Â Â Â Â //å°çº¢ä¹°é…’ä»»åŠ¡ï¼Œè¿™é‡Œçš„future2ä»£è¡¨çš„æ˜¯å°çº¢æœªæ¥å‘ç”Ÿçš„æ“ä½œï¼Œè¿”å›å°çº¢ä¹°ä¸œè¥¿è¿™ä¸ªæ“ä½œçš„ç»“æœ   Â Â Â Â Â Â Â Â CompletableFuture<String>Â future2Â =Â CompletableFuture.supplyAsync(()Â ->Â {   Â Â Â Â Â Â Â Â Â Â Â Â System.out.println("çˆ¸ï¼šå°çº¢ä½ å»ä¹°ç“¶é…’ï¼");   Â Â Â Â Â Â Â Â Â Â Â Â tryÂ {   Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â System.out.println("å°çº¢å‡ºå»ä¹°é…’äº†ï¼Œå¥³å­©å­è·‘çš„æ¯”è¾ƒæ…¢ï¼Œä¼°è®¡5såæ‰ä¼šå›æ¥...");   Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Thread.sleep(5000);   Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â returnÂ "æˆ‘ä¹°å›æ¥äº†ï¼";   Â Â Â Â Â Â Â Â Â Â Â Â }Â catchÂ (InterruptedExceptionÂ e)Â {   Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â System.err.println("å°çº¢è·¯ä¸Šé­é‡äº†ä¸æµ‹");   Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â returnÂ "æ¥ä¸–å†è§ï¼";   Â Â Â Â Â Â Â Â Â Â Â Â }   Â Â Â Â Â Â Â Â },Â executor);      Â Â Â Â Â Â Â Â //å°æ˜ä¹°çƒŸä»»åŠ¡ï¼Œè¿™é‡Œçš„future1ä»£è¡¨çš„æ˜¯å°æ˜æœªæ¥ä¹°ä¸œè¥¿ä¼šå‘ç”Ÿçš„äº‹ï¼Œè¿”å›å€¼æ˜¯å°æ˜ä¹°ä¸œè¥¿çš„ç»“æœ   Â Â Â Â Â Â Â Â CompletableFuture<String>Â future1Â =Â CompletableFuture.supplyAsync(()Â ->Â {   Â Â Â Â Â Â Â Â Â Â Â Â System.out.println("çˆ¸ï¼šå°æ˜ä½ å»ä¹°åŒ…çƒŸï¼");   Â Â Â Â Â Â Â Â Â Â Â Â tryÂ {   Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â System.out.println("å°æ˜å‡ºå»ä¹°çƒŸäº†ï¼Œå¯èƒ½è¦3såå›æ¥...");   Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Thread.sleep(3000);      Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â throwÂ newÂ InterruptedException();   //Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â returnÂ "æˆ‘ä¹°å›æ¥äº†!";   Â Â Â Â Â Â Â Â Â Â Â Â }Â catchÂ (InterruptedExceptionÂ e)Â {   Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â System.out.println("å°æ˜è·¯ä¸Šé­é‡äº†ä¸æµ‹ï¼");   Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â returnÂ "è¿™æ˜¯æˆ‘æ‰˜äººå¸¦æ¥çš„å£ä¿¡ï¼Œæˆ‘å·²ç»ä¸åœ¨äº†ã€‚";   Â Â Â Â Â Â Â Â Â Â Â Â }   Â Â Â Â Â Â Â Â },Â executor);      Â Â Â Â Â Â Â Â //è·å–å°çº¢ä¹°é…’ç»“æœï¼Œä»å°çº¢çš„æ“ä½œä¸­è·å–ç»“æœï¼ŒæŠŠç»“æœæ‰“å°   Â Â Â Â Â Â Â Â future2.thenAccept((e)Â ->Â {   Â Â Â Â Â Â Â Â Â Â Â Â System.out.println("å°çº¢è¯´ï¼š"Â +Â e);   Â Â Â Â Â Â Â Â });   Â Â Â Â Â Â Â Â //è·å–å°æ˜ä¹°çƒŸçš„ç»“æœ   Â Â Â Â Â Â Â Â future1.thenAccept((e)Â ->Â {   Â Â Â Â Â Â Â Â Â Â Â Â System.out.println("å°æ˜è¯´ï¼š"Â +Â e);   Â Â Â Â Â Â Â Â });      Â Â Â Â Â Â Â Â System.out.println("çˆ¸ï¼šç­‰å•Šç­‰Â è¥¿æ¹–ç¾æ™¯ä¸‰æœˆå¤©å˜......");   Â Â Â Â Â Â Â Â System.out.println("çˆ¸:Â æˆ‘è§‰å¾—æ— èŠç”šè‡³å»äº†è¶Ÿå•æ‰€ã€‚");   Â Â Â Â Â Â Â Â Thread.currentThread().join(9Â *Â 1000);   Â Â Â Â Â Â Â Â System.out.println("çˆ¸ï¼šç»ˆäºç»™è€å­ä¹°æ¥äº†......huo é…’");   Â Â Â Â Â Â Â Â //å…³é—­çº¿ç¨‹æ±    Â Â Â Â Â Â Â Â executor.shutdown();   Â Â Â Â }   }      `

è¿è¡Œç»“æœ:

[![å›¾ç‰‡](data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='1px' height='1px' viewBox='0 0 1 1' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg stroke='none' stroke-width='1' fill='none' fill-rule='evenodd' fill-opacity='0'%3E%3Cg transform='translate(-249.000000, -126.000000)' fill='%23FFFFFF'%3E%3Crect x='249' y='126' width='1' height='1'%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E)](https://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&scene=21#wechat_redirect)

  

---

---

æ¬¢è¿åŠ å…¥æˆ‘çš„çŸ¥è¯†æ˜Ÿçƒï¼Œä¸€èµ·æ¢è®¨æ¶æ„ï¼Œäº¤æµæºç ã€‚åŠ å…¥æ–¹å¼ï¼Œ**é•¿æŒ‰ä¸‹æ–¹äºŒç»´ç å™¢**ï¼š  

![å›¾ç‰‡](data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='1px' height='1px' viewBox='0 0 1 1' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg stroke='none' stroke-width='1' fill='none' fill-rule='evenodd' fill-opacity='0'%3E%3Cg transform='translate(-249.000000, -126.000000)' fill='%23FFFFFF'%3E%3Crect x='249' y='126' width='1' height='1'%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E)

å·²åœ¨çŸ¥è¯†æ˜Ÿçƒæ›´æ–°æºç è§£æå¦‚ä¸‹ï¼š  

[![å›¾ç‰‡](data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='1px' height='1px' viewBox='0 0 1 1' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg stroke='none' stroke-width='1' fill='none' fill-rule='evenodd' fill-opacity='0'%3E%3Cg transform='translate(-249.000000, -126.000000)' fill='%23FFFFFF'%3E%3Crect x='249' y='126' width='1' height='1'%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E)](http://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21#wechat_redirect)

[![å›¾ç‰‡](data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='1px' height='1px' viewBox='0 0 1 1' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg stroke='none' stroke-width='1' fill='none' fill-rule='evenodd' fill-opacity='0'%3E%3Cg transform='translate(-249.000000, -126.000000)' fill='%23FFFFFF'%3E%3Crect x='249' y='126' width='1' height='1'%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E)](http://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21#wechat_redirect)

[![å›¾ç‰‡](data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='1px' height='1px' viewBox='0 0 1 1' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg stroke='none' stroke-width='1' fill='none' fill-rule='evenodd' fill-opacity='0'%3E%3Cg transform='translate(-249.000000, -126.000000)' fill='%23FFFFFF'%3E%3Crect x='249' y='126' width='1' height='1'%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E)](http://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21#wechat_redirect)

[![å›¾ç‰‡](data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='1px' height='1px' viewBox='0 0 1 1' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg stroke='none' stroke-width='1' fill='none' fill-rule='evenodd' fill-opacity='0'%3E%3Cg transform='translate(-249.000000, -126.000000)' fill='%23FFFFFF'%3E%3Crect x='249' y='126' width='1' height='1'%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E)](http://mp.weixin.qq.com/s?__biz=MzUzMTA2NTU2Ng==&mid=2247487551&idx=1&sn=18f64ba49f3f0f9d8be9d1fdef8857d9&chksm=fa496f8ecd3ee698f4954c00efb80fe955ec9198fff3ef4011e331aa37f55a6a17bc8c0335a8&scene=21#wechat_redirect)

æœ€è¿‘æ›´æ–°ã€ŠèŠ‹é“ SpringBoot 2.X å…¥é—¨ã€‹ç³»åˆ—ï¼Œå·²ç» 101 ä½™ç¯‡ï¼Œè¦†ç›–äº†Â MyBatisã€Redisã€MongoDBã€ESã€åˆ†åº“åˆ†è¡¨ã€è¯»å†™åˆ†ç¦»ã€SpringMVCã€Webfluxã€æƒé™ã€WebSocketã€Dubboã€RabbitMQã€RocketMQã€Kafkaã€æ€§èƒ½æµ‹è¯•ç­‰ç­‰å†…å®¹ã€‚  

æä¾›è¿‘ 3W è¡Œä»£ç çš„ SpringBoot ç¤ºä¾‹ï¼Œä»¥åŠè¶… 4W è¡Œä»£ç çš„ç”µå•†å¾®æœåŠ¡é¡¹ç›®ã€‚

è·å–æ–¹å¼ï¼šç‚¹â€œ**åœ¨çœ‹**â€ï¼Œå…³æ³¨å…¬ä¼—å·å¹¶å›å¤Â **666**Â é¢†å–ï¼Œæ›´å¤šå†…å®¹é™†ç»­å¥‰ä¸Šã€‚

**æ–‡ç« æœ‰å¸®åŠ©çš„è¯ï¼Œåœ¨çœ‹ï¼Œè½¬å‘å§ã€‚**

**è°¢è°¢æ”¯æŒå“Ÿ (*^__^*ï¼‰**

èŠ‹é“æºç 1000

èŠ‹é“æºç  Â· ç›®å½•

ä¸Šä¸€ç¯‡Kafka 3.0é‡ç£…å‘å¸ƒï¼Œéƒ½æ›´æ–°äº†äº›å•¥ï¼Ÿä¸‹ä¸€ç¯‡Hbase å’Œ MySQL çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿä¸€æ–‡æ·±åº¦å¯¹æ¯”ï¼

é˜…è¯»åŸæ–‡

é˜…è¯»Â 5355

â€‹

å†™ç•™è¨€

**ç•™è¨€ 3**

- æ¢èƒ¡æ–¯ä¹
    
    2021å¹´10æœˆ23æ—¥
    
    èµ
    
    å½“æ—¶çœ‹æºç å°±åœ¨å¥½å¥‡ï¼Œä¸ºä»€ä¹ˆæ²¡ç”¨ aqsï¼Œè€Œæ˜¯è‡ªå·±å®ç°
    
    èŠ‹é“æºç 
    
    ä½œè€…2021å¹´10æœˆ23æ—¥
    
    èµ
    
    å˜¿å˜¿
    
- èŠ‹è‰¿ï¼ˆä¸€ç§é£Ÿæï¼‰
    
    2021å¹´10æœˆ20æ—¥
    
    èµ
    
    èƒ–å‹ä»¬è€è§„çŸ©ï¼Œä¸ç®¡ç°åœ¨ç”¨ä¸ç”¨åˆ°ã€Œåœ¨çœ‹ã€å…ˆå®‰æ’èµ·æ¥å“Ÿï¼Œè‰¿è‰¿ï¼Œå…ˆæ„Ÿè°¢å¤§å®¶å•¦
    

å·²æ— æ›´å¤šæ•°æ®

[](javacript:;)

![](http://mmbiz.qpic.cn/mmbiz_png/JdLkEI9sZfcTJicC5sSiaD2Y4XgGFI1cFr8JBcIWEoS8ygoNIUlSaD8DS6CsgiaB0RpejXp5Biavia2vicHdIIqaLbTg/300?wx_fmt=png&wxfrom=18)

èŠ‹é“æºç 

21åˆ†äº«25

3

å†™ç•™è¨€

**ç•™è¨€ 3**

- æ¢èƒ¡æ–¯ä¹
    
    2021å¹´10æœˆ23æ—¥
    
    èµ
    
    å½“æ—¶çœ‹æºç å°±åœ¨å¥½å¥‡ï¼Œä¸ºä»€ä¹ˆæ²¡ç”¨ aqsï¼Œè€Œæ˜¯è‡ªå·±å®ç°
    
    èŠ‹é“æºç 
    
    ä½œè€…2021å¹´10æœˆ23æ—¥
    
    èµ
    
    å˜¿å˜¿
    
- èŠ‹è‰¿ï¼ˆä¸€ç§é£Ÿæï¼‰
    
    2021å¹´10æœˆ20æ—¥
    
    èµ
    
    èƒ–å‹ä»¬è€è§„çŸ©ï¼Œä¸ç®¡ç°åœ¨ç”¨ä¸ç”¨åˆ°ã€Œåœ¨çœ‹ã€å…ˆå®‰æ’èµ·æ¥å“Ÿï¼Œè‰¿è‰¿ï¼Œå…ˆæ„Ÿè°¢å¤§å®¶å•¦
    

å·²æ— æ›´å¤šæ•°æ®