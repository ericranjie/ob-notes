# 

åŸåˆ›Â é½å…‰Â é˜¿é‡Œäº‘å¼€å‘è€…

Â _2021å¹´10æœˆ13æ—¥ 09:50_

![](https://mmbiz.qpic.cn/mmbiz_jpg/Z6bicxIx5naIG04G4gV8dAxufniaZqSzhT7oHD8HiacR5MNWgOfU5AYdAicrwxH32dJGyFfCG4d0Cw3JC3sdtR9VSw/640?wx_fmt=jpeg&wxfrom=13&tp=wxpic)

  

æµè®¡ç®—çš„åº”ç”¨ä¸å®è·µåœ¨å¤§æ•°æ®é¢†åŸŸè¶Šæ¥è¶Šå¸¸è§ï¼Œå…¶é‡è¦æ€§ä¸è¨€è€Œå–»ï¼Œå¸¸è§çš„æµè®¡ç®—å¼•æ“æœ‰ Google DataFlowã€Apache Flinkï¼ŒApache Kafka Streamsï¼ŒApache Spark Streaming ç­‰ã€‚æµè®¡ç®—ç³»ç»Ÿä¸­çš„æ•°æ®ä¸€è‡´æ€§ä¸€èˆ¬æ˜¯ç”¨æ¶ˆæ¯å¤„ç†è¯­ä¹‰æ¥å®šä¹‰çš„ï¼Œå¦‚æŸå¼•æ“å£°ç§°å¯ä»¥æä¾›ã€Œæ°å¥½ä¸€æ¬¡ï¼ˆExactly-once Processing Semanticsï¼‰æµå¤„ç†è¯­ä¹‰ï¼Œè¡¨ç¤ºï¼ˆæˆ–æš—ç¤ºï¼‰å¼•æ“å…·å¤‡ä¿è¯æ•°æ®ä¸€è‡´æ€§çš„èƒ½åŠ›ã€‚äº‹å®ä¸Šï¼Œã€Œæ°å¥½ä¸€æ¬¡ï¼ˆExactly-Onceï¼‰ã€å¹¶ä¸ç­‰ä»·äºæµè®¡ç®—çš„è¾“å‡ºæ•°æ®å°±ç¬¦åˆä¸€è‡´æ€§çš„è¦æ±‚ï¼Œè¯¥æœ¯è¯­å­˜åœ¨å¾ˆå¤šç†è§£å’Œä½¿ç”¨ä¸Šçš„è¯¯åŒºã€‚

  

æœ¬ç¯‡æ–‡ç« ä»æµè®¡ç®—çš„æœ¬è´¨å‡ºå‘ï¼Œé‡ç‚¹åˆ†ææµè®¡ç®—é¢†åŸŸä¸­æ•°æ®å¤„ç†çš„ä¸€è‡´æ€§é—®é¢˜ï¼ŒåŒæ—¶å¯¹ä¸€è‡´æ€§é—®é¢˜è¿›è¡Œç®€å•çš„å½¢å¼åŒ–å®šä¹‰ï¼Œæä¾›ä¸€ä¸ªä¸€çª¥å½“ä¸‹æµè®¡ç®—å¼•æ“å‘å±•è„‰ç»œçš„è§†è§’ï¼Œè®©å¤§å®¶å¯¹æµè®¡ç®—å¼•æ“çš„è®¤è¯†æ›´ä¸ºæ·±å…¥ï¼Œä¸ºå¯èƒ½çš„æµè®¡ç®—æŠ€æœ¯é€‰å‹æä¾›ä¸€äº›å‚è€ƒã€‚æ–‡ç« ä¸»è¦åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼šç¬¬ä¸€éƒ¨åˆ†ï¼Œä¼šä»‹ç»æµè®¡ç®—ç³»ç»Ÿå’Œä¸€è‡´æ€§éš¾é¢˜çš„æœ¬è´¨ï¼›ç¬¬äºŒéƒ¨åˆ†ï¼Œä¼šä»‹ç»ä¸€è‡´æ€§éš¾é¢˜çš„é€šç”¨è§£æ³•ä»¥åŠå„ç§æ–¹æ¡ˆé—´çš„å–èˆï¼›ç¬¬ä¸‰éƒ¨åˆ†ï¼Œä¼šä»‹ç»ä¸»æµçš„æµè®¡ç®—å¼•æ“æ˜¯å¦‚ä½•å¯¹é€šç”¨è§£æ³•è¿›è¡Œæ³›åŒ–ä»¥å®ç°ä¸€è‡´æ€§ã€‚

  

## **ä¸€Â  æµè®¡ç®—ä¸­çš„ä¸€è‡´æ€§**

åœ¨è®¤è¯†æµè®¡ç®—ç³»ç»Ÿä¸€è‡´æ€§ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦ç²¾ç¡®å®šä¹‰æµè®¡ç®—ã€‚æµï¼ˆStreamingï¼‰è®¡ç®—æ˜¯ä¸€ç§åœ¨æ— è¾¹ç•Œæ•°æ®ï¼ˆunbounded dataï¼‰ä¸Šè¿›è¡Œä½å»¶è¿Ÿè®¡ç®—çš„æ•°æ®å¤„ç†è¿‡ç¨‹ã€‚ç›¸åº”çš„ï¼Œæ‰¹è®¡ç®—æ›´å‡†ç¡®çš„è¯´æ³•æ˜¯æœ‰ç•Œæ•°æ®ï¼ˆbounded dataï¼‰çš„å¤„ç†ï¼Œäº¦å³æœ‰æ˜ç¡®è¾¹ç•Œçš„æ•°æ®å¤„ç†ï¼Œæµå’Œæ‰¹åªæ˜¯ä¸¤ç§ä¸åŒæ•°æ®é›†çš„ä¼ ç»Ÿæ•°æ®è®¡ç®—æ–¹æ³•ï¼Œå®ƒä»¬å¹¶ä¸æ˜¯æ³¾æ¸­åˆ†æ˜çš„ï¼Œè­¬å¦‚ä¹Ÿå¯ä»¥é€šè¿‡æ‰¹é‡çš„æ–¹å¼ï¼ˆe.g. Spark Streaming ä¸­çš„ micro-batchï¼‰æ¥å®ç°æ— ç•Œæ•°æ®ä¸Šçš„æµå¤„ç†è¿‡ç¨‹ã€‚

  

![å›¾ç‰‡](data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='1px' height='1px' viewBox='0 0 1 1' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg stroke='none' stroke-width='1' fill='none' fill-rule='evenodd' fill-opacity='0'%3E%3Cg transform='translate(-249.000000, -126.000000)' fill='%23FFFFFF'%3E%3Crect x='249' y='126' width='1' height='1'%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E)

  

### 1Â  ä¸€è‡´æ€§å®šä¹‰åŠæŒ‘æˆ˜

  

å¦‚æœæˆ‘ä»¬å°†æµè®¡ç®—çš„è¿‡ç¨‹ï¼ˆè·å–è¾“å…¥æ•°æ®ã€å¤„ç†æ•°æ®ã€è¾“å‡ºè®¡ç®—ç»“æœï¼‰è§†ä¸ºæ•°æ®åº“çš„ä¸»ä»åŒæ­¥è¿‡ç¨‹ï¼ŒæŠ‘æˆ–è§†ä¸ºä¸€ç§ä»æµæ•°æ®ç”Ÿæˆè¡ç”Ÿæ•°æ®é›†ï¼ˆè¡¨ï¼‰çš„è¿‡ç¨‹ï¼Œåˆ™æµè®¡ç®—ä¸­çš„æ•°æ®ä¸€è‡´æ€§åŒå…³ç³»å‹æ•°æ®åº“äº‹åŠ¡ ACID ç†è®ºä¸­çš„ Consistency æœ‰å¼‚æ›²åŒå·¥ä¹‹å¦™ï¼Œåè€…æŒ‡çš„æ˜¯åœ¨äº‹åŠ¡å¼€å§‹æˆ–ç»“æŸæ—¶ï¼Œæ•°æ®åº“ä¸­çš„è®°å½•åº”è¯¥åœ¨ä¸€è‡´çŠ¶æ€ï¼Œç›¸åº”åœ°ï¼Œæµè®¡ç®—ä¸­çš„ä¸€è‡´æ€§å¯ä»¥å®šä¹‰ä¸ºï¼šæµè®¡ç®—ç³»ç»Ÿåœ¨è®¡ç®—è¿‡ç¨‹ä¸­ï¼Œæˆ–æ˜¯å‡ºç°æ•…éšœæ¢å¤è®¡ç®—åï¼Œæµç³»ç»Ÿçš„å†…éƒ¨çŠ¶æ€å’Œå¤–éƒ¨è¾“å‡ºçš„æ•°æ®åº”è¯¥å¤„åœ¨ä¸€è‡´çš„çŠ¶æ€ã€‚è­¬å¦‚ï¼Œå½“æ•…éšœæ¢å¤åå¼€å§‹é‡æ–°è®¡ç®—ï¼Œè®¡ç®—çš„ç»“æœæ˜¯å¦æ»¡è¶³æ•°æ®çš„ä¸€è‡´æ€§ï¼ˆå³ç”¨æˆ·æ— æ³•åŒºåˆ†æ¢å¤å‰å’Œæ¢å¤åçš„æ•°æ®ï¼‰ï¼Ÿè®°å½•æ˜¯å¦ä¼šé‡å¤/ä¸¢å¤±ï¼Œç¬¬ä¸‰æ–¹ç³»ç»Ÿå¯¹åŒä¸€æ¡è®¡ç®—ç»“æœçš„å¤šæ¬¡è·å–ï¼Œæ˜¯å¦ä¼šå­˜åœ¨å€¼ä¸Šçš„ä¸ä¸€è‡´ï¼Ÿå¯¹ä¸€è‡´æ€§æœ‰äº†æ¸…æ™°çš„è®¤çŸ¥å’Œå®šä¹‰åï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ä¸ºä»€ä¹ˆå®ç°ä¸€è‡´æ€§è¿™ä¹ˆéš¾ã€‚

![å›¾ç‰‡](data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='1px' height='1px' viewBox='0 0 1 1' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg stroke='none' stroke-width='1' fill='none' fill-rule='evenodd' fill-opacity='0'%3E%3Cg transform='translate(-249.000000, -126.000000)' fill='%23FFFFFF'%3E%3Crect x='249' y='126' width='1' height='1'%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E)

  

åœ¨å®šä¹‰ä¸€ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæµè®¡ç®—è¾“å…¥çš„æ•°æ®æ˜¯æ— è¾¹ç•Œçš„ï¼Œæ‰€ä»¥ç³»ç»Ÿä¸­ä¼šå­˜åœ¨æ¶ˆæ¯æŠµè¾¾æµè®¡ç®—ç³»ç»Ÿå»¶è¿Ÿã€é¡ºåºé”™ä¹±ã€æ•°é‡/è§„æ¨¡æœªçŸ¥ç­‰ä¸ç¡®å®šå› ç´ ï¼Œè¿™ä¹Ÿæ˜¯æµè®¡ç®—ç³»ç»Ÿä¸€è‡´æ€§å¤æ‚æ€§è¿œè¿œå¤§äºæ‰¹å¤„ç†ç³»ç»Ÿçš„åŸå› ï¼šæ‰¹å¤„ç†ç³»ç»Ÿä¸­çš„è¾“å…¥æ˜¯ç¡®å®šçš„ï¼Œè®¡ç®—è¿‡ç¨‹ä¸­å¯ä»¥é€šè¿‡è®¡ç®—çš„åŸå­æ€§æ¥ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ï¼ˆå¦‚ Spark ä¸­çš„ RDD è¡€ç¼˜ï¼‰ã€‚æ­¤å¤–ï¼ŒåŒå…¶ä»–åˆ†å¸ƒå¼åº”ç”¨ä¸€æ ·ï¼Œæµè®¡ç®—ç³»ç»Ÿç»å¸¸ä¹Ÿä¼šå—åˆ°å„ç±»æ„å¤–å› ç´ çš„å½±å“è€Œå‘ç”Ÿæ•…éšœï¼Œæ¯”å¦‚æµé‡æ¿€å¢ã€ç½‘ç»œæŠ–åŠ¨ã€äº‘æœåŠ¡èµ„æºåˆ†é…å‡ºç°é—®é¢˜ç­‰ï¼Œå‘ç”Ÿæ•…éšœåé‡æ–°æ‰§è¡Œè®¡ç®—ï¼Œåœ¨å­˜åœ¨ä¸ç¡®å®šè¾“å…¥çš„å‰æä¸‹è®¾è®¡å¥å£®çš„å®¹é”™æœºåˆ¶éš¾åº¦å¾ˆå¤§ã€‚

  

é™¤äº†æ•°æ®è¾“å…¥å¸¦æ¥çš„æŒ‘æˆ˜ï¼Œæµè®¡ç®—è¾“å‡ºçš„æ•°æ®ä¼šè¢«å®æ—¶æ¶ˆè´¹ï¼Œç±»ä¼¼è¿™æ ·ä¸åŒäºæ‰¹å¤„ç†çš„åº”ç”¨åœºæ™¯ï¼Œä¹Ÿç»™æ•°æ®çš„ä¸€è‡´æ€§å¸¦æ¥çš„è¯¸å¤šæŒ‘æˆ˜ï¼Œå¦‚å‡ºç° FO åï¼Œæ˜¯æ’¤å›ä¹‹å‰å‘å‡ºçš„æ•°æ®ï¼Œè¿˜æ˜¯æ˜¯åŒä¸‹æ¸¸è¿›è¡Œåå•†å®ç°ä¸€è‡´æ€§ï¼Œéƒ½æ˜¯éœ€è¦è€ƒè™‘çš„ã€‚

  

### 2Â Â ä¸€è‡´æ€§ç›¸å…³æ¦‚å¿µç¥›é­…

  

æ­£ç¡®è®¤è¯†æµè®¡ç®—ç³»ç»Ÿä¸€è‡´æ€§çš„å†…åœ¨å«ä¹‰å’Œå…¶èƒ½åŠ›èŒƒç•´ï¼Œå¯¹æˆ‘ä»¬æ„å»ºæ­£ç¡®ä¸”å¥å£®çš„æµè®¡ç®—ä»»åŠ¡è‡³å…³é‡è¦ã€‚ä¸‹é¢æˆ‘ä¼šä»‹ç»å‡ ç»„æ¦‚å¿µï¼Œä»¥ä¾¿äºå¤§å®¶æ›´å¥½åœ°ç†è§£æµè®¡ç®—ç³»ç»Ÿçš„ä¸€è‡´æ€§ã€‚

  

æ°å¥½ä¸€æ¬¡â‰ æ°å¥½ä¸€è‡´

  

ä»Šå¤©å¤§å¤šæ•°æµè®¡ç®—å¼•æ“ç”¨ã€ŒExactly-Onceã€å»æš—ç¤ºç”¨æˆ·ï¼šæ—¢ç„¶è¾“å…¥çš„æ•°æ®ä¸æ˜¯é™æ€é›†åˆè€Œæ˜¯ä¼šè¿ç»­å˜åŒ–çš„ï¼Œé‚£å¯¹æ¯ä¸€æ¡æ¶ˆæ¯ã€Œæ°å¥½å¤„ç†ã€äº†ä¸€æ¬¡ï¼Œè¾“å‡ºçš„æ•°æ®è‚¯å®šæ˜¯ä¸€è‡´çš„ã€‚ä¸Šè¿°é€»è¾‘çš„æ¨å¯¼è¿‡ç¨‹æ˜¯æ²¡é—®é¢˜çš„ï¼Œä½†å¹¶ä¸ä¸¥è°¨ï¼Œå› ä¸º Exactly-Once ä½œä¸ºä¸€ä¸ªå½¢å®¹è¯ï¼Œåé¢æ‰€è¿æ¥çš„åŠ¨è¯æˆ–è€…å®¾è¯­è¢«æ•…æ„æŠ¹å»äº†ï¼Œä¸åŒçš„è¡¨è¾¾å«ä¹‰ä¹Ÿä¼šå¤§ç›¸å¾„åº­ã€‚

  

ä¾‹å­1ï¼Œåæ¥ä¸åŒçš„åŠ¨ï¼ˆåï¼‰è¯ï¼šExactly-once Delivery å’ŒÂ  Exactly-once Process ã€‚å‰è€…æ˜¯å¯¹æ¶ˆæ¯ä¼ è¾“å±‚é¢çš„è¯­ä¹‰è¡¨è¾¾ï¼Œå’Œæµè®¡ç®—çš„ä¸€è‡´æ€§å…³ç³»ä¸æ˜¯å¾ˆå¤§ï¼Œåè€…æ˜¯ä»æµè®¡ç®—çš„åº”ç”¨å±‚é¢å»æè¿°æ•°æ®å¤„ç†è¿‡ç¨‹ã€‚

  

ä¾‹å­2ï¼Œåæ¥ä¸åŒçš„åè¯ï¼šExactly-once State Consistency å’Œ Exactly-once Process Consistencyã€‚å‰è€…æ˜¯ Flink åœ¨å®˜ç½‘ä¸­å¯¹å…¶ä¸€è‡´æ€§çš„å™è¿°ï¼Œåè€…æ˜¯ Kafka Streaming çš„ä¸€è‡´æ€§ä¿è¯ï¼Œå‰è€…çš„è¯­ä¹‰çº¦æŸå¼±äºåè€…ã€‚Exactly-once State Consistency åªæ˜¯è¡¨è¾¾äº†ï¼šæµè®¡ç®—è¦æ±‚å¯¹çŠ¶æ€çš„æ›´æ–°åªæäº¤ä¸€æ¬¡åˆ°æŒä¹…åç«¯å­˜å‚¨ï¼Œä½†è¿™é‡Œçš„çŠ¶æ€ä¸€èˆ¬ä¸åŒ…æ‹¬ã€Œè¾“å‡ºåˆ°ä¸‹æ¸¸ç»“æœã€ï¼Œè€Œä»…æŒ‡å¼•æ“å†…éƒ¨çš„çŠ¶æ€ï¼Œè­¬å¦‚å„ä¸ªç®—å­çš„çŠ¶æ€ã€å®æ—¶æµçš„æ¶ˆè´¹åç§»ç­‰ï¼Œæµè®¡ç®—å¼•æ“å†…éƒ¨çŠ¶æ€å˜æ›´çš„ä¿è¯ï¼Œå¹¶ä¸èƒ½ç­‰ä»·äºä»è¾“å…¥åˆ°è¾“å‡ºçš„ä¸€è‡´æ€§ï¼Œç«¯åˆ°ç«¯ä¸€è‡´æ€§éœ€è¦ä½ è‡ªå·±å…³å¿ƒã€‚

  

æ€»ä¹‹ï¼Œå¦‚ä½•æˆ‘ä»¬åé¢å†çœ‹åˆ° Exactly-once XXXï¼Œä¸€å®šè¦è­¦æƒ•å¼•æ“æƒ³è¦é€éœ²å‡ºä»€ä¹ˆä¿¡æ¯ã€‚

  

ç«¯åˆ°ç«¯çš„æ•°æ®ä¸€è‡´æ€§

  

ç«¯åˆ°ç«¯ä¸€è‡´æ€§ï¼ˆEnd-To-Ene Consistencyï¼‰ï¼Œå³å°†æ•°æ®çš„è¾“å‡ºä¹Ÿä½œä¸ºæµè®¡ç®—å¼•æ“çš„ä¸€è‡´æ€§è®¾è®¡çš„ä¸€éƒ¨åˆ†ï¼Œæ­£ç¡®çš„ç»“æœè´¯ç©¿ç€è¿™æ•´ä¸ªæµè®¡ç®—åº”ç”¨çš„å§‹ç»ˆï¼šä»è¾“å…¥ã€å¤„ç†è¿‡ç¨‹ã€è¾“å‡ºï¼Œæ¯ä¸€ä¸ªç¯èŠ‚éƒ½éœ€è¦ä¿è¯å…¶è‡ªèº«çš„æ•°æ®ä¸€è‡´æ€§ï¼ŒåŒæ—¶åœ¨æ•´ä¸ªæµè®¡ç®—æµç¨‹ä¸­ï¼Œä½œä¸ºæ•´ä½“å®ç°äº†ç«¯åˆ°ç«¯çš„ä¸€è‡´æ€§ã€‚

  

ä¸‹é¢å™è¿°ä¸­ï¼Œå¦‚æœä¸æ˜¯ç‰¹æ„è¯´æ˜ï¼Œä¸€è‡´æ€§æŒ‡çš„æ˜¯å¼•æ“è‡ªèº«çŠ¶æ€çš„ä¸€è‡´æ€§ï¼Œç«¯åˆ°ç«¯ä¸€è‡´æŒ‡çš„æ˜¯åŒ…å«äº†è¾“å‡ºçš„ä¸€è‡´æ€§ã€‚

  

## **äºŒÂ  æµè®¡ç®—ç³»ç»Ÿçš„æœ¬è´¨**

å‰é¢æˆ‘ä»¬å®šä¹‰äº†æµè®¡ç®—ä¸€è‡´æ€§çš„æ¦‚å¿µï¼Œè¿™ä¸€éƒ¨åˆ†å°†ä¼šä»æ¦‚å¿µå‡ºå‘å°†é—®é¢˜è¿›è¡Œå½¢å¼åŒ–æ‹†è§£ï¼Œä»¥ä¾¿å¾—åˆ°é€šç”¨åŒ–çš„è§£æ³•ã€‚

  

### 1Â  å†æ¬¡è®¤è¯†æµè®¡ç®—

  

ä¸Šé¢æåˆ°ï¼Œæµè®¡ç®—çš„è¾“å…¥æ•°æ®æ˜¯æ²¡æœ‰è¾¹ç•Œçš„ï¼Œè¿™ç¬¦åˆæˆ‘ä»¬ä¼ ç»Ÿä¸Šå¯¹æµè®¡ç®—è®¤çŸ¥ã€‚åœ¨ã€ŠSystem Streamingã€‹ä¸€ä¹¦ä¸­ï¼Œä½œè€…æå‡ºäº†ä¸€ä¸ªå°†æµæ‰¹ç»Ÿä¸€è€ƒè™‘çš„æµè®¡ç®—ç†è®ºæŠ½è±¡ï¼Œå³ï¼Œä»»æ„çš„æ•°æ®çš„å¤„ç†éƒ½æ˜¯ã€Œæµï¼ˆStreamï¼‰ã€Â å’Œã€Œè¡¨ï¼ˆTableï¼‰ã€é—´çš„äº’ç›¸è½¬æ¢ï¼Œå…¶ä¸­æµç”¨æ¥è¡¨å¾è¿åŠ¨ä¸­çš„æ•°æ®ï¼Œè¡¨ç”¨æ¥è¡¨å¾é™æ­¢çš„æ•°æ®ï¼š

  

1. æµÂ ->Â æµï¼šæ²¡æœ‰èšåˆæ“ä½œçš„æ•°æ®å¤„ç†è¿‡ç¨‹ï¼›
    
2. æµÂ ->Â è¡¨ï¼šå­˜åœ¨èšåˆæ“ä½œçš„æ•°æ®å¤„ç†è¿‡ç¨‹ï¼›
    
3. è¡¨Â ->Â æµï¼šè§¦å‘è¾“å‡ºè¡¨æ•°æ®å˜åŒ–çš„æƒ…å†µï¼›
    
4. è¡¨Â ->Â è¡¨ï¼šä¸å­˜åœ¨è¿™æ ·çš„æ•°æ®å¤„ç†é€»è¾‘ã€‚
    

  

åœ¨è¿™ä¸ªç»Ÿä¸€çš„ç†è®ºæ¡†æ¶ä¸‹ï¼Œæ‰¹å¤„ç†è¿‡ç¨‹çš„ä¸€è‡´æ€§ä¹Ÿå¯ä»¥çº³å…¥æœ¬æ–‡è®¨è®ºçš„èŒƒç•´ä¸­æ¥ã€‚ä½†æ— è®ºæ˜¯çº¯ç²¹çš„æµè®¡ç®—ï¼Œè¿˜æ˜¯ä¸Šé¢ç»Ÿä¸€çš„æ•°æ®å¤„ç†æ¨¡å‹ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥å°†æµï¼ˆæ‰¹ï¼‰æ•°æ®å¤„ç†çš„è¿‡ç¨‹æŠ½è±¡ä¸ºã€Œè¯»å–æ•°æ®-å¤„ç†æ•°æ®-è¾“å‡ºæ•°æ®ã€è¿™æ ·çš„ä¸‰ä¸ªéƒ¨åˆ†ï¼Œå¯ç”¨ä¸‹é¢çš„æœ‰å‘æ— ç¯å›¾æ¥è¡¨è¾¾ï¼Œå…¶ä¸­ç‚¹ä»£è¡¨æ•°æ®åŠ å·¥é€»è¾‘ï¼Œè¾¹è¡¨ç¤ºæ•°æ®æµå‘ï¼Œæ•°æ®å¤„ç†è¿‡ç¨‹ä¸­çš„ä¸­é—´çŠ¶æ€ï¼ˆStateï¼‰ä¸€èˆ¬éœ€è¦åšæŒä¹…åŒ–å­˜å‚¨ã€‚

  

![å›¾ç‰‡](data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='1px' height='1px' viewBox='0 0 1 1' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg stroke='none' stroke-width='1' fill='none' fill-rule='evenodd' fill-opacity='0'%3E%3Cg transform='translate(-249.000000, -126.000000)' fill='%23FFFFFF'%3E%3Crect x='249' y='126' width='1' height='1'%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E)

###   

### 2Â  ç¡®å®šæ€§/éç¡®å®šæ€§è®¡ç®—

  

æµè®¡ç®—ä¸­çš„ç¡®å®šæ€§æŒ‡çš„æ˜¯ï¼Œç»™å®šç›¸åŒçš„ä¸€ç»„æ•°æ®ï¼Œé‡å¤è¿è¡Œå¤šæ¬¡æˆ–è€…æ‰“ä¹±æ•°æ®è¿›å…¥å¼•æ“çš„é¡ºåºï¼Œè®¡ç®—å®Œæˆåå°†ä¼šè¾“å‡ºç›¸åŒçš„ç»“æœï¼Œå¦åˆ™å°±æ˜¯éç¡®å®šæ€§è®¡ç®—ã€‚å¸¸è§çš„éç¡®å®šæ€§è®¡ç®—åŒ…æ‹¬ä½¿ç”¨äº†éšæœºæ•°ã€ä½¿ç”¨ç³»ç»Ÿæ—¶é—´ã€å­—ç¬¦ä¸²æ‹¼æ¥ç­‰ã€‚å¦‚æœæµè®¡ç®—ä¸­å­˜åœ¨éç¡®å®šæ€§çš„è®¡ç®—ï¼Œåˆ™ä¼šç»™ç«¯åˆ°ç«¯ä¸€è‡´æ€§çš„å®ç°é€ æˆå¾ˆå¤šå›°éš¾ï¼Œéƒ¨åˆ†å¼•æ“å¹¶ä¸èƒ½å¾ˆå¥½åœ°æ”¯æŒæ­¤ç±»åœºæ™¯ã€‚

  

### 3Â  ä¸€è‡´æ€§é—®é¢˜çš„å½¢å¼åŒ–å®šä¹‰

  

åœ¨å­˜åœ¨ä¸ç¡®å®šæ€§è®¡ç®—çš„æµè®¡ç®—ä¸­ï¼Œä¸ç¡®å®šæ€§è®¡ç®—çš„ï¼ˆä¸­é—´ï¼‰ç»“æœå¯è§†ä¸ºæµè®¡ç®—å¼•æ“çŠ¶æ€çš„ä¸€éƒ¨åˆ†ã€‚ä»æ•´ä½“ä¸Šçœ‹ï¼Œä»»ä½•ä¸€ä¸ªæ—¶é—´ç‚¹çš„å¼•æ“çŠ¶æ€ç­‰äºä¹‹å‰æ‰€æœ‰äº‹ä»¶è®¡ç®—ç»“æœï¼ˆä¸­é—´ç»“æœå’Œè¾“å‡ºç»“æœï¼‰çš„ç´¯è®¡ã€‚å¦‚æœå®šä¹‰æµè®¡ç®—çš„è¾“å…¥é›†åˆä¸ºï¼šEï¼Œt æ—¶åˆ»ä»¥æ¥çš„è¾“å…¥é›†åˆä¸º E(t)ï¼Œè¾“å‡ºé›†åˆä¸º Sink(t)ï¼Œå¼•æ“æ­¤æ—¶çŠ¶æ€ä¸º State(t)ï¼ŒState(t)Â åŒ…æ‹¬å„ä¸ªç®—å­çš„çŠ¶æ€ï¼ˆåŒ…æ‹¬ä¸Šé¢æåˆ°çš„ä¸ç¡®å®šæ€§è®¡ç®—ï¼‰ã€æ•°æ®æºçš„æ¶ˆè´¹åç§»é‡ï¼ˆæˆ–æ–‡ä»¶è¯»å–åç§»ç­‰ï¼‰ç­‰ï¼š

  

State(t)Â =Â OperatorState(t)Â Â +Â SourceState(t)

  

åˆ™å®šä¹‰æµè®¡ç®—å¼•æ“çš„è®¡ç®—è¿‡ç¨‹ä¸ºï¼Œå­˜åœ¨è®¡ç®—è®¡ç®—é€»è¾‘ F ä½¿å¾—ï¼š

  

F(E(t),Â Sink(t),Â State(t))Â =Â Sink(t+1)Â +Â State(t+1)

  

ä»¤ O(t)Â = Sink(t)Â + State(t)ï¼Œå³å°†è®¡ç®—å¯¹å¼•æ“çŠ¶æ€çš„æ›´æ–°è§†ä¸ºä¸€ç§ç‰¹æ®Šçš„è¾“å‡ºï¼Œåˆ™æµè®¡ç®—è¿‡ç¨‹å¯ç®€åŒ–ä¸ºï¼š

  

F(E(t),Â O(t))Â =Â O(t+1)

  

ç»“åˆæµè®¡ç®—ä¸Šé¢æµè®¡ç®—ä¸€è‡´æ€§çš„å®šä¹‰ï¼Œæˆ‘ä»¬å¸Œæœ›åœ¨å¼•æ“å‘ç”Ÿæ•…éšœÂ FailOverÂ æ—¶ï¼Œå­˜åœ¨ä¸€ç§æ¢å¤å‡½æ•°Â RÂ ä½¿å¾—

  

R(E(t),Â O(t))Â =Â O'(t+1)ï¼Œä¸”Â O'(t+1)Â =Â O(t+1)

  

æˆ‘ä»¬åœ¨è¿™é‡Œå°†å¼•æ“çŠ¶æ€ä½œä¸ºä¸€ç§ç‰¹æ®Šè¾“å‡ºçš„è€ƒè™‘æœ‰ä¸¤ç‚¹ã€‚å…¶ä¸€ï¼Œå¼•æ“çš„çŠ¶æ€ä¸€èˆ¬ä¹Ÿæ˜¯è¾“å‡ºåˆ°å¤–éƒ¨å­˜å‚¨å¦‚ RocksDB/HDFSï¼Œè¿™å’Œè®¡ç®—ä¸‹æ¸¸çš„è¾“å‡ºåˆ«æ— äºŒè‡´ã€‚å…¶äºŒï¼Œé€šè¿‡å±è”½å¼•æ“å†…éƒ¨çš„å®¹é”™æœºåˆ¶å®ç°ï¼Œç®€åŒ–ç«¯åˆ°ç«¯ä¸€è‡´æ€§é—®é¢˜çš„æŠ½è±¡è¿‡ç¨‹ï¼Œä¾¿äºæ›´å¥½åœ°ç†è§£é—®é¢˜æœ¬èº«ã€‚

  

![å›¾ç‰‡](data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='1px' height='1px' viewBox='0 0 1 1' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg stroke='none' stroke-width='1' fill='none' fill-rule='evenodd' fill-opacity='0'%3E%3Cg transform='translate(-249.000000, -126.000000)' fill='%23FFFFFF'%3E%3Crect x='249' y='126' width='1' height='1'%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E)

## 

## **ä¸‰Â  ä¸€è‡´æ€§çš„é€šç”¨è§£æ³•**

### 1Â  é€šç”¨è§£æ³•çš„æ¨å¯¼

  

æˆ‘ä»¬åœ¨ä¸Šé¢å®šä¹‰äº†ç«¯åˆ°ç«¯ä¸€è‡´æ€§éš¾é¢˜ï¼šR(E(t), O(t))Â = O(t+1)ã€‚ä»è¾“å‡ºç»“æœçš„ä½¿ç”¨æ–¹ï¼ˆå¼•æ“å†…éƒ¨å’Œå¼•æ“ä¸‹æ¸¸æ•°æ®æ¶ˆè´¹æ–¹ï¼‰çš„è§†è§’æ¥çœ‹ï¼šå¯¹äºè®°å½• O(t+1)ï¼Œå½“åœ¨æ•…éšœå‘ç”Ÿçš„æ—¶é—´å°äº t ï¼ˆæ•°æ®æ²¡æœ‰è¾“å‡ºï¼‰æˆ–è€…Â å¤§äº t + 1ï¼ˆæ•°æ®å·²ç»è¾“å‡ºäº†ï¼‰ï¼Œæ•°æ®è‚¯å®šæ˜¯ä¸€è‡´çš„ã€‚

  

å½“åœ¨ t ~ t + 1 æ—¶åˆ»å‘ç”Ÿæ•…éšœï¼Œæ¢å¤å‡½æ•° R å¯ä»¥å±è”½æ­¤æ¬¡æ•…éšœäº§ç”Ÿçš„å‰¯ä½œç”¨ï¼Œè®©ä½¿ç”¨æ–¹è®¤ä¸ºæ²¡æœ‰æ•…éšœå‘ç”Ÿï¼Œå¯ä»¥å¾—åˆ°æ­£ç¡®çš„ O(t+1)ï¼Œæ˜¾ç„¶ï¼Œè§£å†³çš„æ€è·¯æ˜¯ï¼šå°† E(t)Â å’Œ O(t)Â ä½œä¸ºè¾“å…¥ï¼Œé‡æ–°æ‰§è¡Œè®¡ç®— Fï¼Œåˆ™å¯ä»¥å¾—åˆ°æ­£ç¡®çš„ O(t+1)ï¼Œå…·ä½“åœ°ï¼ŒE(t)Â å¯ä»¥é€šè¿‡å›æ‹¨æ•°æ®åç§»é‡å¾—åˆ°ï¼ŒO(t)Â Â éœ€è¦ä»æŒä¹…åŒ–å­˜å‚¨ä¸­è·å–ã€‚O(t)Â Â æ˜¯å¦å¯ä»¥é€šè¿‡é€’å½’é‡ç®—å¾—åˆ°å‘¢ï¼Œå³ O(t)Â = F(E(t-1), O(t-1))Â ï¼Œç­”æ¡ˆæ˜¯ä¸å¯ä»¥ï¼Œå› ä¸ºè®¡ç®—è¿‡ç¨‹ä¸­å¯èƒ½å­˜åœ¨ä¸ç¡®å®šçš„è®¡ç®—é€»è¾‘ï¼Œå¦‚æœé‡ç®—ï¼Œåˆ™æœ‰ä¸€å®šæ¦‚ç‡ O(t)Â â‰ Â  F(E(t-1), O(t-1))Â ã€‚

  

å› æ­¤ï¼Œæˆ‘ä»¬å¾—åˆ°æµè®¡ç®—å¼•æ“è¦å®ç°ç«¯åˆ°ç«¯ä¸€è‡´æ€§æ•°æ®å¤„ç†è¯­ä¹‰çš„å……åˆ†å¿…è¦æ¡ä»¶ï¼šåœ¨æµè®¡ç®—è¿‡ç¨‹ä¸­ï¼Œéœ€è¦å®æ—¶å­˜å‚¨æ¯ä¸€æ¡ä¸­é—´å’Œæœ€ç»ˆè®¡ç®—ç»“æœï¼Œå¦‚æœè€ƒè™‘ååç‡ä¸èƒ½å­˜å‚¨æ¯ä¸€æ¡ï¼Œåˆ™éœ€å®šæœŸä»¥äº‹åŠ¡çš„æ–¹å¼è¿›è¡Œæ‰¹é‡å­˜å‚¨ã€‚å¯¹äºæ¯ä¸€ä¸ª O(t)Â å­˜å‚¨åï¼ŒÂ æ¢å¤å‡½æ•° R çš„å®ç°å°±ç®€å•å¤šäº†ï¼šä»»åŠ¡æ¢å¤æ—¶ï¼Œå°† O(t)Â é‡æ–°åŠ è½½ï¼Œä½¿ç”¨ F æ‰§è¡Œé‡ç®—æ“ä½œã€‚

  

### 2Â  é€šç”¨è§£æ³•çš„å·¥ç¨‹å®ç°

  

æˆ‘ä»¬å°†ç«¯åˆ°ç«¯ä¸€è‡´æ€§é—®é¢˜çš„è§£æ³•ç»“åˆå·¥ç¨‹å®è·µï¼Œåˆ†æä¸€ä¸‹é€šç”¨è§£æ³•ä¸‹çš„è‹¥å¹²å®ç°åœºæ™¯ã€‚

  

åœ¨é€šç”¨è§£æ³•ä¸­ï¼Œæˆ‘ä»¬éœ€è¦å­˜å‚¨æ¯ä¸€æ¬¡è®¡ç®—çš„ä¸­é—´ç»“æœï¼Œè¿™å¯¹å¼•æ“çš„æ¶æ„è®¾è®¡ã€é…å¥—åŸºå»ºèƒ½åŠ›æœ‰ç€å¾ˆé«˜çš„è¦æ±‚ï¼Œå¦‚éœ€è¦é«˜å¯ç”¨ã€é«˜ååçš„å­˜å‚¨åç«¯ç”¨äºçŠ¶æ€å­˜å‚¨ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å°†æ¡ä»¶é€€åŒ–ä¸ºå¯ä»¥é€šè¿‡äº‹åŠ¡çš„æ–¹å¼è¿›è¡Œæ‰¹é‡å­˜å‚¨ï¼Œè¿™æ˜¯å› ä¸ºäº‹åŠ¡çš„ ACID ç‰¹æ€§èƒ½ä¿è¯ç»“æœèƒ½ä»¥åŸå­æäº¤çš„æ–¹å¼ä½œç”¨äºä¸‹æ¸¸ç®—å­æˆ–è€…æ˜¯å¤–éƒ¨çš„æ¶ˆæ¯ç³»ç»Ÿ/æ•°æ®åº“ï¼Œåœ¨ä¿è¯äº†ç»“æœï¼ˆçŠ¶æ€ï¼‰ä¸€è‡´æ€§çš„å‰æä¸‹ï¼Œèƒ½è¾¾åˆ°è¾ƒé«˜çš„ååç‡ã€‚

  

è¿›ä¸€æ­¥åˆ†æï¼Œæ¯ä¸€æ¬¡å­˜å‚¨æˆ–è€…æ‰¹é‡äº‹åŠ¡å­˜å‚¨ O(t)Â Â æ—¶ï¼Œå¼•æ“åˆ°åº•åšäº†ä»€ä¹ˆï¼Ÿå‰é¢æˆ‘ä»¬å®šä¹‰äº† O(t)Â = Sink(t)Â + State(t)Â Â -> O(t)Â = Sink(t)Â + OperatorState(t)Â Â + SourceState(t)Â ï¼Œå¯¹äºå¼•æ“æ¥è¯´ï¼Œå½“å‡ºç° FailOver æ—¶ï¼Œéƒ½ä¼šé€šè¿‡ SourceState(t)Â å›æ‹¨æ•°æ®æºåç§»é‡è¿›è¡Œéƒ¨åˆ†é‡ç®—ï¼Œå³æ¶ˆæ¯è¯»å–è¯­ä¹‰æ˜¯ At-Least-Once çš„ï¼Œå½“é‡å¤è®¡ç®—æ—¶ï¼Œå‰é¢å­˜å‚¨çš„ç»“æœï¼ˆæ¯ä¸€æ¬¡è®¡ç®—ï¼‰æˆ–è€…ç©ºçš„ç»“æœï¼ˆæ‰¹é‡äº‹åŠ¡ï¼‰å¯ä»¥å®ç°å¹‚ç­‰å˜æ›´çš„æ•ˆæœï¼šå¦‚æœç»“æœå·²ç»å­˜åœ¨äº†ï¼ŒÂ åˆ™ä½¿ç”¨å·²æœ‰çš„ç»“æœï¼Œæ¶ˆé™¤ä¸ç¡®å®šæ€§è®¡ç®—å¸¦æ¥çš„å‰¯ä½œç”¨ï¼Œå¦‚æœä¹‹å‰çš„ç»“æœä¸å­˜åœ¨ï¼Œå°±æ›´ä¸ä¼šå¯¹å¤–éƒ¨ç³»ç»Ÿæœ‰å½±å“äº†ã€‚

  

å¦‚æœæˆ‘ä»¬çš„è®¡ç®—è¿‡ç¨‹éƒ½æ˜¯ç¡®å®šæ€§çš„ï¼Œé‚£ä¹ˆä¸Šè¿°çš„å……åˆ†å¿…è¦æ¡ä»¶ä¼šæœ‰ä»€ä¹ˆå˜åŒ–å‘¢ï¼Ÿåœ¨ç¡®å®šæ€§è®¡ç®—çš„å‰æä¸‹ï¼Œå¦‚æœå¼•æ“è¾“å‡ºç»“æœçš„æ¥å—ç«¯æ˜¯å¯ä»¥å®ç°ä¸ºå¹‚ç­‰ï¼Œåˆ™å¾ˆå¤šçº¦æŸæ¡ä»¶ä¼šæœ‰æ‰€ç®€åŒ–ã€‚ç”±äº O(t)Â = Sink(t)Â + State(t)Â Â ï¼Œå¼•æ“å†…éƒ¨å¾ˆå¥½å®ç°å¹‚ç­‰çŠ¶æ€æ›´æ–°ï¼Œè‹¥å¼•æ“ä¸‹æ¸¸ç³»ç»Ÿä¹Ÿå®ç°äº†æ•°æ®å¹‚ç­‰ï¼Œå½“åœ¨ t ~ t + n é—´å†…å‡ºç° FailOver æ—¶ï¼Œå¼•æ“å¯ä»¥é€šè¿‡é‡æ–°è®¡ç®— t ~ t + n ä¹‹é—´çš„æ‰€æœ‰å€¼ï¼Œç›´æ¥è¾“å‡ºç»™ä¸‹æ¸¸ä½¿ç”¨ã€‚

  

å› æ­¤ï¼Œåœ¨ä»…æœ‰ç¡®å®šæ€§è®¡ç®—çš„æµè®¡ç®—ç³»ç»Ÿä¸­ï¼Œå®ç°ç«¯åˆ°ç«¯çš„å……åˆ†å¿…è¦æ¡ä»¶å¯é€€åŒ–ä¸ºï¼šåœ¨æµè®¡ç®—è¿‡ç¨‹ä¸­ï¼Œéœ€è¦å¤–éƒ¨çš„æœ€ç»ˆç»“æœæ¥å—ç«¯å®ç°å¹‚ç­‰ï¼Œå®æ—¶å­˜å‚¨æ¯ä¸€æ¡ä¸­é—´å’Œæœ€ç»ˆè®¡ç®—ç»“æœï¼Œå¦‚æœè€ƒè™‘ååç‡ä¸èƒ½å­˜å‚¨æ¯ä¸€æ¡ï¼Œåˆ™éœ€å®šæœŸæ‰¹é‡å­˜å‚¨ï¼Œä¸Šè¿°æ¡ä»¶ä¸­å»æ‰äº†å¯¹ã€Œäº‹åŠ¡ã€çš„è¦æ±‚çš„åŸå› ï¼šå¦‚æœåœ¨æäº¤è¿™ä¸€æ‰¹æ•°æ®çš„æäº¤è¿‡ç¨‹ä¸­åˆå‘ç”Ÿäº†å¼‚å¸¸ï¼Œè­¬å¦‚åªæœ‰éƒ¨åˆ†èŠ‚ç‚¹çš„ç»“æœè¾“å‡ºäº†ï¼Œå…¶ä»–èŠ‚ç‚¹å‘ç”Ÿäº†æ•…éšœç»“æœä¸¢å¤±ï¼Œåˆ™å¯ä»¥é€šè¿‡å›åˆ°ä¸Šä¸ªæ‰¹æ¬¡æäº¤çš„çŠ¶æ€ï¼Œé‡ç®—æ­¤æ‰¹æ¬¡æ•°æ®ï¼Œé‡ç®—è¿‡ç¨‹ä¸­ï¼Œç”±äºä»…å­˜åœ¨ç¡®å®šæ€§è®¡ç®—ï¼Œæ‰€ä»¥æ— è®ºæ˜¯å¼•æ“å†…è¿˜æ˜¯å¼•æ“å¤–ï¼Œæ˜¯å¯ä»¥é€šè¿‡å¹‚ç­‰æ¥ä¿è¯æ•°æ®çš„çš„ä¸€è‡´æ€§çš„ã€‚

  

åœ¨å®é™…çš„æµè®¡ç®—å¼•æ“å®ç°ä¸­ï¼Œå¯¹äºç»“æœå†…å®¹çš„å®šä¹‰å¤§éƒ½æ˜¯ä¸€è‡´çš„ï¼Œä¸»è¦åŒ…æ‹¬è¾“å…¥æºçš„æ¶ˆè´¹åç§» SourceState(t)ï¼Œe.g. Kafka Offsetï¼Œç®—å­çŠ¶æ€ OperatorState(t)ï¼Œe.g. Spark RDD è¡€ç¼˜ï¼Œè¾“å‡ºçš„ç»“æœ Sink(t)ï¼Œe.g. Kafka äº‹åŠ¡æ¶ˆæ¯ï¼Œä½†æ˜¯åœ¨ç»“æœçš„å­˜å‚¨æ–¹å¼ä¸Šå„æœ‰æ‰€ä¸åŒï¼Œä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸€çœ‹ç›®å‰ä¸šç•Œä¸»æµçš„å‡ ä¸ªæµè®¡ç®—å¼•æ“çš„è®¾è®¡è€ƒé‡ã€‚

  

## **å››Â  ä¸€è‡´æ€§çš„å¼•æ“å®ç°**

ç›®å‰æµè®¡ç®—å¼•æ“çš„ç§ç±»éå¸¸å¤šï¼Œä¸æ˜¯æ‰€æœ‰çš„å¼•æ“éƒ½å¯ä»¥å®ç°ç«¯åˆ°ç«¯ä¸€è‡´çš„æµå¤„ç†ï¼Œåœ¨å…·å¤‡æ­¤èƒ½åŠ›çš„å¼•æ“ä¸­ï¼Œä»æŠ€æœ¯æˆæœ¬ã€å¼•æ“æ¶æ„ã€èƒ½åŠ›èŒƒå›´è€ƒè™‘ï¼Œä¼šæœ‰ä¸åŒçš„å–èˆå’Œå®ç°ï¼Œå¦‚ Flink ä¸­ä½¿ç”¨äº†è½»é‡çº§çš„ã€Œåˆ†å¸ƒå¼ä¸€è‡´æ€§å¿«ç…§ã€ç”¨äºçŠ¶æ€ç®¡ç†ï¼ŒKafka Streams ä¸ºä½•æ²¡æœ‰ä½¿ç”¨å‘¢ï¼Ÿå®ç°äº†å¹‚ç­‰è¾“å‡ºå°±ä¸€å®šèƒ½å®ç°ç«¯åˆ°ç«¯ä¸€è‡´ä¹ˆï¼Ÿæœ¬ç« èŠ‚ä¼šä¸€ä¸€è§£ç­”ä¸Šè¿°é—®é¢˜ã€‚

  

### 1Â  GoogleÂ MillWheel

  

Googleåœ¨2013å¹´å‘äº†ä¸€ç¯‡åä¸ºã€ŠMillWheel: Fault-Tolerant Stream Processing at. Internet Scaleã€‹çš„æ–‡ç« ï¼Œè®ºè¿°äº†åœ¨ Google å†…éƒ¨å®ç°ä½å»¶è¿Ÿæ•°æ®å¤„ç†çš„ç¼–ç¨‹æ¨¡å‹å’Œå·¥ç¨‹å®ç°ï¼Œåé¢ Google åœ¨æ­¤åŸºç¡€ä¸ŠæŠ½è±¡å‡ºäº† DataFlow æµå¤„ç†æ¨¡å‹ï¼ˆå…·ä½“å‚è€ƒè®ºæ–‡ã€ŠThe Dataflow Model: A Practical Approach to Balancing Correctness, Latency, and Cost in Massive-Scale,Unbounded, Out-of-Order Data Processingã€‹ï¼‰ï¼Œåè€…å¯¹æµè®¡ç®—æµåŸŸçš„å½±å“å ªæ¯”20ä¸–çºªåˆ GFSï¼ŒBigTable ä»¥åŠMapReduce ä¸‰ç¯‡è®ºæ–‡å¯¹å¤§æ•°æ®çš„å½±å“ï¼Œåé¢ Google åˆåœ¨ MillWheel ä¹‹ä¸Šç»§ç»­å‘å±•ï¼Œå¼€æºäº† Apache Bean è¿™ä¸ªç³»ç»Ÿçº§çš„æµæ‰¹ä¸€ä½“æ•°æ®è§£å†³æ–¹æ¡ˆï¼Œå› ä¸º MillWheel æ˜¯æ›´çº¯ç²¹çš„ã€Œæµè®¡ç®—ã€ï¼Œæ‰€ä»¥æˆ‘ä»¬é‡ç‚¹æ¥åˆ†æ MillWheelã€‚

  

MillWheel ä½¿ç”¨äº†ä¸€ç§åä¸ºã€ŒStrong productionã€çš„æœºåˆ¶å°†æ¯ä¸ªç®—å­çš„è¾“å‡ºåœ¨å‘é€è‡³ä¸‹æ¸¸ä¹‹å‰éƒ½è¿›è¡Œäº†æŒä¹…åŒ–å­˜å‚¨ï¼Œä¸€æ—¦å‘ç”Ÿäº†æ•…éšœï¼Œå½“éœ€è¦æ¢å¤æ—¶ï¼Œå¼•æ“å¯ä»¥ç›´æ¥å°†å­˜å‚¨åçš„ç»“æœå‘å‡ºå»ã€‚å›å¤´å†çœ‹ç«¯åˆ°ç«¯ä¸€è‡´æ€§æ•°æ®å¤„ç†è¯­ä¹‰çš„å……åˆ†å¿…è¦æ¡ä»¶ï¼Œæ˜¾ç„¶ MillWheel Â æ˜¯ç¬¦åˆã€Œå®æ—¶å­˜å‚¨æ¯ä¸€æ¡ä¸­é—´å’Œæœ€ç»ˆè®¡ç®—ç»“æœã€è¿™ä¸ªæ¡ä»¶çš„ã€‚å¯¹äºå­˜åœ¨ä¸ç¡®å®šæ€§è®¡ç®—çš„æµè®¡ç®—åœºæ™¯ï¼Œå½“ FailOver æ—¶ï¼Œå¼•æ“ä¼šä»æºå¤´é‡æ–°å‘é€æ¶ˆæ¯è¿›è¡Œé‡ç®—ï¼Œå¤šæ¬¡è®¡ç®—å¯èƒ½ä¼šäº§ç”Ÿçš„ä¸ä¸€è‡´çš„ç»“æœï¼Œä½†ç”±äºã€ŒStrong Productionã€ä¼šå¯¹è®¡ç®—è¿›è¡Œå»é‡ï¼Œå› æ­¤å³ä¾¿è¿›è¡Œäº†å¤šæ¬¡é‡ç®—ï¼Œä½†æœ‰ä¸”ä»…æœ‰ä¸€æ¬¡é‡ç®—çš„ç»“æœè¢«è¾“å‡ºç»™ä¸‹æ¸¸ï¼ˆä¸‹æ¸¸ç®—å­æˆ–ç»“æœæ¥å—ç«¯ï¼‰ï¼Œä»æ•´ä½“ä¸Šæ¥çœ‹æ•°æ®æ˜¯æ»¡è¶³ä¸€è‡´æ€§çš„ï¼Œè¿™ä¹Ÿè¢«ç§°ä¹‹ä¸ºã€ŒEffective Determinismã€ã€‚

  

![å›¾ç‰‡](data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='1px' height='1px' viewBox='0 0 1 1' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg stroke='none' stroke-width='1' fill='none' fill-rule='evenodd' fill-opacity='0'%3E%3Cg transform='translate(-249.000000, -126.000000)' fill='%23FFFFFF'%3E%3Crect x='249' y='126' width='1' height='1'%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E)

  

MillWheel ä¼šå¯¹æ¯ä¸€æ¡è®°å½•èµ‹äºˆä¸€ä¸ªå”¯ä¸€ IDï¼ŒåŒæ—¶åŸºäºæ­¤ ID ç»´æŠ¤ä¸€ä»½æ˜¯å¦å¤„ç†è¿‡å½“å‰è®°å½•çš„ç›®å½•ã€‚å¯¹äºæ¯ä¸€æ¡æµå…¥å½“å‰ç®—å­çš„è®°å½•ï¼Œå¼•æ“æŸ¥æ‰¾æ­¤ ID ç›®å½•ä»¥ç¡®å®šæ­¤è®°å½•æ˜¯å¦æ˜¯å·²ç»å¤„ç†è¿‡ã€‚è¿™é‡Œä¼šæœ‰å¾ˆå¤šæŠ€æœ¯ä¸Šçš„æŒ‘æˆ˜ï¼Œè¿™é‡Œç¨å¾®ä¸¾å‡ ä¸ªä¾‹å­ã€‚

  

è­¬å¦‚ï¼Œéœ€è¦æœ‰ç¨³å®šä¸”é«˜ååçš„å­˜å‚¨åç«¯ç”¨äºç»“æœå­˜å‚¨ï¼ŒGoogle å†…éƒ¨çš„ BigTable å‘æŒ¥äº†å…¶ä½œç”¨ã€‚æµä»»åŠ¡æ‰§è¡Œå‰åï¼Œå¼•æ“ä¼šå¯¹æ‰§è¡Œæµåšè‹¥å¹²ä¼˜åŒ–ï¼Œå¦‚åˆå¹¶å¤šä¸ªé€»è¾‘ç®—å­è‡³å•ä¸ªç®—å­ï¼ˆç±»ä¼¼ Flink ä¸­çš„ chain åŒ–ï¼‰ã€èŠ‚ç‚¹å†…å…ˆæ‰§è¡Œéƒ¨åˆ†åˆå¹¶ï¼ˆcount / sumï¼‰åå† shuffleç­‰ç­‰ï¼Œç§ç§æ‰‹æ®µå‡æ˜¯ä¸ºäº†é™ä½ç®—å­é—´ IO çš„æ•°æ®è§„æ¨¡ã€‚

  

æ­¤å¤–ï¼Œåœ¨åˆ¤æ–­ã€Œå½“å‰è®°å½•ã€æ˜¯å¦å·²è¢«å¤„ç†æ—¶ï¼ŒMillWheel ä½¿ç”¨äº†å¸ƒéš†è¿‡æ»¤å™¨ç”¨äºå‰ç½®è¿‡æ»¤ï¼Œå› ä¸ºåœ¨ä¸€ä¸ªæ­£å¸¸è¿è¡Œçš„æµè®¡ç®—ä»»åŠ¡ä¸­ï¼Œè®°å½•ç»å¤§å¤šæ•°çš„æ—¶é—´éƒ½æ˜¯ä¸é‡å¤çš„ï¼Œè¿™åˆšå¥½å¥‘åˆå¸ƒéš†è¿‡æ»¤å™¨çš„ä½¿ç”¨åœºæ™¯ï¼ˆå¦‚è¿‡æ»¤å™¨è¿”å›ä¸å­˜åœ¨åˆ™è®°å½•ä¸€å®šä¸å­˜åœ¨ï¼‰ï¼Œå¼•æ“ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹éƒ½ç»´æŠ¤äº†ä»¥è®°å½• ID ä¸ºä¸»é”®çš„å¸ƒéš†è¿‡æ»¤å™¨ï¼Œè®¡ç®—å‰éƒ½ä¼šé€šè¿‡æ­¤è¿‡æ»¤å™¨è¿›è¡Œåˆ¤æ–­ï¼Œè‹¥æç¤ºä¸å­˜åœ¨åˆ™è¿›è¡Œæ•°æ®å¤„ç†ï¼Œå¦‚æœå­˜åœ¨ï¼Œåˆ™éœ€è¦äºŒæ¬¡æ ¡éªŒã€‚å½“ç„¶ï¼ŒMillWheel åœ¨å®é™…ä½¿ç”¨å¸ƒéš†è¿‡æ»¤å™¨ï¼Œæ˜¯åšäº†è‹¥å¹²æ”¹é€ çš„ï¼Œè¿™é‡Œå°±ä¸å…·ä½“å±•å¼€äº†ã€‚

  

### 2Â  ApacheÂ Flink

  

MillWheel ä½œä¸ºä¸€ä¸ªå†…éƒ¨ç³»ç»Ÿå¯ä»¥å­˜å‚¨æ¯ä¸€ä¸ªä¸­é—´ç»“æœï¼Œä½†æ˜¯å¯¹äºå¼€æºç³»ç»Ÿçš„ Apache Flink æ¥è¯´ï¼Œæ¯•ç«Ÿä¸æ˜¯æ¯ä¸€ä¸ªå…¬å¸éƒ½æœ‰è¿™ä¹ˆå®Œå¤‡çš„æŠ€æœ¯åŸºå»ºã€‚Flink ä¼šå®šæœŸæŠŠç»“æœä»¥äº‹åŠ¡çš„æ–¹å¼è¿›è¡Œæ‰¹é‡å­˜å‚¨ï¼Œè¿™é‡Œçš„ã€Œç»“æœã€å¦‚ä¸Šé¢åˆ†æï¼Œç”±æºçŠ¶æ€ SourceState(t)ã€ç®—å­çŠ¶æ€ OperatorState(t)Â ã€è¾“å‡ºçš„ç»“æœ Sink(t)Â ç»„æˆï¼Œå…¶ä¸­ Flink æŠŠæºçŠ¶æ€å’Œç®—å­çŠ¶æ€è¿›è¡Œäº†æ‰“åŒ…ï¼Œç»Ÿç§°ä¸ºã€Œåˆ†å¸ƒå¼ä¸€è‡´æ€§å¿«ç…§ã€ï¼ˆåŸºäº Chandy-Lamport åˆ†å¸ƒå¼å¿«ç…§ç®—æ³•æ¥å®ç°ï¼‰ï¼Œæ•°æ®ä¼šæŒä¹…åŒ–åœ¨ RocksDB ä¸­ã€‚

  

![å›¾ç‰‡](data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='1px' height='1px' viewBox='0 0 1 1' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg stroke='none' stroke-width='1' fill='none' fill-rule='evenodd' fill-opacity='0'%3E%3Cg transform='translate(-249.000000, -126.000000)' fill='%23FFFFFF'%3E%3Crect x='249' y='126' width='1' height='1'%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E)

  

å¦‚ä¸Šå›¾æ‰€ç¤ºï¼ŒFlink å¼•æ“ä¼šå®šæ—¶ï¼ˆæ¯ä¸ªå‘¨æœŸç§°ä¹‹ä¸ºä¸€ä¸ª epochï¼‰ä»¥ 2PC çš„æ–¹å¼æäº¤ç»“æœã€‚äº‹å®ä¸Šï¼Œå³ä¾¿ä¸è€ƒè™‘ç»“æœè¾“å‡ºï¼ŒFlink ã€Œåˆ†å¸ƒå¼ä¸€è‡´æ€§å¿«ç…§ã€çš„å¿«ç…§çš„å®ç°ä¹Ÿæ˜¯ä¸€ä¸ª 2PC çš„è¿‡ç¨‹ï¼šç®—å­çš„çŠ¶æ€å¿«ç…§å­˜å‚¨ç±»ä¼¼äº 2PC çš„ Prepare é˜¶æ®µï¼Œä½† Commit çš„ç¡®è®¤ä»…éœ€ Coordinatorï¼ˆ Flink JobManagerï¼‰Â æ ¹æ®ã€Œæ˜¯å¦æ”¶åˆ°äº†å®Œæ•´ç®—å­çš„ ACK ã€æ¥æ¨å‡ºæ˜¯å¦ Commit æˆ– Abortã€‚å°†ç»“æœè¾“å‡ºçº³å…¥å¿«ç…§ç”Ÿæˆçš„ 2PC åï¼Œç«¯åˆ°ç«¯ä¸€è‡´æ€§æ•°æ®å¤„ç†è¯­ä¹‰çš„å……åˆ†å¿…è¦æ¡ä»¶åœ¨è¿™é‡Œä¹Ÿå¾—åˆ°äº†æ»¡è¶³ï¼šåœ¨æµè®¡ç®—è¿‡ç¨‹ä¸­ï¼Œå®šæœŸï¼ˆepochï¼‰ä»¥äº‹åŠ¡ï¼ˆ2PCï¼‰çš„æ–¹å¼è¿›è¡Œæ‰¹é‡å­˜å‚¨ç»“æœï¼ˆåˆ†å¸ƒå¼ä¸€è‡´æ€§å¿«ç…§Â +Â å†™å¤–éƒ¨å­˜å‚¨ï¼‰ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äº Flink ä¼šä»¥ epoch ä¸ºå‘¨æœŸè¾“å‡ºç»“æœï¼Œå› æ­¤åŸºäºæ­¤æ„å»ºçš„æµå¤„ç†ç³»ç»Ÿä¼šå­˜åœ¨ä¸€å®šçš„ç«¯åˆ°ç«¯å»¶è¿Ÿã€‚

  

### 3Â  ApacheÂ KafkaÂ Streams

  

Kafka Streams æ˜¯ Apache Kafka 0.10.0ç‰ˆæœ¬ä¸­åŒ…å«çš„ä¸€ä¸ªJavaåº“ï¼Œä¸¥æ ¼æ¥è®²å¹¶ä¸ç®—ä¸€ä¸ªå®Œæ•´çš„æµå¤„ç†å¼•æ“ï¼Œåˆ©ç”¨è¿™ä¸ªåº“ï¼Œç”¨æˆ·å¯ä»¥åŸºäº Kafka æ„å»ºæœ‰çŠ¶æ€çš„å®æ—¶æ•°æ®å¤„ç†åº”ç”¨ï¼Œæ›´è¿›ä¸€æ­¥åœ°ï¼ŒKafka Streams éœ€è¦æ•°æ®è¾“å…¥æºå’Œè¾“å‡ºå‡ä¸º Kafka æ¶ˆæ¯é˜Ÿåˆ—ã€‚

  

Kafka Streams ä¸­çš„ã€Œç»“æœã€ä¹Ÿä»¥äº‹åŠ¡çš„æ–¹å¼æ‰¹é‡æŒä¹…åŒ–ï¼Œä½†å’Œ Flink ä¸åŒçš„æ˜¯ï¼Œè¿™äº›ç»“æœæ˜¯è¢«å†™å…¥ä¸åŒçš„æ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼š

  

1. æºçŠ¶æ€ SourceState(t)ï¼šå³ Kafka æºä¸­çš„ Offset ä¿¡æ¯ï¼Œä¼šè¢«å†™å…¥ä¸€ä¸ªå•ç‹¬çš„ Kafaka é˜Ÿåˆ—ä¸­ï¼Œè¯¥é˜Ÿåˆ—å¯¹ç”¨æˆ·é€æ˜ï¼›
    
      
    
2. ç®—å­çŠ¶æ€ OperatorState(t)Â ï¼šè®¡ç®—ä¸­ç®—å­çš„ Changelogï¼Œä¹Ÿä¼šå†™å…¥å•ç‹¬çš„ Kafaka é˜Ÿåˆ—ä¸­ï¼Œè¯¥é˜Ÿåˆ—å¯¹ç”¨æˆ·é€æ˜ï¼›
    
      
    
3. è¾“å‡ºç»“æœ Sink(t)Â ï¼šå³ç”¨æˆ·é…ç½®çš„å®é™…çš„è¾“å‡ºé˜Ÿåˆ—ï¼Œç”¨äºå­˜æ”¾è®¡ç®—ç»“æœã€‚
    

  

Kafka Streams å°†ä¸Šè¿°ç»“æœå®šæœŸä»¥äº‹åŠ¡çš„æ–¹å¼è¿›è¡Œæ‰¹é‡å­˜å‚¨ï¼Œä¸Šè¿°äº‹åŠ¡åœ¨ Kafka è¿™è¢«ç§°ä¹‹ä¸º Transactions APIï¼Œä½¿ç”¨è¿™ä¸ª API æ„å»ºçš„æµå¤„ç†åº”ç”¨ï¼Œå¯ä»¥åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­å°†å¤šä¸ªä¸»é¢˜æ¶ˆæ¯è¿›è¡ŒåŒæ—¶æäº¤ï¼Œå¦‚æœäº‹åŠ¡ç»ˆæ­¢æˆ–å›æ»šï¼Œåˆ™ä¸‹æ¸¸æ¶ˆè´¹ä¸ä¼šè¯»å–åˆ°ç›¸åº”çš„ç»“æœï¼ˆå½“ç„¶ä¸‹æ¸¸æ¶ˆè´¹è€…ä¹Ÿéœ€è¦é…ç½®ç›¸åº”çš„ä¸€è‡´æ€§çº§åˆ«ï¼‰ï¼Œå…¶è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

  

![å›¾ç‰‡](data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='1px' height='1px' viewBox='0 0 1 1' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg stroke='none' stroke-width='1' fill='none' fill-rule='evenodd' fill-opacity='0'%3E%3Cg transform='translate(-249.000000, -126.000000)' fill='%23FFFFFF'%3E%3Crect x='249' y='126' width='1' height='1'%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E)

  

å¦‚æœç¨å¾®å›é¡¾ä¸€ä¸‹ Flink ä¸€è‡´æ€§çš„å®ç°é€»è¾‘ï¼Œä¼šå‘ç°è¿™ä¸¤è€…æœ‰å¾ˆå¤šç›¸ä¼¼ç‚¹ï¼Œå› æ­¤ Kafka Streams çš„è¾“å‡ºç»“æœä¹Ÿä¼šå­˜åœ¨ä¸€å®šçš„ç«¯åˆ°ç«¯å»¶è¿Ÿã€‚å› ä¸ºåœ¨æäº¤ç»“æœæ—¶åˆ›å»ºäº†æ–°çš„äº‹åŠ¡ï¼Œæ‰€ä»¥å¹³å‡äº‹åŠ¡å¤§å°ç”±æäº¤é—´éš”ç¡®å®šï¼Œå½“æµé‡ç›¸åŒæ—¶ï¼Œè¾ƒçŸ­çš„æäº¤é—´éš”å°†å¯¼è‡´è¾ƒå°çš„äº‹åŠ¡ï¼Œä½†å¤ªå°çš„é—´éš”å°†å¯¼è‡´ååä¸‹é™ï¼Œå› æ­¤ååé‡ä¸ç«¯åˆ°ç«¯å¤„ç†å»¶è¿Ÿä¹‹é—´éœ€è¦æœ‰ä¸€ä¸ªæŠ˜è¡·ã€‚

  

åŒæ—¶ï¼Œæˆ‘ä»¬éœ€è¦æ³¨æ„åˆ°çš„æ˜¯ï¼ŒFlink å’Œ Kafaka ä¸­çš„ã€Œäº‹åŠ¡ã€æäº¤ï¼Œå’Œæˆ‘ä»¬å¸¸è§„çš„æ“ä½œå…³ç³»å‹æ•°æ®åº“ä¸­çš„äº‹åŠ¡è¿˜æ˜¯æœ‰æ‰€ä¸åŒçš„ï¼Œåè€…çš„äº‹åŠ¡æäº¤å¯¹è±¡ä¸€èˆ¬å°±ä¸€ä¸ªï¼ˆe.g. MySQL Serverï¼‰ï¼Œä½†åœ¨æµè®¡ç®—ä¸­ï¼Œç”±äºç»“æœæœ‰ä¸‹æ¸¸è¾“å‡ºã€æ¶ˆè´¹è¿›åº¦ã€ç®—å­çŠ¶æ€ç­‰ï¼Œå› æ­¤æµè®¡ç®—å¼•æ“éœ€è¦è®¾è®¡ä¸€ä¸ªå…¨å±€çš„äº‹åŠ¡åè®®ç”¨äºå’Œä¸‹æ¸¸å¾…æäº¤çš„å„ä¸ªå­˜å‚¨åç«¯è¿›è¡Œäº¤äº’ã€‚ä¸¾ä¾‹ï¼šKafka Streams çš„è¾“å‡ºåç«¯éœ€è¦æ˜¯ Kafkaï¼Œä»¥é…åˆåœ¨äº‹åŠ¡æäº¤è¿‡ç¨‹ä¸­ï¼Œå±è”½éƒ¨åˆ†å·²è¾“å‡ºè‡³ä¸‹æ¸¸ï¼ˆè¢« Kafka Broker æŒä¹…åŒ–ï¼‰ï¼Œä½†è¿˜ä¸æ»¡è¶³äº‹åŠ¡éš”ç¦»æ€§çš„æ¶ˆæ¯ï¼ˆread_committed çº§åˆ«ï¼‰ï¼Œä»æµè®¡ç®—è¾“å‡ºçš„è§’åº¦æ¥çœ‹ï¼Œè¿™äº›æ¶ˆæ¯å·²è¢«æˆåŠŸå¤„ç†åŒæ—¶è¾“å‡ºè‡³ä¸‹æ¸¸ï¼Œä½†ä»ç«¯åˆ°ç«¯çš„ä¸€è‡´æ€§æ¥çœ‹ï¼Œå®ƒä»¬ä¾ç„¶å±äºä¸ä¸€è‡´çš„æ•°æ®ã€‚åˆå¦‚ï¼Œä½¿ç”¨ Flink å¤„ç† CDCï¼ˆChange Data Captureï¼‰Â çš„åœºæ™¯ï¼Œå¦‚æœä¸‹æ¸¸æ˜¯ MySQLï¼Œåœ¨ Flink 2PC å®Œæˆä¹‹å‰ï¼Œæ¥è‡ªä¸åŒ Flink èŠ‚ç‚¹çš„æ•°æ®è¾“å‡ºåå…¶å®å·²ç»è¢« commitï¼Œç±»ä¼¼ Kafka Broker ä¸­çš„æ¶ˆæ¯æ— æ³•æ’¤å›ï¼ŒMySQL æäº¤çš„äº‹åŠ¡ä¹Ÿæ— æ³•å›æ»šï¼Œå› æ­¤è¾“å‡ºæ•°æ®ä¸­ä¹Ÿéœ€è¦æœ‰ç±»ä¼¼çš„å­—æ®µå®ç°éš”ç¦»ï¼ˆisolationï¼‰è¯­ä¹‰ï¼Œä»¥å±è”½è¿™ç§ä¸ä¸€è‡´çš„æ•°æ®ã€‚

  

### 4Â  ApacheÂ SparkÂ Streaming

  

è¿™é‡Œæåˆ°çš„ Spark Streaming æŒ‡çš„æ˜¯åŸå§‹çš„åŸºäºã€ŒMicro-batchï¼Œå¾®æ‰¹ã€çš„ Spark æµå¤„ç†å¼•æ“ï¼Œåé¢ Spark åˆæå‡ºäº†Structured Streamingï¼Œä½¿ç”¨ Continuous Processing mode æ¥æ›¿ä»£ã€Œå¾®æ‰¹ã€è§£å†³å»¶è¿Ÿçš„é—®é¢˜ï¼Œå®¹é”™æœºåˆ¶ä¸Šå’Œ Flink ä¸€æ ·ä¹Ÿä½¿ç”¨äº†Chandy-Lamport ç®—æ³•ï¼ŒStructured Stream ç›®å‰è¿˜ä¸æˆç†Ÿï¼Œæš‚æ—¶è¿˜ä¸èƒ½å®Œå…¨æ”¯æŒ Exactly-Once-Processingï¼Œå› æ­¤è¿™é‡Œç€é‡å¯¹æ¯” Spark Streamingã€‚

  

Spark Streaming åªèƒ½ä¿è¯å¼•æ“å†…éƒ¨çš„å¤„ç†é€»è¾‘æ˜¯ä¸€è‡´çš„ï¼Œä½†æ˜¯å¯¹äºç»“æœè¾“å‡ºï¼Œåˆ™å¹¶æ²¡æœ‰åšç‰¹åˆ«çš„æŠ½è±¡ï¼Œå› æ­¤å¦‚æœæˆ‘ä»¬å¸Œæœ›å®ç°ç«¯åˆ°ç«¯çš„ä¸€è‡´æ€§è¯­ä¹‰ï¼Œåˆ™éœ€è¦å¯¹è‡ªè¡Œç»´æŠ¤å’Œåˆ¤æ–­ä¸€äº›ä¿¡æ¯ã€‚åŒä¼ ç»Ÿçš„æ‰¹å¤„ç†ç³»ç»Ÿç±»ä¼¼ï¼Œæµå¤„ç†ä¸­ä¹Ÿæ˜¯ä»¥ RDD æ„å»ºå‡ºæ•´ä¸ªçš„æ•°æ®è¡€ç¼˜ï¼Œå½“å‘ç”Ÿ FailOver æ—¶ï¼Œåˆ™é‡æ–°è®¡ç®—æ•´ä¸ª RDD å°±å¯ä»¥äº†ã€‚å¦‚æœ Spark Streaming å­˜åœ¨éç¡®å®šæ€§çš„è®¡ç®—ï¼Œåˆ™ä¸èƒ½å®ç°ç«¯åˆ°ç«¯ä¸€è‡´ï¼ŒåŸå› æ˜¯ï¼š1ã€ä¸æ»¡è¶³æ¡ä»¶ä¸€ã€Œå®æ—¶å­˜å‚¨æ¯ä¸€æ¡ç»“æœã€ã€‚å¦‚æœèƒ½è®°å½•ä¸‹æ¯ä¸ª RDD åˆ†åŒºä¸‹çš„æ‰§è¡Œæƒ…å†µï¼Œé¿å…é‡å¤æ‰§è¡Œï¼ˆå¹‚ç­‰ï¼‰ï¼Œä¹Ÿä¸€å®šç¨‹åº¦ä¸Šèƒ½å®ç°ç«¯åˆ°ç«¯ä¸€è‡´ï¼Œä½†è¿™éœ€è¦è¿›è¡Œå¤§é‡çš„æ”¹é€ å·¥ä½œï¼Œæœ€ç»ˆå½¢æ€ä¼šå’Œ MillWheel æ¯”è¾ƒç±»ä¼¼ï¼›2ã€ä¸æ»¡è¶³æ¡ä»¶äºŒã€Œäº‹åŠ¡æ–¹å¼å­˜å‚¨ã€ï¼Œéœ€è¦ä¿è¯æ¯ä¸ª RDD äº§å‡ºç¯èŠ‚çš„äº‹åŠ¡æ€§ï¼ˆå¦‚æœ€ç»ˆç»“æœå†™ HDFS å°±ä¸æ˜¯åŸå­çš„ï¼‰ã€‚

  

è€ƒè™‘ä¸€ç§æ¯”è¾ƒç®€å•çš„åœºæ™¯ï¼šä¸å­˜åœ¨éç¡®å®šè®¡ç®—çš„æµè®¡ç®—åº”ç”¨ã€‚å¦‚æœä¸å­˜åœ¨éç¡®å®šè®¡ç®—ï¼Œæ ¹æ®ç«¯åˆ°ç«¯çš„ä¸€è‡´æ€§è¯­ä¹‰çš„å……åˆ†å¿…è¦æ¡ä»¶ï¼Œåªéœ€è¦æ¥å—ç«¯å®ç°å¹‚ç­‰ï¼Œåˆ™ Spark Streaming å°±å¯ä»¥å®ç°ç«¯åˆ°ç«¯çš„ä¸€è‡´æ€§ã€‚èƒŒåçš„åŸå› æ˜¯ï¼Œå½“å°†å½¢å¼åŒ–çš„ç»“æœå®šä¹‰ä¸ Spark Streaming è¿›è¡Œæ˜ å°„ï¼Œä¼šå‘ç°å½“ä»¥ã€Œå¾®æ‰¹ã€çš„å½¢å¼å­˜å‚¨ç»“æœæ—¶ï¼ŒæºçŠ¶æ€å’Œç®—å­çŠ¶æ€ä»¥ RDD è¡€ç¼˜çš„æ–¹å¼å¤©ç„¶åœ°å’Œè¾“å‡ºç»“æœè¿›è¡Œäº†ç»‘å®šï¼Œå³å½“è¾“å‡ºæœ€ç»ˆç»“æœæ—¶ï¼Œæˆ‘ä»¬å…¶å®ä¹Ÿä¸€å¹¶è¾“å‡ºäº†æºå’Œç®—å­çŠ¶æ€ï¼Œæ“ä½œç¬¦åˆä¸€è‡´æ€§æ¡ä»¶ã€‚

  

![å›¾ç‰‡](data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='1px' height='1px' viewBox='0 0 1 1' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg stroke='none' stroke-width='1' fill='none' fill-rule='evenodd' fill-opacity='0'%3E%3Cg transform='translate(-249.000000, -126.000000)' fill='%23FFFFFF'%3E%3Crect x='249' y='126' width='1' height='1'%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E)

  

æ›´è¿›ä¸€æ­¥ï¼Œå½“æŠŠä»…æœ‰ç¡®å®šæ€§è®¡ç®—ï¼ˆå¹‚ç­‰è¾“å‡ºï¼‰çš„ Spark Streaming å’ŒÂ ä»…æœ‰ç¡®å®šæ€§è®¡ç®—ï¼ˆå¹‚ç­‰è¾“å‡ºï¼‰çš„çš„ Flink è¿›è¡Œå¯¹æ¯”æ—¶ï¼Œä¼šå‘ç°äºŒè€…éå¸¸ç›¸ä¼¼ã€‚RDD è¡€ç¼˜ç±»æ¯”åˆ†å¸ƒå¼ä¸€è‡´æ€§å¿«ç…§ï¼Œæ‰¹é‡è¾“å‡ºç±»æ¯”ä¸€è‡´æ€§å¿«ç…§åçš„ç»“æœè¾“å‡ºï¼Œå¾®æ‰¹ç±»æ¯” epochã€‚ä¸åŒä¹‹å¤„åœ¨äºï¼š1ã€Spark Streaming åœ¨è®¡ç®—è¿‡ç¨‹ä¸­çš„æ¯ä¸€ä¸ª RDD ç”Ÿæˆé˜¶æ®µéƒ½ä¼šæœ‰å»¶è¿Ÿï¼Œè€Œ Flink åœ¨è®¡ç®—è¿‡ç¨‹ä¸­å¯ä»¥è¿›è¡Œå®æ—¶å¤„ç†ï¼›2ã€Spark Streaming åªæœ‰ä¸€ä¸ªã€Œepochã€ï¼Œè€Œ Flink å¯ä»¥æœ‰å¤šä¸ªÂ ã€Œepochã€å¹¶è¡Œå­˜åœ¨ã€‚åŸºäºä¸Šè¿°ä¸¤ç‚¹åŸå› ï¼ŒFlink çš„æ•°æ®å¤„ç†çš„ç«¯åˆ°ç«¯å»¶è¿Ÿè¦å°å¾—å¤šï¼Œä½†è¿™ä¸¤ç§å¼•æ“å¹‚ç­‰è¾“å‡ºèƒ½å®ç°ä¸€è‡´æ€§çš„æœ¬è´¨æ˜¯ç›¸ä¼¼çš„ã€‚

  

### 5Â  å„å¼•æ“ä¸€è‡´æ€§å®ç°æ€»ç»“

  

ä¸Šé¢æˆ‘ä»¬ç®€è¿°äº†ç›®å‰ä¸»æµçš„å‡ ç§æµè®¡ç®—å¼•æ“çš„ä¸€è‡´æ€§å®ç°æœºåˆ¶ã€‚ä»æ•´ä½“æ¥çœ‹ï¼Œå¦‚æœå®ç°ç«¯åˆ°ç«¯çš„ä¸€è‡´æ€§ï¼Œåˆ™å‡éœ€è¦æ»¡è¶³æˆ‘ä»¬ä¸Šé¢ä»å½¢å¼åŒ–å®šä¹‰æ¨å¯¼å‡ºæ¥çš„å……åˆ†å¿…è¦æ¡ä»¶ï¼šå®æ—¶å­˜å‚¨æ¯ä¸€æ¡ä¸­é—´å’Œæœ€ç»ˆè®¡ç®—ç»“æœï¼Œå¦‚æœè€ƒè™‘ååç‡ä¸èƒ½å­˜å‚¨æ¯ä¸€æ¡ï¼Œåˆ™éœ€å®šæœŸä»¥äº‹åŠ¡çš„æ–¹å¼è¿›è¡Œæ‰¹é‡å­˜å‚¨ï¼Œè¿™é‡Œçš„ç»“æœåŒ…å«æµè®¡ç®—å¼•æ“ä¸­çš„çŠ¶æ€ã€‚ä¸Šé¢çš„å……åˆ†å¿…è¦æ¡ä»¶è¿˜å¯ä»¥è¿›ä¸€æ­¥ç®€åŒ–ï¼Œå³å®æ—¶å­˜å‚¨ç»“æœæˆ–å®šæœŸäº‹åŠ¡ï¼Œå‡å¯ä»¥è§†ä¸ºå½“å‰å¤„ç†é€»è¾‘å•å…ƒï¼ˆç®—å­æˆ–æœ€ç»ˆå­˜å‚¨ï¼‰å¯¹ä¸Šæ¸¸çš„è¾“å…¥ï¼ˆå¼•æ“çŠ¶æ€+è¾“å‡ºç»“æœï¼‰è¿›è¡Œçš„å¹‚ç­‰åŒ–å¤„ç†ï¼šå¼•æ“ FailOver Â ->Â è¾“å…¥æºçš„äº‹ä»¶ä¼šè¿›è¡Œé‡å‘Â ->Â å‰æœŸå­˜å‚¨çš„ç»“æœä¼šç”¨äºå»é‡/äº‹åŠ¡å›æ»šè®©ç»“æœï¼ˆå¼•æ“çŠ¶æ€+è¾“å‡ºç»“æœï¼‰å›åˆ°ä¸Šä¸€æ¬¡çš„ä¸€è‡´æ€§çŠ¶æ€Â ->Â ä¸‹ä¸€æ‰¹ç»“æœè¾“å‡ºÂ ->Â ç»“æœæ¥å—ç«¯åªå½±å“ä¸€æ¬¡Â ->Â å®ç°äº†ç«¯åˆ°ç«¯çš„ä¸€è‡´ã€‚

  

ä¸‹é¢çš„å›¾åˆ—ä¸¾å‡ºå„å¼•æ“å®ç°ç«¯åˆ°ç«¯ä¸€è‡´æ€§çš„è·¯çº¿å›¾ï¼š

  

![å›¾ç‰‡](data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='1px' height='1px' viewBox='0 0 1 1' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg stroke='none' stroke-width='1' fill='none' fill-rule='evenodd' fill-opacity='0'%3E%3Cg transform='translate(-249.000000, -126.000000)' fill='%23FFFFFF'%3E%3Crect x='249' y='126' width='1' height='1'%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E)

  

å‰é¢åˆ†æç«¯åˆ°ç«¯ä¸€è‡´æ€§çš„å®ç°ä¸­ï¼Œé‡ç‚¹åœ¨åˆ†æå¼•æ“å¤„ç†ï¼ˆç®—å­ï¼‰å’Œè¾“å‡ºç«¯è¡Œä¸ºï¼Œæ²¡æœ‰æåŠå¯¹æ•°æ®æºçš„è¦æ±‚ï¼Œæ•°æ®æºéœ€å…·å¤‡é‡æ’­ï¼ˆrepalyï¼‰å’Œæ¶ˆæ¯å»é‡çš„åŠŸèƒ½å³å¯ï¼Œå±äºåŸºç¡€è¦æ±‚ï¼Œè¿™é‡Œä¸å†å±•å¼€ã€‚

  

## **äº”Â  æ€»ç»“ä¸å±•æœ›**

æœ¬æ–‡ä»æµè®¡ç®—çš„æœ¬è´¨å‡ºå‘ï¼Œæ¨å¯¼å‡ºäº†åœ¨æµå¤„ç†ä¸­å®ç°ç«¯åˆ°ç«¯ä¸€è‡´æ€§çš„é€šç”¨è§£æ³•ï¼ŒåŒæ—¶ç»“åˆé€šç”¨è§£æ³•ï¼Œåˆ†æäº†ç›®å‰å‡ ç§ä¸»æµæµè®¡ç®—å¼•æ“åœ¨ä¸€è‡´æ€§ä¸Šçš„å®ç°æ€è·¯ã€‚æœ‰ã€Œè´¢å¤§æ°”ç²—ã€å‹çš„ Google MillWheelï¼ŒèƒŒé å¼ºå¤§çš„åŸºç¡€æ¶æ„ç”¨äºçŠ¶æ€ç®¡ç†ï¼›æœ‰ã€Œå¿ƒçµæ‰‹å·§ã€å‹çš„ Apache Flinkï¼Œå·§å¦™åœ°ç»“åˆäº†åˆ†å¸ƒå¼ä¸€è‡´æ€§å¿«ç…§å’Œä¸¤é˜¶æ®µäº‹åŠ¡å®ç°ä¸€è‡´æ€§ï¼›ä¹Ÿæœ‰ã€Œé‡å‰‘æ— é”‹ã€å‹çš„ Apache Kafka Streamsï¼Œç›´æ¥å°†æµå¤„ç†è¿‡ç¨‹äº‹åŠ¡åŒ–ï¼Œå±è”½å¤æ‚çš„åº•å±‚é€»è¾‘ï¼Œç¼–ç¨‹æ¨¡å‹å’Œç†è§£æˆæœ¬éƒ½æ›´ç®€å•ï¼ˆå½“ç„¶ä¹Ÿä¸€å®šç¨‹åº¦ä¸Šé™åˆ¶å…¶ä½¿ç”¨çš„åœºæ™¯ï¼‰ï¼›ä¹Ÿæœ‰Â ã€Œè“¬å‹ƒå‘å±•ã€ä¸­çš„ Apache Spark ï¼ˆStructuredï¼‰Streamingï¼Œåº•å±‚çš„ä¸€äº›å®ç°æ„æƒ³å’Œ Apache Flink æ„ˆåŠ è¶‹åŒï¼Œå¯ä»¥æœŸå¾…å®ƒå°†æ¥èƒ½è¾¾åˆ°ç±»ä¼¼ Apache Spark åœ¨æ‰¹å¤„ç†æµåŸŸä¸­çš„åœ°ä½ã€‚

  

å½“ç„¶ï¼Œå¼•æ“è™½ç„¶è¿™ä¹ˆå¤šï¼Œä½†å…¶èƒŒåæ˜¯æœ‰è‹¥å¹²æ¡ä¸»çº¿è´¯ç©¿çš„ï¼Œå¸Œæœ›æˆ‘ä»¬èƒ½æ‹¨å¼€è¿·é›¾ï¼Œä¸è¢«è¥é”€çš„å™±å¤´æ‰€å½±å“ï¼Œèƒ½æ´å¯Ÿåˆ°ä¸€äº›æ›´ä¸ºæœ¬è´¨çš„ä¸œè¥¿ã€‚æœ¬æ–‡è®ºè¿°çš„ç«¯åˆ°ç«¯ä¸€è‡´çš„æµæ•°æ®å¤„ç†å®ç°ï¼Œé‡ç‚¹èšç„¦åœ¨ã€Œè®¡ç®—å’ŒçŠ¶æ€ã€ç®¡ç†ï¼Œä½†å®é™…ä¸Šï¼Œè¿˜æœ‰å¾ˆå¤šå› ç´ éœ€è¦æˆ‘ä»¬å»è€ƒè™‘ï¼Œå¦‚æ—¶é—´çª—å£çš„æ¨å¯¼ã€å»¶è¿Ÿæ•°æ®çš„å¤„ç†ç­–ç•¥ã€åº•å±‚è®¡ç®—èŠ‚ç‚¹çš„é€šä¿¡å®¹é”™ç­‰ï¼Œè¿™äº›é—®é¢˜å¤šå¤šå°‘å°‘ä¹Ÿä¼šå½±å“æ•°æ®çš„ä¸€è‡´æ€§ï¼Œè€ƒè™‘åˆ°æ–‡ä¸­ç¯‡å¹…ï¼Œè¿™é‡Œå°±ä¸ä¸€ä¸€å±•å¼€äº†ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥é€‰æ‹©ä¸€ä¸ªä¸»é¢˜åšæ·±å…¥ç ”ç©¶ã€‚

  

ä¸‹é¢è¿™äº›è®ºæ–‡å¯¹è¿›ä¸€æ­¥äº†è§£æµè®¡ç®—å¾ˆæœ‰å¸®åŠ©ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥å‚è€ƒï¼š

  

1. ã€ŠStreamingÂ Systemã€‹ï¼ŒTÂ Akidau,Â SÂ Chernyak,Â RÂ Lax
    
2. ã€ŠTransactionsÂ inÂ ApacheÂ Kafkaã€‹ï¼ŒApurvaÂ Mehtaï¼ŒJasonÂ Gustafson
    
3. ã€ŠAÂ SurveyÂ ofÂ StateÂ ManagementÂ inÂ BigÂ DataÂ ProcessingÂ Systemsã€‹ï¼ŒQCÂ To,Â JÂ Soto,Â VÂ Markl
    
4. ã€ŠMillWheel:Â fault-tolerantÂ streamÂ processingÂ atÂ InternetÂ scaleã€‹ï¼ŒTÂ Akidau,Â AÂ Balikov,Â KÂ BekiroÄŸlu,Â SÂ Chernyak
    
5. ã€ŠDiscretizedÂ Streams:Â Fault-TolerantÂ StreamingÂ ComputationÂ atÂ Scaleã€‹ï¼ŒMÂ Zaharia,Â TÂ Das,Â HÂ Li,Â TÂ Hunter
    

  

---

  

**ã€Šç©è½¬ Tablestore å…¥é—¨ä¸å®æˆ˜ã€‹é‡ç£…æ¥è¢­ï¼æ¶æ„ã€åŸç†åŠåœºæ™¯å…¨æ–¹é¢è§£è¯»**

  

é˜¿é‡Œäº‘åŸºç¡€äº§å“äº‹ä¸šéƒ¨Tablestoreå›¢é˜Ÿè”åˆé˜¿é‡Œäº‘å¼€å‘è€…ç¤¾åŒºã€Šç©è½¬ Tablestore å…¥é—¨ä¸å®æˆ˜ã€‹é‡ç£…æ¥è¢­ï¼466é¡µæŠ€æœ¯å¹²è´§ï¼Œåˆ†äº«é˜¿é‡Œå†…éƒ¨åŸºäº Tablestore çš„ä¼˜ç§€æ¶æ„è®¾è®¡ç»éªŒå’Œå…¸å‹åº”ç”¨åœºæ™¯ï¼Œå¸¦ä½ æ­å¼€Tablestore çš„ç¥ç§˜é¢çº±ï¼

  

ç‚¹å‡»é˜…è¯»åŸæ–‡æŸ¥çœ‹è¯¦æƒ…ï½

  

åˆ†å¸ƒå¼ç³»ç»Ÿ3

æ¶æ„51

æµè®¡ç®—3

åˆ†å¸ƒå¼ç³»ç»Ÿ Â· ç›®å½•

ä¸Šä¸€ç¯‡Joint Consensusä¸¤é˜¶æ®µæˆå‘˜å˜æ›´çš„å•æ­¥å®ç°ä¸‹ä¸€ç¯‡åˆ†å¸ƒå¼ç³»ç»Ÿä¸€è‡´æ€§æµ‹è¯•æ¡†æ¶Jepsenåœ¨å¥³å¨²çš„å®è·µåº”ç”¨

é˜…è¯»åŸæ–‡

é˜…è¯»Â 1.1ä¸‡

ä¿®æ”¹äº2021å¹´10æœˆ14æ—¥

â€‹

å†™ç•™è¨€

**ç•™è¨€ 12**

- å¯»å¸¸
    
    2021å¹´10æœˆ13æ—¥
    
    èµ6
    
    çœ‹è¿‡çš„æµè®¡ç®—åˆ†æçš„æœ€é€å½»çš„åŸæ–‡ç« äº†ï¼Œæ„Ÿè°¢![[ç«ç‘°]](https://res.wx.qq.com/mpres/zh_CN/htmledition/comm_htmledition/images/pic/common/pic_blank.gif)
    
- ç´«æœˆä¸‹çš„åŸé‡
    
    2021å¹´10æœˆ13æ—¥
    
    èµ5
    
    ç‰›é€¼çš„å¾ˆå•Š
    
- Kong
    
    2021å¹´10æœˆ13æ—¥
    
    èµ4
    
    æ‚¨å¥½æƒ³é—®ä¸€ä¸‹ï¼ŒF(E(t), Sink(t), State(t)) = Sink(t+1) + State(t)è¿™ä¸ªç­‰å¼çš„å³è¾¹çš„ State(t)ä¸ä¼šæ›´æ–°æˆState(t+1)ä¹ˆï¼Ÿè¿˜æœ‰è¿™ä¸ª---å½“åœ¨æ•…éšœå‘ç”Ÿçš„æ—¶é—´å°äº t ï¼ˆæ•°æ®æ²¡æœ‰è¾“å‡ºï¼‰ï¼Œè¿™ä¸ªæ˜¯æ•°æ®æ²¡æœ‰è¾“å‡ºè¿˜æ˜¯æ•°æ®æ²¡æœ‰è¾“å…¥![ğŸ˜‚](https://res.wx.qq.com/mpres/zh_CN/htmledition/comm_htmledition/images/pic/common/pic_blank.gif)æœ‰ç‚¹æƒ³ä¸æ˜ç™½
    
- Gaos
    
    2021å¹´10æœˆ13æ—¥
    
    èµ3
    
    1æ¥¼
    
- Jungle
    
    2021å¹´10æœˆ13æ—¥
    
    èµ3
    
    å€¼å¾—æ€è€ƒ
    
- ä¸€ç”Ÿå¹³å®‰
    
    2021å¹´10æœˆ17æ—¥
    
    èµ2
    
    ğŸ‘ğŸ‘ğŸ‘
    
- å°æ…§
    
    2021å¹´10æœˆ17æ—¥
    
    èµ2
    
    å‰å®³å‰å®³
    
- é¡ºå…¶è‡ªç„¶
    
    2021å¹´10æœˆ17æ—¥
    
    èµ2
    
    ![[å¼º]](https://res.wx.qq.com/mpres/zh_CN/htmledition/comm_htmledition/images/pic/common/pic_blank.gif)![[å¼º]](https://res.wx.qq.com/mpres/zh_CN/htmledition/comm_htmledition/images/pic/common/pic_blank.gif)![[å¼º]](https://res.wx.qq.com/mpres/zh_CN/htmledition/comm_htmledition/images/pic/common/pic_blank.gif)
    
- ç‹å°é’
    
    2021å¹´10æœˆ14æ—¥
    
    èµ2
    
    å°±æ˜¯ç‰›![[å¼º]](https://res.wx.qq.com/mpres/zh_CN/htmledition/comm_htmledition/images/pic/common/pic_blank.gif)![[å¼º]](https://res.wx.qq.com/mpres/zh_CN/htmledition/comm_htmledition/images/pic/common/pic_blank.gif)![[å¼º]](https://res.wx.qq.com/mpres/zh_CN/htmledition/comm_htmledition/images/pic/common/pic_blank.gif)
    
- æå…ˆæ˜¥
    
    2021å¹´10æœˆ14æ—¥
    
    èµ2
    
    å†™å¥½![[å¼º]](https://res.wx.qq.com/mpres/zh_CN/htmledition/comm_htmledition/images/pic/common/pic_blank.gif)
    
- å›è¡Œå¥
    
    2021å¹´10æœˆ14æ—¥
    
    èµ2
    
    å¼•æ“åœ¨FailOveråï¼Œéœ€å¤šæ¬¡æ‰§è¡Œæ¢å¤å‡½æ•°Â R()ï¼Œç›´åˆ°æœ€åä¸€æ¬¡æ‰ç»“æŸã€‚åœ¨å¤§æ•°æ®é‡æƒ…å†µä¸‹ï¼Œæ˜¯å¦‚ä½•ä¿è¯æ‰§è¡Œæ•ˆç‡çš„ã€‚
    
- å¾®å­
    
    2021å¹´10æœˆ13æ—¥
    
    èµ2
    
    å‰å®³å‰å®³![[è€¶]](https://res.wx.qq.com/mpres/zh_CN/htmledition/comm_htmledition/images/pic/common/pic_blank.gif)![[è€¶]](https://res.wx.qq.com/mpres/zh_CN/htmledition/comm_htmledition/images/pic/common/pic_blank.gif)![[è€¶]](https://res.wx.qq.com/mpres/zh_CN/htmledition/comm_htmledition/images/pic/common/pic_blank.gif)![[è€¶]](https://res.wx.qq.com/mpres/zh_CN/htmledition/comm_htmledition/images/pic/common/pic_blank.gif)
    

å·²æ— æ›´å¤šæ•°æ®

[](javacript:;)

![](http://mmbiz.qpic.cn/mmbiz_png/Z6bicxIx5naI1jwOfnA1w4PL2LhwNia76vBRfzqaQVVVlqiaLjmWYQXHsn1FqBHhuGVcxEHjxE9tibBFBjcB352fhQ/300?wx_fmt=png&wxfrom=18)

é˜¿é‡Œäº‘å¼€å‘è€…

1911280

12

å†™ç•™è¨€

**ç•™è¨€ 12**

- å¯»å¸¸
    
    2021å¹´10æœˆ13æ—¥
    
    èµ6
    
    çœ‹è¿‡çš„æµè®¡ç®—åˆ†æçš„æœ€é€å½»çš„åŸæ–‡ç« äº†ï¼Œæ„Ÿè°¢![[ç«ç‘°]](https://res.wx.qq.com/mpres/zh_CN/htmledition/comm_htmledition/images/pic/common/pic_blank.gif)
    
- ç´«æœˆä¸‹çš„åŸé‡
    
    2021å¹´10æœˆ13æ—¥
    
    èµ5
    
    ç‰›é€¼çš„å¾ˆå•Š
    
- Kong
    
    2021å¹´10æœˆ13æ—¥
    
    èµ4
    
    æ‚¨å¥½æƒ³é—®ä¸€ä¸‹ï¼ŒF(E(t), Sink(t), State(t)) = Sink(t+1) + State(t)è¿™ä¸ªç­‰å¼çš„å³è¾¹çš„ State(t)ä¸ä¼šæ›´æ–°æˆState(t+1)ä¹ˆï¼Ÿè¿˜æœ‰è¿™ä¸ª---å½“åœ¨æ•…éšœå‘ç”Ÿçš„æ—¶é—´å°äº t ï¼ˆæ•°æ®æ²¡æœ‰è¾“å‡ºï¼‰ï¼Œè¿™ä¸ªæ˜¯æ•°æ®æ²¡æœ‰è¾“å‡ºè¿˜æ˜¯æ•°æ®æ²¡æœ‰è¾“å…¥![ğŸ˜‚](https://res.wx.qq.com/mpres/zh_CN/htmledition/comm_htmledition/images/pic/common/pic_blank.gif)æœ‰ç‚¹æƒ³ä¸æ˜ç™½
    
- Gaos
    
    2021å¹´10æœˆ13æ—¥
    
    èµ3
    
    1æ¥¼
    
- Jungle
    
    2021å¹´10æœˆ13æ—¥
    
    èµ3
    
    å€¼å¾—æ€è€ƒ
    
- ä¸€ç”Ÿå¹³å®‰
    
    2021å¹´10æœˆ17æ—¥
    
    èµ2
    
    ğŸ‘ğŸ‘ğŸ‘
    
- å°æ…§
    
    2021å¹´10æœˆ17æ—¥
    
    èµ2
    
    å‰å®³å‰å®³
    
- é¡ºå…¶è‡ªç„¶
    
    2021å¹´10æœˆ17æ—¥
    
    èµ2
    
    ![[å¼º]](https://res.wx.qq.com/mpres/zh_CN/htmledition/comm_htmledition/images/pic/common/pic_blank.gif)![[å¼º]](https://res.wx.qq.com/mpres/zh_CN/htmledition/comm_htmledition/images/pic/common/pic_blank.gif)![[å¼º]](https://res.wx.qq.com/mpres/zh_CN/htmledition/comm_htmledition/images/pic/common/pic_blank.gif)
    
- ç‹å°é’
    
    2021å¹´10æœˆ14æ—¥
    
    èµ2
    
    å°±æ˜¯ç‰›![[å¼º]](https://res.wx.qq.com/mpres/zh_CN/htmledition/comm_htmledition/images/pic/common/pic_blank.gif)![[å¼º]](https://res.wx.qq.com/mpres/zh_CN/htmledition/comm_htmledition/images/pic/common/pic_blank.gif)![[å¼º]](https://res.wx.qq.com/mpres/zh_CN/htmledition/comm_htmledition/images/pic/common/pic_blank.gif)
    
- æå…ˆæ˜¥
    
    2021å¹´10æœˆ14æ—¥
    
    èµ2
    
    å†™å¥½![[å¼º]](https://res.wx.qq.com/mpres/zh_CN/htmledition/comm_htmledition/images/pic/common/pic_blank.gif)
    
- å›è¡Œå¥
    
    2021å¹´10æœˆ14æ—¥
    
    èµ2
    
    å¼•æ“åœ¨FailOveråï¼Œéœ€å¤šæ¬¡æ‰§è¡Œæ¢å¤å‡½æ•°Â R()ï¼Œç›´åˆ°æœ€åä¸€æ¬¡æ‰ç»“æŸã€‚åœ¨å¤§æ•°æ®é‡æƒ…å†µä¸‹ï¼Œæ˜¯å¦‚ä½•ä¿è¯æ‰§è¡Œæ•ˆç‡çš„ã€‚
    
- å¾®å­
    
    2021å¹´10æœˆ13æ—¥
    
    èµ2
    
    å‰å®³å‰å®³![[è€¶]](https://res.wx.qq.com/mpres/zh_CN/htmledition/comm_htmledition/images/pic/common/pic_blank.gif)![[è€¶]](https://res.wx.qq.com/mpres/zh_CN/htmledition/comm_htmledition/images/pic/common/pic_blank.gif)![[è€¶]](https://res.wx.qq.com/mpres/zh_CN/htmledition/comm_htmledition/images/pic/common/pic_blank.gif)![[è€¶]](https://res.wx.qq.com/mpres/zh_CN/htmledition/comm_htmledition/images/pic/common/pic_blank.gif)
    

å·²æ— æ›´å¤šæ•°æ®