
åŸåˆ›Â å¼ æ±‰ä¸œÂ è§‰å­¦ç¤¾

Â _2021å¹´11æœˆ08æ—¥ 21:29_

> â€œç¡å‰ä¸€ç¯‡ã€‚
> 
> åŸæ–‡ï¼šhttps://paulmck.livejournal.com/66175.html[1]

## å¼•å­

ã€Šæ·±å…¥ç†è§£å¹¶è¡Œç¼–ç¨‹ã€‹[2]Â ä½œè€… Paul E. McKenney æœ€è¿‘å‡ å¤©å†™äº†è¿™ç¯‡æ–‡ç« ã€‚å¯ä»¥é€šè¿‡çŸ¥ä¹è¿™ç¯‡æ–‡ç« ã€Šæ·±å…¥ç†è§£å¹¶è¡Œç¼–ç¨‹ã€‹ç¬”è®°[3]æ¥äº†è§£ä¸‹è¿™æœ¬ä¹¦ã€‚

è¯¥ä¹¦Â PDF ç‰ˆæœ¬ä¸‹è½½[4]ï¼Œæ”¾å¿ƒï¼Œè¿™æœ¬ä¹¦æ˜¯å…¬å¼€å…è´¹ï¼Œä¸‹è½½é“¾æ¥æ˜¯ä½œè€…å…¬å¼€çš„ã€‚

Paul æ—¥å¸¸åº”è¯¥å·¥ä½œäº Facebookï¼Œæ‹¥æœ‰ 30 å¹´çš„ Cpp å¹¶å‘å·¥ä½œç»éªŒï¼Œæ˜¯Â Linux å†…æ ¸å†…å­˜æ¨¡å‹ï¼ˆLKMMï¼‰[5]çš„ä¸»è¦ç»´æŠ¤è€…ã€‚ä»–å†™è¿™ç¯‡æ–‡ç« çš„åˆè¡·æ˜¯æƒ³ä¸ºÂ RustÂ ç¤¾åŒºçš„å¹¶å‘ç›¸å…³æ—¥å¸¸å·¥ä½œæä¾›ä¸€ä¸ªè‰¯å¥½çš„èµ·ç‚¹ã€‚Paul éå¸¸å…³æ³¨ Rust è¿›å…¥ Linux å†…æ ¸è¿™ä»¶äº‹ï¼Œä»–åœ¨ä¹‹å‰çš„åšå®¢æ–‡ç« ä¸­æå‡ºä¸€ä¸ªè§è§£ï¼šåœ¨ Linux å†…æ ¸ä¸­å‡å°‘ Unsafe Rust ä»£ç çš„ä¸€ç§æ–¹æ³•å°±æ˜¯å°† Unsafe æ“ä½œä¸‹æ¨åˆ°åŸå­æ“ä½œã€å†…å­˜å±éšœå’Œé”åŸè¯­ä¸­ã€‚

ä»–çš„åšå®¢é‡Œä¹Ÿå†™äº†å¾ˆå¤š Rust å’Œ Linux çš„æ–‡ç« ï¼šhttps://paulmck.livejournal.com/tag/rust[6]

æœ¬ç¯‡æ˜¯æˆ‘å­¦ä¹ è¿™ç¯‡æ–‡ç« è¿‡ç¨‹ä¸­çš„é˜…è¯»è®°å½•ï¼Œå†…å®¹ä¸ä»…ä»…æ˜¯è¿™ç¯‡æ–‡ç« ï¼ŒåŒæ—¶ä¹Ÿå‚è€ƒäº†æ–‡ç« ä¸­æ‰€æåŠçš„ä¸€äº›èµ„æ–™ã€‚

## Rust å½“å‰çš„å†…å­˜æ¨¡å‹

åœ¨ Rust æ ‡å‡†åº“ Â `std::sync::atomic`æ¨¡å—å†™é“ï¼šâ€œThese orderings are the same as theÂ C++20 atomic orderings[7].â€ ã€‚æ„æ€å°±æ˜¯è¯´ï¼Œ Rust ç°åœ¨çš„å†…å­˜é¡ºåºé‡‡ç”¨çš„æ˜¯ C++ 20 çš„åŸå­å†…å­˜é¡ºåºã€‚

åœ¨ Rust nomicon ä¸€ä¹¦ä¸­çš„Â `Atomics` ç« èŠ‚[8]ï¼Œ è°ˆåˆ°ï¼Œå®é™…ä¸Šè¿™ä¸ªæ¨¡å‹ç›¸å½“å¤æ‚ï¼Œå¹¶ä¸”å·²çŸ¥æœ‰å‡ ä¸ªç¼ºé™·[9]ã€‚

> â€œ
> 
> Rust å¾ˆæ˜æ˜¾åœ°åªæ˜¯ä» C++20 ç»§æ‰¿äº†åŸå­çš„å†…å­˜æ¨¡å‹ã€‚è¿™å¹¶ä¸æ˜¯å› ä¸ºè¯¥æ¨¡å‹ç‰¹åˆ«å‡ºè‰²æˆ–æ˜“äºç†è§£ã€‚äº‹å®ä¸Šï¼Œè¿™ä¸ªæ¨¡å‹éå¸¸å¤æ‚ï¼Œå¹¶ä¸”å·²çŸ¥æœ‰å‡ ä¸ªç¼ºé™·ã€‚ç›¸åï¼Œè¿™æ˜¯å¯¹æ¯ä¸ªäººéƒ½ä¸æ“…é•¿åŸå­å»ºæ¨¡è¿™ä¸€äº‹å®çš„åŠ¡å®è®©æ­¥ã€‚è‡³å°‘ï¼Œæˆ‘ä»¬å¯ä»¥ä»å›´ç»• C/C++ å†…å­˜æ¨¡å‹çš„ç°æœ‰å·¥å…·å’Œç ”ç©¶ä¸­å—ç›Šã€‚ï¼ˆä½ ä¼šç»å¸¸çœ‹åˆ°è¿™ä¸ªæ¨¡å‹è¢«ç§°ä¸ºâ€œC/C++11â€æˆ–â€œC11â€ã€‚C åªæ˜¯å¤åˆ¶äº† C++ å†…å­˜æ¨¡å‹ï¼›C++11 æ˜¯è¯¥æ¨¡å‹çš„ç¬¬ä¸€ä¸ªç‰ˆæœ¬ï¼Œä½†å®ƒå·²ç»æ”¶åˆ°äº†ä¸€äº›ä»é‚£ä»¥åçš„é”™è¯¯ä¿®æ­£ã€‚ï¼‰
> 
> è¯•å›¾å®Œå…¨è§£é‡Šæœ¬ä¹¦ä¸­çš„æ¨¡å‹æ˜¯ç›¸å½“æ— æœ›çš„ã€‚å®ƒæ˜¯æ ¹æ®å¼•å‘ç–¯ç‹‚çš„å› æœå…³ç³»å›¾æ¥å®šä¹‰çš„ï¼Œéœ€è¦ä¸€æ•´æœ¬ä¹¦æ‰èƒ½ä»¥å®ç”¨çš„æ–¹å¼æ­£ç¡®ç†è§£ã€‚å¦‚æœä½ æƒ³è¦æ‰€æœ‰çš„ç»†èŠ‚ï¼Œä½ åº”è¯¥æŸ¥çœ‹C++ è§„èŒƒ[10]ã€‚
> 
> C++ å†…å­˜æ¨¡å‹ä»æ ¹æœ¬ä¸Šæ˜¯è¯•å›¾å¼¥åˆæˆ‘ä»¬æƒ³è¦çš„è¯­ä¹‰ã€ç¼–è¯‘å™¨æƒ³è¦çš„ä¼˜åŒ–ä»¥åŠæˆ‘ä»¬çš„ç¡¬ä»¶æƒ³è¦çš„ä¸ä¸€è‡´çš„æ··ä¹±ä¹‹é—´çš„å·®è·ã€‚æˆ‘ä»¬åªæƒ³ç¼–å†™ç¨‹åºï¼Œè®©å®ƒä»¬å®Œå…¨æŒ‰ç…§æˆ‘ä»¬è¯´çš„å»åšã€‚

## Linux å†…æ ¸å†…å­˜æ¨¡å‹ï¼ˆLKMMï¼‰

LKMM ä¸­æœ€å®¹æ˜“ä»¤äººç”Ÿç•çš„åœ°æ–¹åŒ…æ‹¬ï¼š

1. æ§åˆ¶ä¾èµ–[11]
    
2. åœ°å€å’Œæ•°æ®ç›¸å…³æ€§[12]
    

### æ§åˆ¶ä¾èµ–

åœ¨è®¸å¤šå¼±åºæ¶æ„çš„æ±‡ç¼–è¯­è¨€å±‚é¢ä¸Šï¼Œæ¡ä»¶æ€§åˆ†æ”¯å……å½“äº†ä¸€ä¸ªéå¸¸å¼±ã€éå¸¸ä¾¿å®œä½†éå¸¸æœ‰ç”¨çš„å†…å­˜å±éšœæŒ‡ä»¤ã€‚å®ƒå‘½ä»¤ä»»ä½•è¿”å›å€¼è¿›å…¥æ¡ä»¶ä»£ç çš„`load`ï¼Œåœ¨åˆ†æ”¯æŒ‡ä»¤å®Œæˆåæ‰§è¡Œçš„æ‰€æœ‰`store`ä¹‹å‰ï¼Œæ— è®ºåˆ†æ”¯æ˜¯å¦è¢«é‡‡çº³ã€‚`ARMv8`ä¹Ÿæœ‰ä¸€ä¸ªæ¡ä»¶ç§»åŠ¨æŒ‡ä»¤ï¼ˆ`CSEL`ï¼‰ï¼Œæä¾›ç±»ä¼¼çš„æ’åºã€‚

å› ä¸ºæ¡ä»¶åˆ†æ”¯çš„æ’åºå±æ€§æ¶‰åŠä»åŠ è½½ï¼ˆ`Load`ï¼‰åˆ°åˆ†æ”¯ä»¥åŠä»åˆ†æ”¯åˆ°å­˜å‚¨ï¼ˆ`Store`ï¼‰çš„ä¾èµ–å…³ç³»ï¼Œå¹¶ä¸”å› ä¸ºåˆ†æ”¯æ˜¯æ§åˆ¶æµæŒ‡ä»¤ï¼Œæ‰€ä»¥è¿™ç§æ’åºè¢«ç§°ä¸ºæ§åˆ¶ä¾èµ–ã€‚

å› ä¸ºç¼–è¯‘å™¨ä¸ç†è§£å®ƒä»¬ï¼Œæ‰€ä»¥æ§åˆ¶ä¾èµ–éå¸¸è„†å¼±ã€‚ä½†æ˜¯å®ƒä»¬çš„æˆæœ¬éå¸¸ä½ï¼Œå› æ­¤å®ƒä»¬è¢«ç”¨äº Linux å†…æ ¸ä¸­ä¸€äº›éå¸¸é‡è¦çš„å¿«é€Ÿè·¯å¾„ã€‚

Rust å¯ä»¥é€šè¿‡å¤šç§æ–¹å¼å¤„ç†æ§åˆ¶ä¾èµ–ï¼š

1. ç®€å•çš„è§£å†³æ–¹æ¡ˆæ˜¯å°†æ§åˆ¶ä¾èµ–é¡¹çš„`load`æå‡åˆ°`smp_load_acquire()`ã€‚è¿™æœ‰æ•ˆï¼Œä½†åœ¨æŸäº›æ¶æ„ä¸Šå¢åŠ äº†æŒ‡ä»¤å¼€é”€ï¼Œå¹¶ä¸å¿…è¦åœ°é™åˆ¶äº†æ‰€æœ‰æ¶æ„ä¸Šçš„ç¼–è¯‘å™¨ä¼˜åŒ–ï¼ˆä½†å…¬å¹³åœ°è¯´ï¼Œ`ARMv8`åœ¨ä½¿ç”¨é“¾æ¥æ—¶ä¼˜åŒ–æ„å»ºæ—¶æ­£æ˜¯è¿™æ ·åšçš„ï¼‰ã€‚å¦ä¸€ä¸ªå›°éš¾æ˜¯ç¡®å®šï¼ˆæ— è®ºæ˜¯æ‰‹åŠ¨è¿˜æ˜¯è‡ªåŠ¨ï¼‰ç¡®åˆ‡åœ°éœ€è¦æå‡å“ªäº›`READ_ONCE()`è°ƒç”¨ã€‚
    
2. ä¸€ä¸ªæ›´ç®€å•çš„è§£å†³æ–¹æ¡ˆæ˜¯å°†åŒ…å«æ§åˆ¶ä¾èµ–é¡¹çš„ä»£ç åˆ†ç±»ä¸º Rust èŒƒå›´ä¹‹å¤–çš„æ ¸å¿ƒ Linux å†…æ ¸ä»£ç ã€‚ç”±äºåœ¨ Linux å†…æ ¸ä¸­å¾ˆå°‘ä½¿ç”¨æ§åˆ¶ä¾èµ–é¡¹ï¼Œå› æ­¤ Rust é‡‡å–è¿™ç§æ–¹æ³•ä¸ä¼šæŸå¤±å¤ªå¤šã€‚æ­¤å¤–ï¼Œè¿˜æœ‰å¯èƒ½åˆ›å»ºæ›´é«˜çº§åˆ«çš„ C è¯­è¨€åŸè¯­ï¼Œå…¶ä¸­åŒ…å«æ‰€éœ€çš„æ§åˆ¶ä¾èµ–é¡¹ï¼Œç„¶åå°†å…¶åŒ…è£…èµ·æ¥ä»¥ä¾› Rust è¯­è¨€ä½¿ç”¨ã€‚
    
3. ä»`Linux-kernel-in-Rust`Â å¼€å‘äººå‘˜çš„è§’åº¦æ¥çœ‹ï¼Œæœ€å¥½çš„æ–¹æ³•æ˜¯è®© Rust å¼ºåˆ¶æ‰§è¡Œ`memory-barriers.txt ä¸­`è®°å½•çš„ä»£ç æ ·å¼é™åˆ¶ã€‚ç„¶è€Œï¼Œè¿™ç§æ–¹æ³•æœ‰å¯èƒ½è¢«è¯æ˜æ˜¯ä¸å¹³å‡¡(non-trivial)çš„ã€‚
    
4. ç­‰å¾…ç¼–è¯‘å™¨åç«¯äº†è§£æ§åˆ¶ä¾èµ–é¡¹ã€‚è¿™å¯èƒ½éœ€è¦ç­‰å¾…ä¸€æ®µæ—¶é—´ï¼Œå°¤å…¶æ˜¯è€ƒè™‘åˆ°åœ¨`C/C++`Â æ ‡å‡†çš„å½“å‰å‘½åæ³•ä¸­ç”šè‡³éš¾ä»¥å®šä¹‰æ§åˆ¶ä¾èµ–é¡¹ã€‚
    

### åœ°å€å’Œæ•°æ®ç›¸å…³æ€§

åœ°å€ä¾èµ–æ¶‰åŠä¸€ä¸ªåŠ è½½ï¼Œå®ƒçš„è¿”å›å€¼ç›´æ¥æˆ–é—´æ¥å†³å®šäº†åé¢åŠ è½½æˆ–å­˜å‚¨çš„åœ°å€ï¼Œè¿™å¯¼è‡´è¾ƒæ—©çš„åŠ è½½åœ¨åé¢çš„åŠ è½½æˆ–å­˜å‚¨ä¹‹å‰è¢«æ’åºã€‚æ•°æ®ä¾èµ–æ¶‰åŠä¸€ä¸ªåŠ è½½ï¼Œå®ƒçš„è¿”å›å€¼ç›´æ¥æˆ–é—´æ¥å†³å®šäº†åé¢çš„å­˜å‚¨å­˜å‚¨çš„å€¼ï¼Œè¿™å¯¼è‡´åŠ è½½åœ¨å­˜å‚¨ä¹‹å‰è¢«æ’åºã€‚è¿™äº›è¢«`RCU`Â (`Read Copy Update`ï¼Œè¯»å¤åˆ¶æ›´æ–°)å¤§é‡ä½¿ç”¨ã€‚å°½ç®¡å®ƒä»¬ä¸åƒæ§åˆ¶ä¾èµ–é‚£æ ·è„†å¼±ï¼Œä½†ç¼–è¯‘å™¨ä»ç„¶ä¸çŸ¥é“å®ƒä»¬ã€‚å› æ­¤ï¼Œä»ç„¶éœ€è¦å°å¿ƒï¼Œå¦‚`rcu_dereference.rst`[13]Â Linux å†…æ ¸ç¼–ç æŒ‡å—ä¸­æ‰€è§ã€‚ä¸æ§åˆ¶ä¾èµ–ä¸€æ ·ï¼Œåœ°å€å’Œæ•°æ®ä¾èµ–çš„å¼€é”€éå¸¸ä½ï¼Œä½†ä¸æ§åˆ¶ä¾èµ–ä¸åŒï¼Œå®ƒä»¬åœ¨ Linux å†…æ ¸ä¸­è¢«å¤§é‡ä½¿ç”¨ã€‚

Rust å†…å­˜æ¨¡å‹åº”è¯¥å°†å…¶å¯¹ Linux å†…æ ¸åŸå­æ“ä½œçš„æ”¯æŒé™åˆ¶ä¸ºæä¾›æ’åºçš„é‚£äº›ã€‚è¿™äº›å°†æ˜¯è¿”å›å€¼çš„éå®½æ¾ï¼ˆnon-relaxedï¼‰è¯»-ä¿®æ”¹-å†™ (RMW) åŸå­æ“ä½œä»¥åŠéè¿”å›å€¼çš„ RMW åŸå­æ“ä½œçš„`_acquire()`å’Œ`_release()`å˜ä½“ã€‚å…è®¸æ— åº RMW æ“ä½œä¸ç»„åˆå†…å­˜å±éšœçš„ç»„åˆä¹Ÿå¯èƒ½æœ‰æ„ä¹‰ï¼Œä¾‹å¦‚ï¼Œ`atomic_inc()`åè·Ÿ`smp_mb__after_atomic()`ï¼Œä½†å°†å®ƒä»¬ç»„åˆåŒ…è£…ä¸ºå•ä¸ª Rust å¯è®¿é—®åŸè¯­ä¼šæ›´æœ‰æ„ä¹‰ã€‚è¿™ä¸ªç»„åˆçš„ Rust åŸè¯­å°†ä¸å†æ˜¯æ— åºçš„ï¼Œå› æ­¤å¯ä»¥ä½œä¸ºä¸€ä¸ªæœ‰åºçš„å•å…ƒåŒ…å«åœ¨ Rust å†…å­˜æ¨¡å‹ä¸­ã€‚æˆ–è€…ï¼Œæ— åºåŸå­æ“ä½œï¼ˆrelaxï¼‰å¯èƒ½ä¼šé™çº§ä¸º Rust çš„`unsafe`æ¨¡å¼ã€‚

å› æ­¤ï¼Œä» LKMM å¼€å§‹ï¼Œæˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ªæ”¯æŒæœ‰åºåŸå­æ“ä½œå’Œé”å®šçš„æ¨¡å‹ï¼Œå¯èƒ½åŒ…æ‹¬`unsafe`æ¨¡å¼ä¸‹çš„æ— åºåŸå­æ“ä½œã€‚

## C++ å†…å­˜æ¨¡å‹

Cpp çš„Â `memory_order_relaxed`Â ä¼šå¯¼è‡´Â `out-of-thin-air (OOTA)`Â çš„å€¼å‡ºç°ã€‚æ‰€ä»¥ï¼ŒRust ä¸­Â `memory_order_relaxed`Â å»ºè®®åªå…è®¸åœ¨Â `unsafe`Â ä»£ç ä¸­ä½¿ç”¨ã€‚

è€Œå®‰å…¨çš„ Rust ä»£ç åº”è¯¥å…è®¸ä½¿ç”¨è¿™å››ä¸ªé¡ºåºï¼š`memory_order_acquire`ã€``memory_order_release`å’Œ`memory_order_acq_rel` ã€‚

## å»ºè®®

ä» Linux å†…æ ¸å†…å­˜æ¨¡å‹ å’Œ Cpp å†…å­˜æ¨¡å‹çš„ä¸€äº›é—®é¢˜ï¼Œä½œè€…å¯¹ Rust ä¸­çš„å†…å­˜é¡ºåºæ”¹è¿›æå‡ºä»¥ä¸‹å»ºè®®ï¼š

1. å¯ä»¥åœ¨Â `Safe`Â å’ŒÂ `UnSafe`Â ä¸‹ä½¿ç”¨ é”åŸè¯­ã€‚
    
2. `memory_order_seq_cst`ã€`memory_order_acquire`ã€``memory_order_release`å’Œ`memory_order_acq_rel`å¯ä»¥åœ¨`Safe`å’Œ`UnSafe` ä¸‹ä½¿ç”¨ã€‚
    
3. `memory_order_relaxed`å’Œ`memory_order_consume`Â åªå¯åœ¨Â `UnSafe`Â Â ä¸‹ä½¿ç”¨ã€‚
    

åœ¨å®‰å…¨æ¨¡å¼ä¸‹é‡‡ç”¨`C/C++`å†…å­˜æ¨¡å‹ä¸­æ²¡æœ‰é—®é¢˜çš„éƒ¨åˆ†ï¼Œå…¶ä½™éƒ¨åˆ†é‡‡ç”¨`UnSafe`æ¨¡å¼ã€‚è¿™ç§æ–¹æ³•å…è®¸äººä»¬ç”¨ Rust ç¼–å†™æ¯å¤©çš„å¹¶å‘ç®—æ³•ï¼Œå¹¶ç¡®ä¿¡æ‰€äº§ç”Ÿçš„ä»£ç åœ¨æœªæ¥ä»ç„¶å¯ä»¥å·¥ä½œã€‚

å°±çœ‹ Rust ç¤¾åŒºå¦‚ä½•é€‰æ‹©äº†ã€‚

## æ¥è‡ª Rust ç¤¾åŒºçš„å£°éŸ³

æœ‰å¦ä¸€ä½è¯»è€…å¯¹ä»–ç»™ Rust ç¤¾åŒºçš„å»ºè®®åšäº†å¦‚ä¸‹å›å¤ï¼ˆä»¥ä¸‹æ‘˜è¦ï¼‰:

> â€œ
> 
> `Relax`è¯»å–çš„ OOTA è¡Œä¸ºæœ¬èº«ä¸ä¼šè¿å Rust çš„ä»»ä½•å†…å­˜å®‰å…¨ä¿è¯ â€”â€” ä¸€èˆ¬è€Œè¨€ï¼Œ`Relax`Â å†…å­˜æ“ä½œä»ä¸ä¼šå¼•èµ·æœªå®šä¹‰çš„è¡Œä¸ºã€‚å› æ­¤ï¼Œæ²¡æœ‰çœŸæ­£çš„ç†ç”±ä» Rust å®‰å…¨ä»£ç ä¸­æ’é™¤æ›´å¤šâ€œå¼‚ä¹å¯»å¸¸â€çš„æ“ä½œã€‚
> 
> `Relax`Â çš„æ“ä½œä¹Ÿæœ‰å®é™…çš„ç¼–è¯‘å™¨æ”¯æŒï¼Œå¹¶ä¸”åœ¨è®¸å¤šå¯¹æ€§èƒ½éå¸¸é‡è¦çš„æƒ…å†µä¸‹å¾ˆæœ‰ç”¨ï¼Œå°¤å…¶æ˜¯åœ¨å¼±æ’åºçš„ç¡¬ä»¶ä¸Šï¼Œå› æ­¤å‡ºäºçº¯ç²¹çš„æ•™å­¦åŸå› å°†å®ƒä»¬å…¨éƒ¨å‡çº§ä¸ºæ›´æ˜‚è´µçš„æ“ä½œä¼¼ä¹å¾ˆæ„šè ¢ã€‚
> 
> æ‰€ä»¥è¿™å°±æ˜¯ Rust ç°åœ¨çš„ä½ç½®ï¼šå®ƒåŸºäºÂ `C++`Â å†…å­˜æ¨¡å‹ä¸æ˜¯å› ä¸ºäººä»¬è®¤ä¸ºæ²¡æœ‰æ›´å¥½çš„ä¸œè¥¿ï¼ˆå°¤å…¶æ˜¯åœ¨Â `Relaxed`Â å‘¨å›´ï¼‰ï¼Œä¹Ÿä¸æ˜¯å› ä¸ºäººä»¬ä¸æ¥å—æ˜¾å¼å†…å­˜æˆ–æ§åˆ¶ä¾èµ–ï¼Œè€Œæ˜¯å› ä¸ºé‚£äº›æ˜¯ç¼–è¯‘å™¨ç›®å‰æä¾›çš„å®é™…â€œå·¥ä½œâ€å¹¶ä¸”å¯ä»¥è¯æ˜äº‹æƒ…çš„åŸè¯­ã€‚
> 
> è‡³äºâ€œRust ç°åœ¨çœŸçš„éœ€è¦å®ƒçš„å†…å­˜æ¨¡å‹å—â€ï¼šæˆ‘è®¤ä¸ºæ˜¯çš„ï¼Œå®ƒç¡®å®éœ€è¦ã€‚ä½†å®ƒä¸éœ€è¦æˆä¸ºæœ€ç»ˆçš„å†…å­˜æ¨¡å‹ã€‚

ä»è€…è§ä»ï¼Œæ™ºè€…è§æ™ºå§ã€‚

## å‚è€ƒ

- LINUX å†…æ ¸å†…å­˜å±éšœ[14]
    
- LINUX å†…æ ¸å†…å­˜å±éšœ ã€ä¸­æ–‡ç‰ˆã€‘[15]
    

### å‚è€ƒèµ„æ–™

[1]

https://paulmck.livejournal.com/66175.html:Â _https://paulmck.livejournal.com/66175.html_

[2]

ã€Šæ·±å…¥ç†è§£å¹¶è¡Œç¼–ç¨‹ã€‹:Â _https://mirrors.edge.kernel.org/pub/linux/kernel/people/paulmck/perfbook/perfbook.html_

[3]

ã€Šæ·±å…¥ç†è§£å¹¶è¡Œç¼–ç¨‹ã€‹ç¬”è®°:Â _https://zhuanlan.zhihu.com/p/56873613_

[4]

PDF ç‰ˆæœ¬ä¸‹è½½:Â _https://mirrors.edge.kernel.org/pub/linux/kernel/people/paulmck/perfbook/perfbook-e2.pdf_

[5]

Linux å†…æ ¸å†…å­˜æ¨¡å‹ï¼ˆLKMMï¼‰:Â _https://github.com/torvalds/linux/tree/master/tools/memory-model_

[6]

https://paulmck.livejournal.com/tag/rust:Â _https://paulmck.livejournal.com/tag/rust_

[7]

C++20 atomic orderings:Â _https://en.cppreference.com/w/cpp/atomic/memory_order_

[8]

`Atomics`Â ç« èŠ‚:Â _https://doc.rust-lang.org/stable/nomicon/atomics.html_

[9]

å‡ ä¸ªç¼ºé™·:Â _http://plv.mpi-sws.org/c11comp/popl15.pdf_

[10]

C++ è§„èŒƒ:Â _https://en.cppreference.com/w/cpp/atomic/memory_order_

[11]

æ§åˆ¶ä¾èµ–:Â _https://paulmck.livejournal.com/63151.html_

[12]

åœ°å€å’Œæ•°æ®ç›¸å…³æ€§:Â _https://paulmck.livejournal.com/63316.html_

[13]

`rcu_dereference.rst`:Â _https://www.kernel.org/doc/Documentation/RCU/rcu_dereference.rst_

[14]

LINUX å†…æ ¸å†…å­˜å±éšœ:Â _https://www.kernel.org/doc/Documentation/memory-barriers.txt_

[15]

LINUX å†…æ ¸å†…å­˜å±éšœ ã€ä¸­æ–‡ç‰ˆã€‘:Â _https://maple-leaf-0219.github.io/2020/linux%E5%86%85%E6%A0%B8%E4%B8%AD%E7%9A%84%E5%86%85%E5%AD%98%E5%B1%8F%E9%9A%9C-%E8%AF%91/_

  

![](https://mmbiz.qlogo.cn/mmbiz_jpg/XVGFkxA7O0Qx4gibsviaml1x6FKaOGMkO6oNrQ1Izg6RSiauTMOJrpoFXuKhYk9KJKCibgBb9ZvFpWOZXCRicWFEdiaQ/0?wx_fmt=jpeg)

å¼ æ±‰ä¸œ

Â è¯·æˆ‘å–æ¯èŒ¶ğŸµÂ 

![èµèµäºŒç»´ç ](https://mp.weixin.qq.com/s?__biz=MjM5MzI5ODA4NQ==&mid=2453650307&idx=1&sn=b3ce8ed718882094d228c11fb9a28e98&chksm=b15238498625b15fc13004ccb0b9036036bd31fbba060bb1549905f006541656e3298a995b8c&mpshare=1&scene=24&srcid=0112sWx3C91GWh5sPYe6LkP2&sharer_sharetime=1641985931246&sharer_shareid=5fb9813bfe9ffc983435bfc8d8c5e9ca&key=daf9bdc5abc4e8d081ba9e62e17fd551a4bb07b0f559ce97d14d760669783622017d327bca06a117a25a7c4df9887d453583e42aa5ef4a217e750ad0ce4fe9f580ab57f570dfe93f08385edff9e99ffbfe971eb4f8d6521c71c7ad15c676c125a0906e4cf4960e9dc14f293c64cdb6fd20dfdafcef4b196b0eebc4afabc32b92&ascene=0&uin=MTEwNTU1MjgwMw%3D%3D&devicetype=Windows+11+x64&version=63090b19&lang=zh_CN&countrycode=CN&exportkey=n_ChQIAhIQZ9KFdhkd8wxJiJ%2Fbyy9%2BIBLmAQIE97dBBAEAAAAAAIPeD8H6g5AAAAAOpnltbLcz9gKNyK89dVj0QBmxRlAN8ggl8kBBk%2Fcmcww2pZrEfY6%2FC6VKuczRl7gDIb5uGSyqqilvepPIfK9YG4sgqhtgwctjla9jaHRnifCOdCiPzuHRgS2IStxmYAqMiXVP4Ltt1deQQcBUJmjR0zhm9cIUWtVlZm4Tex3Io6hCSvJrHJmqnFWewBqPIGSbQ2ORXtevCl3QMnZSbPtzkGV848wRqT%2Fjd0YkhjOwpI5JjcFYjSgK3qX1U2r325qZDOr4zdGMKRegGL9ELDmj&acctmode=0&pass_ticket=0qwOybeoGtmucx4euGNc0qkpzIdU27vy8YWHVBzf8QqF5cdVJcQYH4UHXOqQx%2By7&wx_header=1&fasttmpl_type=0&fasttmpl_fullversion=7350504-zh_CN-zip&fasttmpl_flag=1)å–œæ¬¢ä½œè€…

1äººå–œæ¬¢

![](https://res.wx.qq.com/mpres/zh_CN/htmledition/comm_htmledition/images/pic/common/pic_blank.gif)

RustMagazine å¾æ–‡é›†38

Rust è§†ç•Œ152

Rustå¹¶å‘1

Rust for Linux4

RustMagazine å¾æ–‡é›† Â· ç›®å½•

ä¸Šä¸€ç¯‡RFC å¯¼è¯» | æ„å»ºå®‰å…¨çš„ I/Oä¸‹ä¸€ç¯‡Rust æºç é˜…è¯»ä¿±ä¹éƒ¨ | ç¬¬ä¸€æœŸ ï¼š åç§°è§£æ

é˜…è¯»Â 1019

â€‹